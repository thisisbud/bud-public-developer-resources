openapi: 3.0.2
info:
  title: 'Bud API Services: Documentation'
  version: 2.2.0
  contact:
    name: 'Bud Support'
    url: 'https://www.thisisbud.com/'
    email: help@thisisbud.com
  x-logo:
    url: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATAAAABuCAQAAAAKAYdLAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4wQDDggcbXcx7wAABeJJREFUeNrt3W2IFVUcx/HvXRW1VdQedy1bZVfoYX0osVQyfSGElKbRA5oFIaIlhAkWUYm6gvqqDMHMoBeKlhayCCZC2AMRPay7aJrSZmauZhQqaj7t7u1Fi965987s7D1n7pk7/j73zX2Y85//mXt2Zu45Z2ZBREREREREREREREREREREREREREREREREREREREREREREREREROIiZSFGH+YxgsOs5U/X1bFiPDPpQT3bu1DmcaZyg+vErWpjD+s47zoN6Mte0qRJc4Iq18lYMJv2jvosD11mRUeJpD32UO7664BFGQl94DoZY704fbU2rQwKVWYwbc6bQlSPBaYbtMz4K7nP53lpGkK/q8+7MTxUmeEWtmJcGX+j5psmM0I3l9vCirKAV36OuE46QsbfaHL/9opnL9tcpxBf3V0nkAgzWMRj9HadhrH+3Gk7pBqYDZdY3oXfnHE2gc1U2gyoQ6Rk+pKZdgOqgYnXF7TYDGe3gcWgW85QH9cJxMAVm8HsNrBqhhV1U9g33XUCzo1gsM1wdhtYio8ZWsytYdksFrpOwbGhbLYb0PavyLs5wA+c9v28lRa+Zzt/+y5RwwKqaOCdgCjZRvEit/A1a7jou8xwJjOMAb7D+ylqqCmw1imeZ0oCBrv7Mzp+/QofFTDCdZG13Jw3Wi1nOpbZT9+QGUziUkeZ3T49z+P4pqCRuCkhM1jjfMwwqsdG182rsAaWJs0JxuWJ9knGEq+EzODHjDLTcj5NsbjgwehwDazm6vyL5D2MG5i7booKdjE25917M57XhoxUG1hmJUsjrmWtlVl18ZQ2DeCyH6ycT7kpIJ+wuQWVeZJXI69HcpsXHDQN4LajtZIlkcbvzWqn9St1R3nPNIT93wzt/MSZPO+nqKA65699Nos5FdHmgZkMzHnvIj9zLm9+Q7jd0nqP8VtkdSqWNppYxT+u08g+yW8OnKRXw4ac08hnPUscyvjkw5AZXM4os9jzyY6sdZ3h5YC++jLm0lrASf50T5krzEn0QbOLbB8in2FvwKfNPJczCXd0hLV7wPPqL8bybt691//aWWfhkPo2681PjZPDbgP7lYZOl1nNJs9rW4elXD2zfkK8wIFOy2w1XuuWyOpTkuw2sHOhlqrzvIqu59gbuYEdIcqcjSyb65SLX5EHOepgrbuKtJ6nHNQtxtx0U5xM8DoXMkez7K5xM7Tp4iS4WOvszvss5feSP9Fvo5EVnDDfHGJfpd157Y48xFRGmfaEaWcu/qqYZxpCDcxcqR8Mg9xlGkANzNz+BDcx4zEJNTBzv5gPCSeXTvJtmM+3PJqIKdNj6GE3pJsG5mIwOMp1ptnABgd1sq+G7ebnXZncHCKjG3+M1zpLTzMz7AZ00cBG5pmlFb3JmkQTSpPd21HZbWD9Qy21zPPK/zricNH6+B7mvZFreTpEtAFWt0dpsnoWZreBVTG+kyVS1GVN4/vDd9lJVIRY5yzfPdPlrPHHdTwYItr1bkLcTia8M1qPM9F3yRRjcuaYprNmHxzyfNbQyQlnGTM47ynhndFan7WuCywLODz35I2sC9DCXheZHBNpsXvZmu1fkZXs5rjPnPzb8hyAzrIzINr9HOBIwNXat+ZcleS1hame1714izc55jNvbVDBtz7pyWuJuI15P/tnx1F0UwzsQpprO5nil2KIQSZbqcspnwp57+iu2MQT1mMmhNue/MMR3xfwMi8VYRhnmJqXP/MG1lZwyVNMy9l/FR4tf/mdvB553Uz2sXFn+n1YaGCNBZZr5mH25by7xzCb3PKrmM+lgmK1BV4hdc0+2g2zjq8m1wlAOY1dvqXGKep87oZYzUmDW3Vs8+myuIf6Am6AsiT0Nljp/CYl0Twaze9ZaaN3u5w5jAy5L2ylhe/4nAu+S1Qwl+oCsrjCV2wM2KXfwSPUcmPIGv9LPZ91Ye1TEnEb80ztNLE+Dv8MS0RERERERERERERERERERERERERERERERERERERERERERERERERs+Q/rhi5WauEgfQAAAABJRU5ErkJggg=='
  description: |
    # Overview

    ## Introduction
    Welcome to Bud's API Platform documentation. Here you will find everything you need to build features, apps and experiences using Bud's API Services. All endpoints follow standard RESTful principles and example request and response payload snippets are provided to get you up and running quickly and easily.

    To start interacting with our platform, please sign up for access [here](https://www.thisisbud.com/developers#developer-console). You will be provided with access to the [Bud Developer Console](https://console.thisisbud.com) where you can create the API Credentials required to obtain an OAuth2 access token.

    If you have any questions, please use our [Support Centre](https://support.thisisbud.com/hc/en-gb) or email us on [help@thisisbud.com](mailto:help@thisisbud.com).

    ## Bud Platform Products

    | Product | Service | Description |
    |--|--|--|
    | Connect | Open Banking Aggregation API | Simplified and unified access to Open Banking Aggregation APIs. |
    | Connect | First Party Ingestion API | Push your own data onto the Bud platform via Bud's first party ingestion endpoints. |
    | Intelligence | Financial Data API | Obtain enriched first and third party transactional data. |
    | Intelligence | Enrichment API | Access enrichment resources and retrieve high level aggregations of transactional data. |
    | Intelligence | Financial Insights API | Obtain a deeper understanding of your customers transactional data through a variety of different insights. |
    | Intelligence | Signal API | Contextual, relevant triggers and notifications that drive action from customers. |
    | Intelligence | Financial Review API | Pre-fill affordability forms to speed up services and reduce drop-off with custom groups of income and spending. |
    | Pay | Payments API | Make authorised payments and transfers directly from a customer’s account. |
    | Check | KYC API | Perform relevant checks against businesses and customers. |

    ## Environments and API Base URIs

    Bud currently supports two environments on its platform:

    1.  Bud’s Sandbox Environment - [https://api-sandbox.thisisbud.com/](https://api-sandbox.thisisbud.com/)

    2.  Bud’s Production Environment - [https://api.thisisbud.com/](https://api.thisisbud.com/)


    ## Bud’s Sandbox Environment

    ### About

    Bud Sandbox Platform is a development environment for integrating and testing Bud’s services. Its version is kept up to date with production. Bud’s sandbox environment mirrors our production environment and all updates are made in tandem. On the Sandbox environment, the variety of providers that you can connect to via Open Banking is limited and contains a predefined set of dummy accounts and transaction data. The instance size doesn’t differ from production, although certain rate limits are in place.

    ### API Access

    To start interacting with Bud’s Sandbox API you have to sign up for a developer account [here](https://www.thisisbud.com/developers#developer-console).

    Once you’ve completed the signup and activation process you will be able to create a new project in the [Developer Console](https://console.thisisbud.com) to receive API Credentials (client_id and client_secret). These can be used to obtain OAuth2 access and refresh tokens using authentication endpoint. The access token must be supplied as a Bearer token within every service API call made to the Bud Platform. Once the access token has expired, the refresh token must be used to obtain another access token.  


    Details on the authentication process can be found in the Authentication section of this documentation.

    ### Sandbox Providers

    Bud’s sandbox is built to mirror its production environment. The main difference is the available open banking providers that a customer is able to connect to. In the sandbox, Bud’s aggregation service only supports the use of Open Banking sandbox providers which issue dummy data.

    Currently, you are able to connect to customer profiles with predefined accounts and transaction data sets (managed by Bud) which are available via the NatWest Sandbox provider.

    From a Marketplace perspective, you can test any available journeys and play around with them, see how the product is constructed, what information the endpoints return and potentially create a new product of your choosing, following the API journey. Please note, that you will be unable to physically carry out any of the marketplace journeys (e.g. send rental data to Experian, or switch your Utility provider) within the Sandbox environment.

    Necessary access credentials can be found in the Bud [Developer Console](https://console.thisisbud.com) interface.

    ## Bud’s Production Environment

    ### About

    Bud’s production environment is designed for use within your application when going live to real Customers. The environment is fully scalable, secure and facilitates the use of real Customer data.

    ### API Access

    To start interacting with Bud’s Production environment you must first sign up for a developer account [here](https://www.thisisbud.com/developers#developer-console). Once you have been assigned a relevant account manager, please contact them to get access to Bud’s production environment.

    ### Providers

    Bud’s production environment provides live access to all currently available providers via the Bud Platform (i.e. third party products and services). Please click here for a list of the currently supported Open Banking providers available via Buds Open Banking Aggregation API. This list is updated as and when new providers are on boarded onto the Bud platform.

    The production environment allows your Customers to connect to additional third party products and services via the Bud platform. A list of the different Investment and Pension Aggregation providers can be seen here. Information surrounding additional third party providers, relevant to a specific marketplace journey, can be found in the relevant documentation below.

    ## Message formats

    Bud’s platform is made available through Application Programming Interface (API) endpoints, all of which adhere to [RESTful](https://restfulapi.net/) principles. Standard HTTP verbs and status codes are used for requests and response statuses. Request and response payloads are [JSON](http://www.json.org/) encoded data formatted. Communication with the Bud Platform is handled over HTTPS protocol only.

    | Data Type | Standard |
    | -- | -- |
    | Strings encoding | `UTF-8` |
    | Datetime | `ISO 8601` |
    | Currency codes | `ISO 4217` |

    ### HTTP Verbs

    | Verb | Usage Context |
    | -- | -- |
    | GET | Used to retrieve the resource representation or metadata |
    | POST | Used to create a new resource on the server |
    | PUT | Used to update the resource state |
    | PATCH | Used to partially update a resource |
    | DELETE | Used to delete the resource|

    ### HTTP Response Codes

    | Code Class |  Description |
    | -- | -- |
    | `1XX` | Informational - provisional response from the server |
    | `2XX` | Success - the request has been processed successfully by the server |
    | `4XX` | Client Error - the request has not been processed due to client-side issue with the request |
    | `5XX` | Server Error - the request has not been processed due to server-side issue |

    ## Requests Custom Headers

    Some endpoints will require the presence of custom headers in the HTTP Request to be properly processed by Bud Platform services.

    | Header Name | Description|
    | ----------- | ---------------------------- |
    | `X-Client-Id` | API Credentials `client_id` value required for request authorisation purposes |
    | `X-Customer-Id` | Customer Identifier value necessary for establishing the Customer context of the data to be retrieved or processed |
    | `X-Customer-Secret` | Customer Secret value necessary for authorisation to retrieve and decrypt the Customer Data stored in Bud platform |
    | `X-Account-Id` | Customer Account Identifier value necessary for establishing the context to retrieve specific customer’s account data.|
    | `X-From` | Start date from when the transactions data should be returned |
    | `X-To` | End date till when the transactions data should be returned |

    ## Response Styling

    ### Response Custom Headers

    | Header Name |  Description |
    | -- | -- |
    | `X-Request-Id` | Bud request identifier for troubleshooting purposes |

    ## Success Responses

    The description and the listed status codes below indicate that an action requested by the client was successfully processed.

    The successful responses will have status codes in the `200-299` range and have relevant response content where required. However, `204 No Content` and `205 Reset Content` status codes won't contain a response content.

    ### Response Style Properties
    | Field        | Description                                                          | Properties                                    |
    | ------------ | -------------------------------------------------------------------- | --------------------------------------------- |
    | operation_id | A descriptive enough string that is linked to the operation/feature. | A `required` lower case snake case `string`   |
    | data         | A data-set that is relevant to the endpoint.                         | An `optional` single/multidimensional `array` |
    | metadata     | Contains endpoint specific additional information.                   | An `optional` JSON `object`                   |

    #### Examples

    ##### 200 OK

    After getting an existing resource with `GET /resources/{id}`.

    ```json
    {
      "operation_id": "resources_get",
      "data": {
        "id": "111-AAA-222-BBB",
        "name": "Bud",
        "email": "bud@thisisbud.com",
        "created_at": "2019-01-01T15:53:00+05:00"
      }
    }
    ```

    ##### 201 Created

    After creating a new resource with `POST /resources`.

    ```json
    {
      "operation_id": "resources_post",
      "data": {
        "id": "111-AAA-222-BBB"
      }
    }
    ```
    ## Error Responses

    ### Response Style Properties

    | Field        | Description                                                             | Properties                                    |
    | ------------ | ----------------------------------------------------------------------- | --------------------------------------------- |
    | operation_id | A descriptive enough string that is linked to the operation/feature.    | A `required` snake case `string`              |
    | code_id      | A descriptive enough string that is linked to the reason for the error. | A `required` snake case `string`              |
    | message      | An actual user friendly error message.                                  | A `required` `string`                         |
    | metadata     | Contains endpoint specific additional information.                      | An `optional` JSON `object`                   |
    | errors       | A data-set that is relevant to the error.                               | An `optional` JSON `object`                   |

    ### Client Error Responses

    The description and the listed status codes below indicate that the action requested by the client was not successfully processed due to apparent client errors in the request.

    The client errors will have status codes in the 400-499 range and have relevant response content where required.

    #### Generic Client Error Responses
    | Error Code | Cause | Response Body |
    |--------------|---------|-----------|
    |401|Unauthorized|`{"operation_id": "unknown","code_id":"unknown","message": "Unauthorised request","errors": {}}` |
    |404|Not Found|`{"operation_id": "unknown","code_id":"unknown","message": "Route or resource not found","errors": {}}` |
    |405|Method Not Allowed|`{"operation_id": "unknown","code_id":"unknown","message": "Method not allowed","errors": {}}` |

    #### List of Code Ids

    | Name                            | Description                                                                                                                         |
    |---------------------------------|-------------------------------------------------------------------------------------------------------------------------------------|
    | failed_validation               | Occurs when a request validation process fails.                                                                                     |
    | invalid_login                   | Occurs when insufficient login credentials were provided.                                                                           |
    | resource_not_found              | Occurs when a requested record or a feature was not found.                                                                          |
    | unique_constraint               | Occurs when a request tries to create an existing record in database.                                                               |
    | task_not_found                  | The specified task could not be found.                                                                                              |
    | account_not_found               | The specified account could not be found. Please check the account identifier is correct. The account might be closed or suspended. |
    | internal_error                  | An unexpected internal error.                                                                                                       |
    | internal_timeout                | A task had timed out.                                                                                                               |
    | internal_transient_error        | A unexpected transient internal error.                                                                                              |
    | request_validation              | Occurs when a request validation process fails.                                                                                     |
    | auth_denied                     | Authorisation process cancelled.                                                                                                    |
    | auth_expired                    | The authorisation url has expired. Please generate a new one to continue.                                                           |
    | connection_not_found            | No active connection with the provider                                                                                              |
    | connection_expired              | The connection consent has expired. re-authentication required                                                                      |
    | connection_revoked              | The connection consent has been revoked. Re-authentication required                                                                 |
    | connection_status               | The connection consent is in the wrong status to perform the action.                                                                |
    | connection_permission           | The connection consent does not have the require permissions for this resource                                                      |
    | provider_not_found              | Unknown provider                                                                                                                    |
    | provider_failure                | The provider has had an unexpected failure                                                                                          |
    | provider_timeout                | The provider has taken to long to respond.                                                                                          |
    | provider_maintenance            | The provider is temporarily unavailable due to maintenance                                                                          |
    | provider_request_limit          | The provider rate limit has been exceeded                                                                                           |
    | provider_endpoint_unimplemented | The provider has not implemented this endpoint                                                                                      |
    | provider_endpoint_deprecated    | The provider has deprecated this endpoint                                                                                           |
    | provider_reauthenticate         | The provider has deemed this consent needs to be reauthenticated.                                                                   |

    #### Examples

    ##### 400 Bad Request

    Returned after a failed attempt to create a new resource by passing invalid data to POST /resources.

    After trying to create a new resources by passing invalid data to `POST /resources`.

    ```json
    {
      "operation_id": "resources_post",
      "code_id": "failed_validation",
      "message": "Invalid request payload.",
      "metadata": {},
      "errors": {
        "name": "This value is required.",
        "email": "This value is invalid."
      }
    }
    ```
    ### Server Error Responses

    The server errors will have status codes in the 500-599 range. The server errors will look very much like the "Client Errors" but will contain bare minimum information attached to them.

    #### Generic Server Error Responses
    | Error Code | Cause | Response Body |
    |--------------|---------|-----------|
    |`500`| Internal Server Error| `{"message": "An error occurred while processing your request"}`|
    |`503`| Service Unavailable| `{"message": "Service unavailable"}` |

    # Updates & Versioning

    Updates to Bud's API documentation are made frequently. The current version of the documentation can be clearly viewed at the very top of this page.

    ## Backward Compatibility

    Bud aims to make integration as seamless as possible for its clients and therefore takes all possible steps to prevent backward-compatibility breaks. In the scenario where a backward-compatibility break is unavoidable, Bud creates a new endpoint, either: (a) by bumping the version within the endpoint URL; or (b) in some circumstances renaming the URL entirely. The previous endpoint may then become deprecated, and support for the endpoint will cease after a period of three months. Clients with access to any of Bud’s API services will be notified of deprecations to any endpoints and provided with ample time in which to make any necessary changes.

    Fields within response or request schemas may also become deprecated. Along with deprecated endpoints, these breaking changes will be clearly highlighted within the below changelog.

    ## Deprecations

    Bud will continue to support deprecations for a period of **three months** after they are first announced.

    | Date of Announcement | Deprecation Details                                                                                                                                                                                                                                                                                                   |
    |:---------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | 04/12/2020           | Changed the base URL of the **GET Warnings**, **GET Trends** and **GET Forecast** endpoints from `/v1/assistant/` to `/v1/signal/`.                                                                                                                                                                                   |
    | 06/08/2020           | Removed `bank_name` field in favour of a new field called `provider` in the following endpoints:<br>__POST__`/v1/open-banking/authorisation-url` (Request Payload)<br> __POST__`/v1/open-banking/connect/{connection_task_id}` (Response Payload)<br> __POST__`/v1/open-banking/refresh/{task_id}` (Response Payload) |
    | 01/09/2021           | Deprecated **GET Warnings** endpoints in favour of new **GET Money Management**, **GET Customer Characteristics** and **GET Financial Insight** endpoints.                                                                                                                                                            |
    | 01/11/2021           | Deprecated **Retrieve Authorisation Gateway URL** endpoint in favour of new **Retrieve Authorisation Gateway URL (v2)** endpoint.                                                                                                                                                                                     |
    | 01/11/2021           | Deprecated **Energy Switching API**, **Mortgage API**, **Home Insurance API** and **Broadband API** which formed Bud's marketplace offering.                                                                                                                                                                          |
    | 14/03/2022           | Deprecated **Enrich Transaction** endpoints from the Ingest and Enrich API suite.                                                                                                                                                                                                                                     |
    | 01/08/2022           | Deprecated `YYYY-MM-DD` date format for `X-From` and `X-To` headers within `/v1/affordability/spending-groups`. Both `X-From` and `X-To` headers now follow the `YYYY-MM` date format.                                                                                                                                | 
    | 05/09/2022           | Deprecated **Retrieve Merchant Totals V1** in favour of new **Retrieve Merchant Totals V2** endpoint |
    | 23/01/2023           | Deprecated **List Transactions V1**. Bud understands that many clients have integrated this endpoint in order to retrieve transactions held on the Bud platform. As a result, there is a **six month** deprecation window, meaning that support for this endpoint will cease on the **1st of August 2023**, meaning clients must have migrated over to the new and improved **List Transactions V2** endpoint by that point in time. |
    | 23/01/2023           | Deprecated **Create Customers V1**. Support will continue for this endpoint, however we recommend clients to migrate to V2 and for all new clients to integrate with the V2 endpoint.

    ## Changelog

    This changelog represents a list of all changes that have been made to Bud’s API documentation. This includes both backward-compatible and backward-incompatible changes.

    **Version 2.2.0: 28/02/2023**
    > - Added a new __Balances Insights__ beta endpoint to the new Actionable Insights API. Not subject to breaking change restrictions.

    **Version 2.1.1: 15/02/2023**
    > - Corrected documented response descriptions and examples for __Get Financial Products__

    **Version 2.1.0: 02/02/2023**
    > - Added a new __List Accounts V2 (beta)__ and __Retrieve Account By ID V2 (beta)__ beta endpoints within the Financial Data API.

    **Version 2.0.4: 31/01/2023**
    > - Fix the docs for **List Transactions V2** correcting the date format in the example response.
    > - Fix the docs for **Get Financial Products** correcting the expected response data structure.
    > - Fix the docs for **Balances Over Time By Account (Beta)** correcting the endpoint URI.

    **Version 2.0.3: 27/01/2023**
    > - Fix the docs for **Retrieve Income Transactions V2** line with fixes for average statistic calculation.

    **Version 2.0.2: 23/01/2023**
    > - Make various spelling and grammar corrections to the Financial Review API docs, and additionally specify that the Financial Review API date ranges are to be received as GET parameters rather than headers.

    **Version 2.0.0: 23/01/2023**
    > - This major release not only showcases a new look and feel for Bud's API docs, but also some fairly significant changes to the structure of the endpoints across the platform. In a nutshell, Bud's Connect API (formally Open Banking Aggregation API) has a simplified structure with the retrieve data endpoints moving into a dedicated **Financial Data** section. In addition, the various insights endpoints have been broken down to provide a more simplified structure within the **Financial Insights** section.
    > - \[**BREAKING**\] Bud's List Transactions (**POST** _/v1/open-banking/transactions_) has now been deprecated given the onsight of the new **List Transactions V2** endpoint (**POST** _/financial/v2/transactions_). Given the number of clients using the V1 endpoint, Bud has increased the deprecation window to six months. As a result, **all support will cease for the V1 List Transactions endpoint on the 1st of August 2023**. Please complete your migration before that date and contact your Bud account manager for further details and any help planning your migration.
    > - Bud's Create Customers (**POST** _/v1/customers_) has now been deprecated. Support for this endpoint will continue, however we recommend clients to mirgate to V2 when possible.

    **Version 1.22.3: 18/01/2023**
    > - Improvements to __Ingest Transactions V2__ and __Ingest Transactions Task Status__ examples.
    > - Removed the `provider` field from the __Ingest Transactions V2__ request payload.
    > - Consolidate the List Accounts, V1 List Transactions endpoint and Remove OB Provider endpoints into the Financial Data API (to sit alongside the new V2 List Transactions endpoint).

    **Version 1.22.2: 12/01/2023**
    > - \[**BREAKING**\] _Balances Over Time_ and _Balances Over Time By Account_ beta endpoints now provide pending and booked balances. Please note this has changed the structure of the response. Please note, as these are beta endpoints, normal deprecation rules don't apply.

    **Version 1.22.1: 10/01/2023**
    > - General bug fixes and improvements across examples and schemas

    **Version 1.22.0: 21/12/2022**
    > - Bud is looking to undergo some major improvements to the code base of its Rent Recognition service throughout 2023 in order to bring it in line with the other services on the Bud platform. As a result, Bud has removed the current Rent Recognition service from its API documentation. For further details on when the new Rent Recognition service will be available, please contact sales@thisisbud.com or your relevant Bud account manager.

    **Version 1.21.1: 15/12/2022**
    > - Fix for Ingest Transactions V2 sync response
    > - Fix for connect and refresh webhook status field

    **Version 1.21.0: 15/12/2022**
    > - Added a new __Balances Over Time__ and __Balances Over Time By Account__ beta endpoints within the Financial Data API.
    > - Released __List Transactions V2__ with some additional examples added (the previous beta endpoint __List Transactions (beta)__ has now been removed).
    > - Released the new Ingest Transactions V2 endpoint that enables synchronous processing for smaller payloads and also follows the latest schema for the List Transactions V2 endpoint.


    **Version 1.20.10: 06/12/2022**
    > - Updates to the __Transactions__ list endpoint (beta) examples, and added enrichments for `location` and `transaction_types`

    **Version 1.20.9: 30/11/2022**
    > - Updates to the __Transactions__ list endpoint (beta) which includes renaming the `cdi` field to `credit_debit_indicator`,
    adding the transaction `processor` enrichment, the transaction `status` field and improvements across examples.
    > - Added consent_id field to __Initiate Provider Authorisation__ endpoint to create authorisation URLs for a specific consent by sending the consent ID in the initiating request.

    **Version 1.20.8: 15/11/2022**
    > - General bug fixes and improvements across examples and schemas

    **Version 1.20.7: 08/11/2022**
    > - Added a new __Recategorise Transactions V2__ endpoint within the Submit Corrections API.

    **Version 1.20.6: 07/11/2022**
    >- Added a new field `customer_context` to the __Create Customers V1__ and __Create Customers V2__ endpoints, 
    along with new __Retrieve Customer Context__ and __Update Customer Context__ endpoints. 
    The Customer Context allows for the creation of a better user experience based on better knowledge of the customer themselves.

    **Version 1.20.5: 01/11/2022**
    > - General bug fixes and improvements across examples and schemas
    > - Updates to the __Code Ids table__, with a full list of connect error codes
    > - Added schemas for two new webhook callbacks for connect and refresh tasks.
    > - Add payments `provider_types` field

    **Version 1.20.4: 28/10/2022**
    > - Added a new __Retrieve Authorisation Gateway URL__ and __Retrieve Authorisation Gateway URL (v2)__ response code.

    **Version 1.20.3: 18/10/2022**
    > - General bug fixes and improvements across examples, schemas, endpoints descriptions, names and sectioning titles.

    **Version 1.20.2: 13/10/2022**
    > - Added a new __Retrieve Upcoming Transactions V2__ endpoint within the Transactions Insights API.

    **Version 1.20.1: 04/10/2022**
    > - General bug fixes and improvements across examples, schemas, endpoints descriptions, names and sectioning titles.

    **Version 1.20.0: 03/10/2022**
    > - Added a new Financial Data API, containing a new __Transactions__ list endpoint (beta).

    **Version 1.19.0: 30/09/2022**
    > - Added a new __Reconfirm Consent__ endpoint within the Manage OB Connections API.
    > - Added a new field to the V2 Open Banking Authorisation Gateway URL endpoint. The endpoint
    allows clients to direct customers to the reconfirmation of consent journey, where customers can
    extend their consent by 90 days.

    **Version 1.18.1: 26/09/2022**
    > - General bug fixes and improvements across examples, schemas, endpoints descriptions, names and sectioning titles.

    **Version 1.18.0: 16/09/2022**
    > - Added a new __Subscriptions__ endpoint within the Transactions Insights API.

    **Version 1.17.0: 06/09/2022**
    > - Added a new data field to the Retrieve Refresh Status endpoint as part of Bud's Connect (OB
    Aggregation) API. The field - `has_new_transactions` describes whether any new transactions have
    been obtained as part of the latest refresh, thus providing details on whether you as the Client 
    are required to fetch the latest transacitons for that customer.
    > - Deprecated __Retrieve Merchant Totals V1__ in favour of the new __Retrieve Merchant Totals V2__ endpoint.
    > - Added _Buy Now, Pay Later_ support to the __Get Financial Products__ endpoint, identified by 
    the enum value `bnpl`.

    **Version 1.16.2: 16/08/2022**
    > - Included a new query parameter within the List Consents endpoint to allow clients
    to view all consents, i.e. those that have been expired/revoked, and those that are
    awaiting authorisation (as well as those that are active).
    > - General bug fixes and improvements across examples, schemas, endpoints descriptions, names and sectioning titles.

    **Version 1.16.1: 11/08/2022**
    > - General spelling corrections and improvements across examples

    **Version 1.16.0: 01/08/2022**
    > - \[**BREAKING**\] The `X-From` and `X-To` date fields will now follow the date format of YYYY-MM for `/v1/affordability/spending-groups`. **Please note that the current date format for `X-From` and `X-To` will no longer be supported in three months time on the 1st November 2022**. All clients with existing integrations will be contacted via email by their relevant account manager to inform them of this change. This should provide clients with enough time adjust their integration before the change coming into force. Please contact `help@thisisbud.com` or your account manager if you have any questions, issues or concerns relating to this update.

    **Version 1.15.2: 22/07/2022**
    > - General spelling corrections

    **Version 1.15.1: 18/07/2022**
    > - General bug fixes and improvements across examples, schemas, endpoints descriptions, names and sectioning titles.


    **Version 1.15.0: 29/06/2022**
    > - \[**BREAKING**\] The `period` field will have new enum values when calling the `/v1/regular-transactions` and the `/v1/future-transactions` endpoints. **Please note that this change will only come into effect in three months time on the 5th October 2022**. All clients with existing integrations will be contacted via email by their relevant account manager to inform them of this change. This should provide clients with enough time adjust their integration before the change coming into force. Please contact `help@thisisbud.com` or your account manager if you have any questions, issues or concerns relating to this update.
    > - Fixed some inaccuracies with the __Signal Money Management__ docs.

    **Version 1.14.0: 27/06/2022**
    > - Added a new __Affordability Report__ endpoint within the Financial Review API.
    > - Added a new __Affordability Transaction__ endpoint within the Financial Review API.

    **Version 1.13.2: 22/06/2022**
    > - Fixed doc issues with some __Signal__ warnings (__Money Management__ `regular_monthly_income_change` and __Financial Insights__ `gambling_threshold`)

    **Version 1.13.1: 22/06/2022**
    > - Fixed issues with doc site dependencies

    **Version 1.13.0: 21/06/2022**
    > - Added a new __Debt Collection Finder__ endpoint within the Transaction Insights section.
    > - Added a new __Product Finder__ endpoint within Transaction Insights which creates a summary of a customer's financial products using their transaction history.
    > - Added Parties to the __List Accounts__ endpoint in the Manage OB Data section

    **Version 1.12.2: 24/05/2022**
    > - General bug fixes and improvements across examples, schemas, endpoints descriptions, names and sectioning titles.
    > - Added a new __Income Finder V2__ endpoint within the Transaction Insights section.
    > - Added a new __Loans Finder__ endpoint within the Transaction Insights section.

    **Version 1.12.1: 05/05/2022**
    > - Moved __Benefits Finder__ endpoint into the correct section - Transaction Insights.

    **Version 1.12.0: 26/04/2022**
    > - Added a new __Benefits Finder__ endpoint within the Transaction Insights section that provides details around any benefit specific transactions a customer might have within their connected accounts.
    > - Fixed typos.

    **Version 1.11.3: 14/03/2022**
    > - Deprecated __Enrich Transaction__ endpoints from the Ingest and Enrich API suite. 
    > - General improvements across examples, schemas, endpoints descriptions, names and sectioning titles.

    **Version 1.11.2: 31/01/2022**
    > - Corrected syntax for Custom Signal endpoints.
    > - Fixed typos.

    **Version 1.11.1: 27/01/2022**
    > - Added a better description to the Recategorisation (Customer Corrections) endpoint.
    > - Fixed typos.

    **Version 1.11.0: 05/01/2022**
    > - Added a new __Income Finder__ endpoint within the Transaction Insights section that provides details around any income specific transactions that a customer might have within their connected accounts.
    > - Detailed the payload of the callbacks (webhooks) sent to the relevant Client webhook URL when (i) an Open Banking Synchronisation task completes (i.e. after either a Connect or Refresh request has been made by the Client); and (ii)
    when the status of a Payment (single, scheduled or stand order) has either completed or failed.
    > - Included a new 400 response example in the Get Authorisation Gateway URL and Initiate Refresh endpoints (within Bud's OB Aggregation API) to detail the response when the selected provider is currently in maintenance mode.
    > - Corrected the documentation of the List Accounts endpoint to ensure that the `account_type` field is shown as nullable.

    **Version 1.10.1: 22/11/2021**
    > - Added a new __Custom Signals__ endpoint within the Signal API that allows you to segment and identify customers based on custom criteria. 

    **Version 1.10.0: 28/10/2021**
    > - Added a new __Delete Provider Data__ endpoint.
    > - Deprecated __Retrieve Authorisation Gateway URL__ endpoint following the introduction of the new `/v2/open-banking/authorisation-gateway-url` endpoint.
    > - Moved `/v1/energy-switching/energy-payments` & `/v1/energy-switching/energy-payments/{task_id}` endpoints from Energy Switching API to the Insights API.
    > - Deprecated remaining endpoints within the __Energy Switching API__.
    > - Deprecated all endpoints within the __Mortgage API__.
    > - Deprecated all endpoints within the __Home Insurance API__.
    > - Deprecated all endpoints within the __Broadband API__.

    **Version 1.9.0: 14/10/2021**
    > - Addition of a new endpoint `/v2/open-banking/authorisation-gateway-url` to allow clients to use an updated
    Bud Connect flow, allowing their customer's to go through a new Account Connection journey. The v2 journey is 
    highly configurable via the use of different flags within the request payload.

    **Version 1.8.3: 06/10/2021**
    > - General bug fixes and improvements across examples, schemas, endpoints descriptions, names and sectioning titles.

    **Version 1.8.2: 16/09/2021**
    > - Altered the List Consents endpoint to now take in an optional `X-Customer-Secret` field within the request headers. If done so, each consent object will now return a list of `account_ids` associated with the consent object in addition to a date denoting the date a which a refresh was successfully completed for that given consent object.

    **Version 1.8.1: 07/09/2021**
    > - Added a new Submit Authorisation Codes endpoint for use within the Payments flows when using Bud as a technical service provider.

    **Version 1.8.0: 01/09/2021**
    > - Deprecated __Warnings__ endpoint within the Signal API
    > - Added a new __Money Management__ endpoint within the Signal API that allows clients to provide more detailed information regarding a customer's financial situation.
    > - Added a new __Customer Characteristics__ endpoint within the Signal API that allows clients to profile based on a customer's transactions.
    > - Added a new __Financial Insight__ endpoint within the Signal API that allows clients to understand a customer's overall financial situation and affordability.

    **Version 1.7.10: 06/08/2021**
    > - Updated the List Transaction Response schema to detail the addition of the new carbon tracker enrichment field. 

    **Version 1.7.9: 03/08/2021**
    > - The `customer_secret` attribute is now a required attribute on the POST Ingest Accounts endpoint.
    > - Updated the List Transaction Response schema to detail those fields that are required and/or nullable.
    > - Created a new Create Transaction Rule(s) endpoint that allows client to set a value of the `client_label` attribute against a set of customer transactions which adhere to the rules specified in the request payload.
    > - Updated API Overview table in the introduction to include latest product set.
    > - Removed deprecated Financial Assistant endpoints.

    **Version 1.7.8: 28/05/2021**
    > - Addition of some optional fields to the POST Retrieve Authorisation Gateway URL endpoint. The additional fields allow clients to specify: (i) a single provider, effectively skipping the select provider screen in the customer UI; (ii) a list of providers, allowing clients to configure the list of providers shown to the customer on the select provider screen; and (iii) filter the provider list shown to the customer by the type of provider (e.g. business or personal). In addition, a `connect_more_accounts_button` flag can be configured to show the customer a button at the end of the connection flow that will allow them to connect to another provider without having to return to the client application.

    **Version 1.7.7: 15/04/2021**
    > - Updated the examples within Bud's KYC endpoints to make them more usable against Bud's sandbox environment.
    > - Addition of a new GET `/v1/open-banking/account-access-consents` endpoint to allow clients to query the active consents against a given customer (in relation to Bud's OB Aggregation service).

    **Version 1.7.6: 17/03/2021**
    > - Addition of a new "Regular Payment Changed" Insight to the Warnings Endpoint (that forms part of Bud's Signal Product).
    > - Bugfix: addition of the required `mobile_phone_number` field to the request payload of the Switch Supplier endpoint within the Energy Switching API to align to the implementation of the API itself.
    > - Bugix: the format of the `annual_spend.amount` field within the request payload of the kWh Estimation endpoint now states that is should be a number (as opposed to a string) to align to the API itself.

    **Version 1.7.5: 10/02/2021**
    > - Fixed bug in the List Accounts endpoint for Bud's OB Aggregation service - the response data object now details all the returned fields as expected.
    > - Removed the deprecated List Account Balances endpoint from the documentation entirely.
    > - Added a new __Ingest Accounts__ endpoint within the Enrichment API that allows clients to provide more detailed information regarding a customer's account.

    **Version 1.7.4: 25/01/2021**
    > - Addition of a Know Your Customers (KYC) API allowing clients to perform KYC checks on businesses or their customers.
    > - \[**BREAKING**\] The `X-Customer-Secret` is now a required field within the headers of the `/v1/open-banking/authorisation-gateway-url` endpoint. **Please note that this change will only come into effect in three months time on the 1st of May 2021**. All clients with exisitng integrations will be contacted via email by their relevant account manager to inform them of this change. This should provide clients with enough time adjust their integration before the change coming into force. Please contact `help@thisisbud.com` or your account manager if you have any questions, issues or concerns relating to this update.

    **Version 1.7.3: 11/01/2021**
    > - Addition of the changelog to the api docs, and further information around updates and versioning.
    > - Documentation Bug Fix: `redirect_url` field is now shown as required within the **POST** `/v1/open-banking/authorisation-url` endpoint. This affects those clients using Bud's TSP Aggregation Service.

    **Version 1.7.2: 18/12/2020**
    > - Introduction of a new payment service within Bud's Payment API. Clients are now able to initiate __Scheduled Payments__ from Bud's Payments service. The scheduled payments service is available to those clients using Bud as a TPP (i.e. via Bud Pay) and as a TSP.
    > - Bud have now released their __First Party Transactions Ingestion__ endpoint. This allows clients to simply post Bud some of their customer's transactions, which will then be run through each of Bud's enrichment and insights services and then stored securely. This opens up Bud's plethora of Insights services, Signal, and Financial Review to those clients with first-party transactional data.

    **Version 1.7.1: 06/12/2020**
    > - Few changes to the Payments endpoint responses, including:
    >   - the GET providers endpoint, `required_actions` field now becomes an array (as opposed to an object) and is populated with string enums which are now clearly described in the schema.
    >   - the response of the create Single Payment and Standing Order endpoints now includes a `required_action` field as opposed to required_actions (since there will only ever be one next required action). If this field appears within the response then clients must take another action in order to complete the payment flow.
    >   - the payment status endpoint also now includes the `required_action` field, which if not null, clearly indicates that the client is required to perform the necessary action in order for the payment to complete.
    >   - updated the payment service enums within the response of the GET providers endpoint, since each provider can now potentially offer `domestic-single-payment`, `domestic-standing-order` and (soon to be) `domestic-scheduled-payment` services.
    > - Added extra information within the description of various Rent Recognition endpoints. This should provide clients with a much clearer understanding of which endpoints are needed and why in order to integrate the entire RR journey.

    **Version 1.7.0: 27/11/2020**
    > - Added a new POST /v2/customers endpoint that allows clients to create up to 200 customers in a single request.
    > - \[**BREAKING**\] Deprecated Financial Assistant endpoints (warnings / trends / forecast) and introduced these endpoints under a new API called Signal with updated urls and operation_ids.
    > - Altered description of the OB Aggregation TPP Retrieve Authorisation Gateway URL to include for information into its usage.
    > - Introduction of a new set of Payments based endpoints allowing customers to set up and authorise standing orders from one of Bud’s supported providers. This comes in the form of:
    >   - a new TPP endpoint, where clients can now request a new Bud Pay URL to allows customers to set up a new standing order; and
    >   - a new set of TSP endpoints, allowing clients to integrate Bud APIs to allow their customers to initiate standing orders.

    **Version 1.6.5: 10/09/2020**
    > - Addition of the `period` field to the __GET__ `/v1/salary` endpoint to provide an indication into any regulatory associated with a predicted salary transaction.

    **Version: 1.6.4: 06/08/2020**
     > - \[**BREAKING**\] Deprecated the use of `bank_name` in relevant schemas within Bud’s OB Aggregation API in favour of of the field `provider`
     > - Updated Affordability API title to Financial Review API and provided an updated description of the API.
     > - Updated the product table within the introduction to reflect new titles and descriptions across Bud’s API services.

    **Version: 1.6.3 - 20/07/2020**
     > - Added a new endpoint for the OB Aggregation TSP flow - __POST__ `/v1/open-banking/authorisation-codes`. It allows clients to send back the parameters they receive from the bank once the customer has completed the authorisation process. This allows Bud to match the state to the relevant task id, and also provides the relevant code that will allow Bud to start fetching the customer’s data from the provider.

    **Version: 1.6.2 - 16/07/2020**
     > - Addition of international updates to payments APIs
     > - Updated energy switching meters example to ensure that it will return meter information for the address given in the example. 

    **Version: 1.6.0 - 15/06/2020**
     > - Financial Assistant service added to the Insights API. This includes three brand new endpoints that help customers to better manage their financial world.
     >   - _Retrieve Warnings_: provides a list of potential scenarios where a customer might suffer some financial expense (e.g. in their overdraft, cannot cover bills, late payment and late income)
     >   - _Retrieve Trends_: provides the key trends associated with a customer’s transactional data broken down by month
     >   - _Retrieve Forecast_ - provides a list of the regular and predicted transactions over a given period, noting whether they are booked, pending or predicted.
     > - Affordability Service added to the documentation, including a brand new endpoint to help clients to assess their customers affordability. The _Create Spending Groups_ endpoint allows clients to create their own custom group, e.g. Discretionary Spend, where they can select which of Bud’s categories and/or subcategories will make up the group. All transactions for that customer assigned to the categories/subcategories within the group will be bucketed up and the client will be able to see the total income and expenditure in those categories over a given period of time.

    **Version: 1.5.3 - 22/05/2020**
     > - Added Payments: List Payment Status endpoint in order to retrieve paginated details of multiple payment ids based on header filters
     > - General bug fixes and improvements across examples, schemas, endpoints descriptions, names and sectioning titles.

    **Version: 1.5.0 - 08/04/2020**
     > - Addition of Bud’s Payment Initiation API. The endpoints provide clients with the functionality to allow their customers to make payments from one of their bank accounts, to a chosen recipient. In their first iteration, customers are able to authorise a single payment from one of their UK based bank accounts to another UK bank account.
     > - Addition of a Category Totals endpoint. The endpoint allows clients to retrieve the total amount of money that is moving into and out of their customers' connected bank accounts, broken down by transaction category. The endpoint breaks the totals down by both tier 1 and tier 2 type categories (as is provided by Buds dual layered categorisation engine).
     > - Acceptance of a new transaction schema format for all 1st Party Enrichment Endpoints. All of Bud’s first party data enrichment endpoints (i.e. __POST__`/v1/categorise/double-cat`, __POST__`/v1/regular-payments`, __POST__`/v1/merchants`) are now able to accept the transaction format outputted by TrueLayer. This makes it even easier for those clients who are using TrueLayer as an aggregator to get the use of Bud’s enrichment services.

    # Authentication

    <SecurityDefinitions />
x-tagGroups:
  -
    name: ''
    tags:
      - 'Connect API'
      - 'Create a Connection'
      - 'Manage a Connection'
      - 'Ingest First Party Data'
  -
    name: ''
    tags:
      - 'Customers API'
      - 'Manage Customers'
  -
    name: ''
    tags:
      - 'Enrichment API'
      - 'Enrichment Resources'
      - 'Enrichment Totals'
  -
    name: ''
    tags:
      - 'Financial Data API'
      - 'Fetch Financial Data'
      - 'Manage Financial Data'
  -
    name: ''
    tags:
      - 'Financial Insights API'
      - 'Regular Insights'
      - 'Income Insights'
      - 'Expenditure Insights'
  -
    name: ''
    tags:
      - 'Financial Review API'
      - 'Assess Affordability'
      - 'Affordability Report'
  -
    name: ''
    tags:
      - 'KYC API'
      - 'Perform KYC Check'
  -
    name: ''
    tags:
      - 'Payments API'
      - 'Initiate Payment - TPP'
      - 'Initiate Payment - TSP'
      - 'Manage Payments'
  -
    name: ''
    tags:
      - 'Signal API'
      - 'Everyday Money Management'
      - 'Customer Characteristics'
      - 'Income and Expenditure Insight'
      - 'Custom Signals'
tags:
  -
    name: 'Connect API'
    x-displayName: 'Connect API'
    x-traitTag: true
    description: |
      These endpoints handle the connections to Open Banking providers (ASPSPs) and the ingestion of first party transaction data. Bud manages all of the connections to each of the individual ASPSPs and enables access to all of the providers via a single set of API endpoints.

      Bud currently supports three methods of connecting your customers data to the Bud platform:

        1. You can use the [__Bud Connect__](#operation/v2_ob_authorisation_gateway_url_post) endpoint which returns a link to Bud’s pre-built Open Banking customer connection journey that can be configured to your brand.

        2. If you have your own license you can choose to host the Open Banking customer connection journey yourself, using [Bud's APIs](#operation/open_banking_authorisation_url_post) to create the connection. __If you are an agent of Bud but feel that your application could benefit from a more native feel please talk to your Bud Account Manager or email help@thisisbud.com for further details.__

        3. If you already have transactional data that you’re looking to enrich, you can use Bud’s [Ingest Endpoints](#tag/Ingest-Data) to push your data onto the Bud platform without needing your customers to connect their accounts via Open Banking. 
        
      Note: a number of the calls within this service are asynchronous, and as such, follow a pattern of sending a request and responding with a task ID. This task ID can then be tracked, allowing for a more efficient, cross network implementation.
  -
    name: 'Create a Connection'
    x-displayName: 'Create a Connection'
    description: |
      Create a new connection to an Open Banking provider by using either: (i) Bud's configurable frontend UI (__Bud Connect__), built to maximise conversion; or (ii) Bud's individual API endpoints to help you build your own connect flow.
  -
    name: 'Manage a Connection'
    x-displayName: 'Manage a Connection'
    description: |
      Different endpoints that allow to to manage an existing customer connection. This includes the ability to:
        (i) Refresh the data associated with a given connection, pulling in the latest account 
            information into the Bud platform;
        (ii) Renew an existing consent  by-passing the need to go through Strong Customer 
            Authentication (SCA) with their bank;
        (iii) Revoke a consent, removing the ability for Bud to fetch any further data associated
            with that consent.
  -
    name: 'Ingest First Party Data'
    x-displayName: 'Ingest First Party Data'
    description: |
      Initiate the asynchronous process of pushing a customer's account information (i.e. first party data) onto the Bud platform. These asynchronous requests create a task to store the given accounts or transactions against the specified customers. The Task ID returned by this request can be used to verify the current status of the process.
  -
    name: 'Customers API'
    x-displayName: 'Customers API'
    x-traitTag: true
    description: |

      The Customers API allows for the manipulation of a client's "Customers" as registered on the Bud platform. The API is built around resource-oriented URLs, returns JSON-encoded responses, uses standard HTTP response codes and authentication.
  -
    name: 'Manage Customers'
    x-displayName: 'Manage Customers'
    description: |
      Manage the number of customers registered onto the Bud platform.
  -
    name: 'Enrichment API'
    x-displayName: 'Enrichment API'
    x-traitTag: true
    description: |
      Enrich transactional data you already hold, or have aggregated through Open Banking, using Bud's core enrichment services.
  -
    name: 'Enrichment Resources'
    x-displayName: 'Enrichment Resources'
    description: |
      Obtain greater context to Bud's enrichment services.
  -
    name: 'Enrichment Totals'
    x-displayName: 'Enrichment Totals'
    description: |
      Breakdown your customer's income and expenditure based on Bud's enrichments to help orientate their financial world.
  -
    name: 'Financial Data API'
    x-displayName: 'Financial Data API'
    x-traitTag: true
    description: |

      These endpoints handle the aggregation and retrieval of financial data. They are designed to be generic across
      a range of ingestion sources and regions.
  -
    name: 'Fetch Financial Data'
    x-displayName: 'Fetch Financial Data'
    description: |
      Retrieve a customer's financial data from a range of sources.
  -
    name: 'Manage Financial Data'
    x-displayName: 'Manage Financial Data'
    description: |
      Manipulate Transactions held on the Bud platform by removing data, submitting corrections, or adding tags through different rulesets.
  -
    name: 'Financial Insights API'
    x-displayName: 'Financial Insights API'
    x-traitTag: true
    description: |
      Get insights about spending, identify key transactions and create your own custom transaction labels to dig deeper into the data and build new services for customers.
  -
    name: 'Regular Insights'
    x-displayName: 'Regular Insights'
    description: |
      Obtain insights relating to any regularity found across certain groups of transactions within your customer's accounts.
  -
    name: 'Income Insights'
    x-displayName: 'Income Insights'
    description: |
      Obtain insights regarding your customer's income.
  -
    name: 'Expenditure Insights'
    x-displayName: 'Expenditure Insights'
    description: |
      Obtain insights regarding your customer's expenditure.
  -
    name: 'Financial Review API'
    x-displayName: 'Financial Review API'
    x-traitTag: true
    description: |
      Obtain a deeper understanding of your customers' transactional data and use these endpoints to help build affordability and fact-finding tools.
  -
    name: 'Assess Affordability'
    x-displayName: 'Assess Affordability'
    description: |
      Breakdown your customers' income and spending by customisable groupings based on Bud's enrichments to inform affordability calculations.
  -
    name: 'Affordability Report'
    x-displayName: 'Affordability Report'
    description: |
      Breakdown your customer's transactions by fixed/flexible spend and discretionary vs non discretionary high-level totals.
  -
    name: 'KYC API'
    x-displayName: 'KYC API'
    x-traitTag: true
    description: |
      Bud's Know Your Customer (KYC) API allows you to perform relevant checks against businesses and customers. This API uses the 
      Northrow API in order to perform the physical checks against a business or customer. The functionality is provided on a needs
      must basis for those clients who are unable to perform the necessary KYC checks required in order to use Bud's Open Banking
      Aggregation and Payment Services. Please contact your account manager for further details or email `help@thisisbud.com`.
  -
    name: 'Perform KYC Check'
    x-displayName: 'Perform KYC Check'
    description: |
      Perform a KYC check against a company (business) or person (customer).
  -
    name: 'Payments API'
    x-displayName: 'Payments API'
    x-traitTag: true
    description: |

      These endpoints allow Bud's Clients to initiate (i.e. make) payments through the use of Open Banking Payment APIs.
      Bud manages the connections to each of the payment providers, and serves these connections under a single set of API endpoints, enabling Bud's clients (and in turn their customers) to initiate a payment from one of these providers to a chosen recipient.

      Bud currently supports two methods for initiating payments with available providers:

        1. If you are not regulated to provide payment initiation services, or if you are regulated but do not wish to use
        your own permissions, then use Bud's [TPP Initiation](#tag/TPP-Initiation) endpoints.
        2. If on the other hand, your are regulated as an Payment Initiation Service Provider (PISP), then you are able to use Bud
        as a Technical Service Provider (see [TSP Initiation](#tag/TSP-Initiation)).
  -
    name: 'Initiate Payment - TPP'
    x-displayName: 'Initiate Payment - TPP'
    description: |
      Authenticates and securely creates a new payment from a customer’s chosen account(s) using Bud's regulatory licence as a
      [Third Party Provider (TPP)](https://www.openbanking.org.uk/providers/third-party-providers/) of Payment Initiation Services.
  -
    name: 'Initiate Payment - TSP'
    x-displayName: 'Initiate Payment - TSP'
    description: |
      Authenticates and securely creates a new payment from a customer’s chosen account(s) using your organisation's regulatory
      permission as a Payment Initiation Service Provider (PISP).
  -
    name: 'Manage Payments'
    x-displayName: 'Manage Payments'
    description: |
      Manage payments to initiated through Bud's Payments API      
  -
    name: 'Signal API'
    x-displayName: 'Signal API'
    x-traitTag: true
    description: |
      Contextual, relevant triggers and notifications that drive action from customers.
  -
    name: 'Everyday Money Management'
    x-displayName: 'Everyday Money Management'
    description: |
      Help your customers stay on top of their financial situation with helpful and timely notifications
  -
    name: 'Customer Characteristics'
    x-displayName: 'Customer Characteristics'
    description: |
      Understand your customers profile and what type of services they could benefit from
  -
    name: 'Income and Expenditure Insight'
    x-displayName: 'Income and Expenditure Insight'
    description: |
      Understand your customers overall financial situation and affordability.
  -
    name: 'Custom Signals'
    x-displayName: 'Custom Signals'
    description: |
      Understand and target messaging to your customers more effectively by defining your own custom segmentations.
servers:
  -
    url: 'https://api-sandbox.thisisbud.com'
paths:
  /v1/open-banking/providers:
    get:
      tags:
        - 'Create a Connection'
      summary: 'List OB Providers'
      description: |
        List the available account providers with their name, icon and maintenance status.
      operationId: open_banking_providers_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/OBProvidersQueryTypeFilter'
      responses:
        200:
          description: 'List of providers available via Bud''s Open Banking Aggregation APIs'
          content:
            application/json:
              schema:
                required:
                  - operation_id
                  - data
                properties:
                  operation_id:
                    $ref: 'components.yaml#/schemas/OperationId'
                  data:
                    type: array
                    items:
                      $ref: 'components.yaml#/schemas/OBProvider'
                example:
                  operation_id: open_banking_providers_get
                  data:
                    -
                      provider: barclays
                      display_name: Barclays
                      maintenance_window:
                        start: '2019-08-07T11:48:00+0000'
                        end: '2019-08-07T11:00:00+0000'
                      maintenance_status: active
                      icon: 'https://assets.thisisbud.com/example-icon'
                      regions:
                        - GBR
                    -
                      provider: fd
                      display_name: 'first direct'
                      maintenance_window: null
                      maintenance_status: inactive
                      icon: 'https://assets.thisisbud.com/example-icon'
                      regions:
                        - GBR
                    -
                      provider: halifax
                      display_name: Halifax
                      maintenance_window: null
                      maintenance_status: inactive
                      icon: 'https://assets.thisisbud.com/example-icon'
                      regions:
                        - GBR
                    -
                      provider: hbos
                      display_name: 'Bank of Scotland'
                      maintenance_window: null
                      maintenance_status: inactive
                      icon: 'https://assets.thisisbud.com/example-icon'
                      regions:
                        - GBR
                    -
                      provider: hsbc
                      display_name: HSBC
                      maintenance_window: null
                      maintenance_status: inactive
                      icon: 'https://assets.thisisbud.com/example-icon'
                      regions:
                        - GBR
                    -
                      provider: lloyds
                      display_name: Lloyds
                      maintenance_window: null
                      maintenance_status: inactive
                      icon: 'https://assets.thisisbud.com/example-icon'
                      regions:
                        - GBR
                    -
                      provider: mns
                      display_name: 'Marks & Spencer'
                      maintenance_window: null
                      maintenance_status: inactive
                      icon: 'https://assets.thisisbud.com/example-icon'
                      regions:
                        - GBR
                    -
                      provider: nationwide
                      display_name: Nationwide
                      maintenance_window: null
                      maintenance_status: inactive
                      icon: 'https://assets.thisisbud.com/example-icon'
                      regions:
                        - GBR
                    -
                      provider: natwest
                      display_name: Natwest
                      maintenance_window: null
                      maintenance_status: inactive
                      icon: 'https://assets.thisisbud.com/example-icon'
                      regions:
                        - GBR
                    -
                      provider: rbs
                      display_name: 'Royal Bank of Scotland'
                      maintenance_window: null
                      maintenance_status: inactive
                      icon: 'https://assets.thisisbud.com/example-icon'
                      regions:
                        - GBR
                    -
                      provider: santander
                      display_name: Santander
                      maintenance_window: null
                      maintenance_status: inactive
                      icon: 'https://assets.thisisbud.com/example-icon'
                      regions:
                        - GBR
        400:
          description: 'Bad Request that fails validations on headers & payload'
        401:
          description: 'Unauthorized (BearerToken in ''Authorization'' header fails the authentication)'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/open-banking/authorisation-gateway-url:
    post:
      tags:
        - 'Create a Connection'
      summary: 'Retrieve Authorisation Gateway URL'
      deprecated: true
      description: |
        Allow customers to authorise with, and connect to, a provider, using Bud’s regulatory permission as an Account Information Service Provider (AISP) using __Bud Connect__. Bud Connect is a piece of frontend UI that can be integrated into any mobile or web experience, and allows your customers to connect to and authorise with their chosen provider, allowing Bud to pull their account information using Bud's AISP license. 

        Use Bud’s Authorisation Gateway (__Bud Connect__) if you are not regulated as an AISP in order to connect your customers to their banks to share account information. You may still choose to use __Bud Connect__ in order to give the customer a slick account connection experience or to speed up your technical build and integration, even if you are a regulated AISP yourself.

        The status of the authorisation step will be provided to you as a path parameter within the `redirect_url` specified within the request payload. This `redirect_url` is where your customer will be redirected to once they have either failed, or successfully completed, the authorisation process with their provider.

        Please note that in order to recieve status updates on a given account connection task, you will need to configure your Callback URL within the developer console. Once the entire connection process has been completed and the customer's account information is ready to be collected via the Retrieve OB Data Endpoints, Bud will send a request to your callback URL.
      operationId: ob_authorisation_gateway_url_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/AuthGatewayURLRequest'
            examples:
              'All providers':
                value:
                  redirect_url: 'https://my-agent-webapp.com/connected?my-parameter=xyz'
              'Filter providers list':
                value:
                  redirect_url: 'https://my-agent-webapp.com/connected?my-parameter=xyz'
                  provider_types:
                    - retail
              'Specify provider(s)':
                value:
                  redirect_url: 'https://my-agent-webapp.com/connected?my-parameter=xyz'
                  providers:
                    - Barclays
                    - Lloyds
                    - Natwest
              'Show the "connect more accounts" button':
                value:
                  redirect_url: 'https://my-agent-webapp.com/connected?my-parameter=xyz'
                  connect_more_accounts_button: true
              'Enable account data mangement':
                value:
                  redirect_url: 'https://my-agent-webapp.com/connected?my-parameter=xyz'
                  'enable_account_data_management"': true
      responses:
        201:
          description: 'The resource has been successfully created.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/AuthGatewayURLResponse'
              example:
                operation_id: ob_authorisation_gateway_url_post
                data:
                  url: 'https://auth.gateway.thisisbud.com/connect?nonce=nu9ysswxk3hnrepo&token=b361e184038e25077cab277ede9362289941da928cd0d9c7ea52107aa2ad0d909d87993a532af47d9794cd5f29ba66128b3dc7f705ce9b044c636c28e31e1bb3ff8e17145a49f42f525bff51945c3a2484c89a05c1b1e484f9b84ee0cfee4640453fd599e71b5111bd880a63cc924fca8c6ce831396e2f4f8b3e5ac994c5c9'
        400:
          description: 'The request contains an invalid payload.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: ob_authorisation_gateway_url_post
                code_id: failed_validation
                message: 'Failed validation.'
                errors:
                  redirect_url: 'This value should not be blank.'
        401:
          description: 'An unauthorised request was received.'
        405:
          description: 'The request uses an unexpected HTTP method.'
        422:
          description: 'Unprocessable request (e.g. requested providers are in maintenance)'
        5XX:
          description: 'An unexpected error occurred on the server side.'
      callbacks:
        EventSubscriptionCallBack:
          '{$request.body#/redirect_url}':
            description: |
              This callback is sent to your configured Open Banking Sync Complete webhook URL on the completion of a relevant OB synchronisation task.
            post:
              parameters:
                -
                  $ref: 'components.yaml#/parameters/SignatureHeaderParameter'
                -
                  $ref: 'components.yaml#/parameters/SigningIdHeaderParameter'
              summary: 'Aggregation Sync Notification Callback'
              requestBody:
                required: true
                description: 'This callback is sent to your configured Open Banking Sync Complete webhook URL on the completion of a relevant OB synchronisation task.'
                content:
                  application/json:
                    schema:
                      $ref: 'components.yaml#/schemas/OBSyncWebhookBody'
                    example:
                      data:
                        task_id: 03af1639-78a6-402d-809b-902a0b00a77d
                        status: Completed
                        task_type: connect
                        customer_id: b6f898f8-99e8-4529-8e90-64d96fe05aa4
              responses:
                200:
                  description: 'Your server returns this code if it accepts the callback'
                300:
                  description: 'The notification will not be retried, redirects will not be followed'
                400:
                  description: 'The notification will not be retried'
                500:
                  description: |
                    The request will be retried shortly. If it fails multiple times, we will stop attempting to deliver the
                    notification for this single event.
  /v2/open-banking/authorisation-gateway-url:
    post:
      tags:
        - 'Create a Connection'
      summary: 'Retrieve Authorisation Gateway URL (v2)'
      description: |
        Allow customers to authorise with, and connect to, a provider, using Bud’s regulatory permission as an Account Information Service Provider (AISP) using __Bud Connect__. Bud Connect is a piece of frontend UI that can be integrated into any mobile or web experience, and allows your customers to connect to and authorise with their chosen provider, allowing Bud to pull their account information using Bud's AISP license.

        Version 2 of the Bud Connect flow provides customer's with an updated connection flow and includes a number of different parameters within the API itself that can be used to configure the journey to a clients needs. Please refer to the request schema for further details.

        Use Bud’s Authorisation Gateway (__Bud Connect__) if you are not regulated as an AISP in order to connect your customers to their banks to share account information. You may still choose to use __Bud Connect__ in order to give the customer a slick account connection experience or to speed up your technical build and integration, even if you are a regulated AISP yourself.

        The status of the authorisation step will be provided to you as a path parameter within the `redirect_url` specified within the request payload. This `redirect_url` is where your customer will be redirected to once they have either failed, or successfully completed, the authorisation process with their provider.

        Please note that in order to recieve status updates on a given account connection task, you will need to configure your Callback URL within the developer console. Once the entire connection process has been completed and the customer's account information is ready to be collected via the Retrieve OB Data Endpoints, Bud will send a request to your callback URL.
      operationId: v2_ob_authorisation_gateway_url_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/AuthGatewayURLRequestv2'
            examples:
              'All providers':
                value:
                  redirect_url: 'https://my-agent-webapp.com/connected?my-parameter=xyz'
              'Filter providers list':
                value:
                  redirect_url: 'https://my-agent-webapp.com/connected?my-parameter=xyz'
                  provider_types:
                    - retail
              'Specify provider(s)':
                value:
                  redirect_url: 'https://my-agent-webapp.com/connected?my-parameter=xyz'
                  providers:
                    - Barclays
                    - Lloyds
                    - Natwest
              'Show the "connect more accounts" button':
                value:
                  redirect_url: 'https://my-agent-webapp.com/connected?my-parameter=xyz'
                  connect_more_accounts_button: true
              'Show the account connection summary screen':
                value:
                  redirect_url: 'https://my-agent-webapp.com/connected?my-parameter=xyz'
                  accounts_summary: true
              'Show the initial screen as the account summary screen':
                value:
                  redirect_url: 'https://my-agent-webapp.com/connected?my-parameter=xyz'
                  'initial_screen"': accounts_summary
              'Enable account data mangement':
                value:
                  redirect_url: 'https://my-agent-webapp.com/connected?my-parameter=xyz'
                  'enable_account_data_management"': true
      responses:
        201:
          description: 'The resource has been successfully created.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/AuthGatewayURLResponse'
              example:
                operation_id: v2_ob_authorisation_gateway_url_post
                data:
                  url: 'https://auth.gateway.thisisbud.com/connect?nonce=nu9ysswxk3hnrepo&token=b361e184038e25077cab277ede9362289941da928cd0d9c7ea52107aa2ad0d909d87993a532af47d9794cd5f29ba66128b3dc7f705ce9b044c636c28e31e1bb3ff8e17145a49f42f525bff51945c3a2484c89a05c1b1e484f9b84ee0cfee4640453fd599e71b5111bd880a63cc924fca8c6ce831396e2f4f8b3e5ac994c5c9'
        400:
          description: 'The request contains an invalid payload.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v2_ob_authorisation_gateway_url_post
                code_id: failed_validation
                message: 'Failed validation.'
                errors:
                  redirect_url: 'This value should not be blank.'
        401:
          description: 'An unauthorised request was received.'
        405:
          description: 'The request uses an unexpected HTTP method.'
        422:
          description: 'Unprocessable request (e.g. requested providers are in maintenance)'
        5XX:
          description: 'An unexpected error occurred on the server side.'
      callbacks:
        EventSubscriptionCallBack:
          '{$request.body#/redirect_url}':
            description: |
              This callback is sent to your configured Open Banking Sync Complete webhook URL on the completion of a relevant OB synchronisation task.
            post:
              parameters:
                -
                  $ref: 'components.yaml#/parameters/SignatureHeaderParameter'
                -
                  $ref: 'components.yaml#/parameters/SigningIdHeaderParameter'
              summary: 'Aggregation Sync Notification Callback'
              requestBody:
                required: true
                description: 'This callback is sent to your configured Open Banking Sync Complete webhook URL on the completion of a relevant OB synchronisation task.'
                content:
                  application/json:
                    schema:
                      $ref: 'components.yaml#/schemas/OBSyncWebhookBody'
                    example:
                      data:
                        task_id: 03af1639-78a6-402d-809b-902a0b00a77d
                        status: Completed
                        task_type: connect
                        customer_id: b6f898f8-99e8-4529-8e90-64d96fe05aa4
              responses:
                200:
                  description: 'Your server returns this code if it accepts the callback'
                300:
                  description: 'The notification will not be retried, redirects will not be followed'
                400:
                  description: 'The notification will not be retried'
                500:
                  description: |
                    The request will be retried shortly. If it fails multiple times, we will stop attempting to deliver the notification for this single event.
        ConnectCompletedCallBack:
          '{$request.body#/redirect_url}':
            description: |
              This callback is sent to your configured Open banking connection completed webhook URL on the completion of a connect task.
            post:
              parameters:
                -
                  $ref: 'components.yaml#/parameters/SignatureHeaderParameter'
                -
                  $ref: 'components.yaml#/parameters/SigningIdHeaderParameter'
              summary: 'Connect Completed Notification Callback'
              requestBody:
                required: true
                description: 'This callback is sent to your configured ''Open banking connection completed'' webhook URL on the completion of a connect task.'
                content:
                  application/json:
                    schema:
                      $ref: 'components.yaml#/schemas/OBWebhookBody'
                    example:
                      data:
                        task_id: 03af1639-78a6-402d-809b-902a0b00a77d
                        status: Failed
                        result: provider_failure
                        task_type: connect
                        customer_id: b6f898f8-99e8-4529-8e90-64d96fe05aa4
              responses:
                200:
                  description: 'Your server returns this code if it accepts the callback'
                300:
                  description: 'The notification will not be retried, redirects will not be followed'
                400:
                  description: 'The notification will not be retried'
                500:
                  description: |
                    The request will be retried shortly. If it fails multiple times, we will stop attempting to deliver the notification for this single event.   
  /v1/open-banking/authorisation-url:
    post:
      tags:
        - 'Create a Connection'
      summary: 'Initiate Provider Authorisation'
      description: |
        Request a new Open Banking authorisation url for a specific Customer and provider.
      operationId: open_banking_authorisation_url_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/OpenBankingAuthoriseRequest'
            examples:
              Provider:
                value:
                  provider: Barclays
                  redirect_url: 'https://myclientredirecturl.com'
      responses:
        102:
          description: 'An identical request has been accepted for processing but has not yet been completed'
        202:
          description: 'A new Task has been created to obtain the bank''s authorisation URL. The generated `task_id` can be used to check the Task''s status'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/TaskCreatedResponseOB'
              example:
                operation_id: open_banking_authorisation_url_post
                data:
                  task_id: 360e5821-4f18-4077-83f4-c9a7c1768bea
                  provider: Barclays
                metadata:
                  next_url: /v1/open-banking/authorisation-url/360e5821-4f18-4077-83f4-c9a7c1768bea
                  next_url_delay: 50
        400:
          description: 'The request contains an invalid payload'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              examples:
                'Parameter missing':
                  value:
                    operation_id: open_banking_authorisation_url_post
                    code_id: failed_validation
                    message: 'Failed validation'
                    errors:
                      customer_id: 'This value should not be blank'
                'Resource not found':
                  value:
                    operation_id: open_banking_authorisation_url_post
                    code_id: resource_not_found
                    message: 'Consent ID could not be found.'
                    errors:
                      domain_error: 'Consent ID could not be found.'
                'Provider in Maintenance':
                  value:
                    operation_id: open_banking_authorisation_url_post
                    code_id: provider_maintenance
                    message: 'The provider is in maintenance.'
                    errors:
                      provider: 'The provider is currently disabled due to planned maintenance or known issues.'
        401:
          description: 'Unauthorized (BearerToken in ''Authorization'' header fails the authentication)'
        405:
          description: 'The request uses an unexpected HTTP method'
        5XX:
          description: 'An unexpected error occurred on the server side'
  '/v1/open-banking/authorisation-url/{task_id}':
    get:
      tags:
        - 'Create a Connection'
      summary: 'Retrieve Authorisation URL'
      description: |
        Check the status and get the result of an Initiate Provider Authorisation URL task. If the task is not yet completed, the data element will be null.

        Once the customer has successfully authorised with the ASPSP, Bud will create a task to fetch the relevant data from the ASPSP. The task id created will be passed back within the supplied re-direct url. Please refer to the Check Connection Status endpoint for updates on this fetching process using the task id provided in the redirect URL.
      operationId: open_banking_authorisation_url_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/TaskId'
      responses:
        200:
          description: 'The request was successfully processed.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/TaskAuthoriseResponse'
              examples:
                complete:
                  summary: Completed
                  value:
                    operation_id: open_banking_authorisation_url_get
                    data:
                      provider: example_provider
                      result: success
                      status: Completed
                      task_id: 16fa0748-8a6b-455b-9be9-30ae257965d8
                      url: 'https://oauth.example.provider.com/authorization.oauth2?'
                    metadata:
                      next_url: /v1/open-banking/authorisation-url/16fa0748-8a6b-455b-9be9-30ae257965d8
                      next_url_delay: 50
                      status: Completed
                pending:
                  summary: Pending
                  value:
                    operation_id: open_banking_authorisation_url_get
                    metadata:
                      status: Pending
                      next_url: /v1/open-banking/authorisation-url/16fa0748-8a6b-455b-9be9-30ae257965d8
                      next_url_delay: 50
                failed:
                  summary: Failed
                  value:
                    operation_id: open_banking_authorisation_url_get
                    metadata:
                      status: Failed
                      next_url: /v1/open-banking/authorisation-url/16fa0748-8a6b-455b-9be9-30ae257965d8
                      next_url_delay: 50
        400:
          description: 'The request contains an invalid payload'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: open_banking_authorisation_url_get
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  customer_id: 'This value should not be blank'
        404:
          description: 'Task not found'
        405:
          description: 'The request uses an unexpected HTTP method'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/open-banking/authorisation-codes:
    post:
      tags:
        - 'Create a Connection'
      summary: 'Submit Authorisation Codes'
      description: |
        When using Bud as a TSP (Technical Service Provider) and doing full app-to-app authorisation, the customer is returned from the provider directly back to your app. Your app will then need to send all the query and hash fragment parameters to Bud so that we can complete the connection.

        Query and fragment parameters should be merged with query taking precedence. If you receive a request `/path?a=1#a=2&b=3` then you should perform this request with `{"a":"1","b":"3"}`.

        Regardless of what parameters are present, all of them should be sent to Bud so that we can choose to either continue the connection or to map and record the error.

        Code and error are shown here only because they are the most common parameters you will see, but this object could contain any number of unspecified properties. Currently state is a common property among all authorisation flows and is the current task ID. The state property is not guaranteed for the future of this API contract and will not be treated as backwards incompatible if a new authentication flow does not use it.
      operationId: open_banking_authorisation_codes_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/AuthorisationCodesRequest'
            examples:
              success:
                summary: 'Authorisation has been successful'
                value:
                  state: b55f5f00-8e40-4e9e-8c9e-a292a86eb40c
                  code: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9
              error:
                summary: 'Authorisation has failed'
                value:
                  state: b55f5f00-8e40-4e9e-8c9e-a292a86eb40c
                  error: access_denied
      responses:
        202:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/AuthorisationCodesResponse'
              examples:
                Success:
                  description: success
                  value:
                    operation_id: v1_open_banking_authorisation_codes_post
                    data:
                      task_id: b55f5f00-8e40-4e9e-8c9e-a292a86eb40c
                      provider: Barclays
                      status: Completed
                      result: success
                Error:
                  description: error
                  value:
                    operation_id: v1_open_banking_authorisation_codes_post
                    data:
                      task_id: b55f5f00-8e40-4e9e-8c9e-a292a86eb40c
                      provider: Barclays
                      status: Failed
                      result: auth_invalid
        400:
          description: 'The request contains an invalid payload'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              examples:
                'Invalid Body':
                  description: 'Invalid Body'
                  value:
                    operation_id: v1_open_banking_authorisation_codes_post
                    code_id: failed_body_decode
                    message: 'invalid request body'
                    errors:
                      customer_id: 'This value should not be blank'
                'Validation Failure':
                  description: 'Validation Error'
                  value:
                    operation_id: v1_open_banking_authorisation_codes_post
                    code_id: failed_validation
                    message: 'invalid request'
                    errors:
                      state: 'The field is required'
  '/v1/open-banking/connect/{connection_task_id}':
    get:
      tags:
        - 'Create a Connection'
      summary: 'Retrieve Connection Status'
      description: |
        Check the status of an account connection task. If the task is not yet completed, the status will be shown as pending. If the status is completed, then the data is ready to be ingested. 

        The __connection_task_id__ is provided as a parameter in the redirect url after the Customer has undergone a successful authorisation with a relevant Open Banking provider.
      operationId: open_banking_connect_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/ConnectionTaskId'
      responses:
        200:
          description: 'The request was successfully processed.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/OpenBankingConnectResponse'
              examples:
                completed:
                  summary: Completed
                  value:
                    operation_id: open_banking_connect_get
                    data:
                      provider: Barclays
                      step: 4
                      text: Completed
                    metadata:
                      status: Completed
                      next_url: /v1/open-banking/connect/360e5821-4f18-4077-83f4-c9a7c1768bea
                      next_url_delay: 50
                pending:
                  summary: Pending
                  value:
                    operation_id: open_banking_connect_get
                    data:
                      provider: Barclays
                      step: 2
                      text: 'Fetching accounts'
                    metadata:
                      status: Pending
                      next_url: /v1/open-banking/connect/360e5821-4f18-4077-83f4-c9a7c1768bea
                      next_url_delay: 50
                failed:
                  summary: Failed
                  value:
                    operation_id: open_banking_connect_get
                    data:
                      provider: Barclays
                      step: 3
                      text: 'Fetching balances and transactions'
                    metadata:
                      status: Failed
                      next_url: /v1/open-banking/connect/360e5821-4f18-4077-83f4-c9a7c1768bea
                      next_url_delay: 50
        400:
          description: 'The request contains an invalid payload'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: open_banking_connect_get
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  customer_id: 'This value should not be blank'
        404:
          description: 'Task not found'
        405:
          description: 'The request uses an unexpected HTTP method'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/open-banking/refresh:
    post:
      tags:
        - 'Manage a Connection'
      summary: 'Initiate Refresh'
      description: |
        Download a customer’s latest account information. Refresh the accounts from a single provider with an existing connection. If the customer's consent has expired for this provider, Bud will be unable to refresh the account. This will be confirmed in the response of the refresh status endpoint associated with the `task_id` provided in the response to this endpoint, where the `reconnect_required` field will set to `true`.
      operationId: open_banking_refresh_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/OpenBankingRefreshRequest'
            example:
              provider: Barclays
              from: '2019-01-01T00:00:00+00:00'
              to: '2019-06-01T00:00:00+00:00'
      responses:
        102:
          description: 'An identical request has been accepted for processing but the processing has not been completed yet.'
        202:
          description: 'A new Task has been generated to request the Customer''s bank account refresh. The generated `task_id` can be used to check the Task''s status.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/TaskCreatedResponseOB'
              example:
                operation_id: open_banking_refresh_post
                data:
                  task_id: 360e5821-4f18-4077-83f4-c9a7c1768bea
                metadata:
                  next_url: /v1/open-banking/refresh/360e5821-4f18-4077-83f4-c9a7c1768bea
                  next_url_delay: 50
        400:
          description: 'The request contains an invalid payload'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              examples:
                'Parameter missing':
                  value:
                    operation_id: open_banking_refresh_post
                    code_id: failed_validation
                    message: 'Failed validation'
                    errors:
                      customer_id: 'This value should not be blank'
                      customer_secret: 'This value should not be blank'
                'Provider in Maintenance':
                  value:
                    operation_id: open_banking_refresh_post
                    code_id: provider_maintenance
                    message: 'The provider is in maintenance.'
                    errors:
                      provider: 'The provider is currently disabled due to planned maintenance or known issues.'
        405:
          description: 'The request uses an unexpected HTTP method'
        5XX:
          description: 'An unexpected error occurred on the server side'
      callbacks:
        EventSubscriptionCallBack:
          '{$request.body#/redirect_url}':
            post:
              parameters:
                -
                  $ref: 'components.yaml#/parameters/SignatureHeaderParameter'
                -
                  $ref: 'components.yaml#/parameters/SigningIdHeaderParameter'
              summary: 'Aggregation Sync Notification Callback'
              requestBody:
                required: true
                description: 'This callback is sent to your configured Open Banking Sync Complete webhook URL on the completion of a relevant OB synchronisation task.'
                content:
                  application/json:
                    schema:
                      $ref: 'components.yaml#/schemas/OBSyncWebhookBody'
                    example:
                      data:
                        task_id: 03af1639-78a6-402d-809b-902a0b00a77d
                        status: Completed
                        task_type: refresh
                        customer_id: b6f898f8-99e8-4529-8e90-64d96fe05aa4
              responses:
                200:
                  description: 'Your server returns this code if it accepts the callback'
                300:
                  description: 'The notification will not be retried, redirects will not be followed'
                400:
                  description: 'The notification will not be retried'
                500:
                  description: |
                    The request will be retried shortly. If it fails multiple times, we will stop attempting to deliver the notification for this single event.
        RefreshCompletedCallBack:
          '{$request.body#/redirect_url}':
            description: |
              This callback is sent to your configured 'Open banking refresh completed' webhook URL on the completion of a connect task.
            post:
              parameters:
                -
                  $ref: 'components.yaml#/parameters/SignatureHeaderParameter'
                -
                  $ref: 'components.yaml#/parameters/SigningIdHeaderParameter'
              summary: 'Refresh Completed Notification Callback'
              requestBody:
                required: true
                description: 'This callback is sent to your configured ''Open banking refresh completed'' webhook URL on the completion of a refresh task.'
                content:
                  application/json:
                    schema:
                      $ref: 'components.yaml#/schemas/OBWebhookBody'
                    example:
                      data:
                        task_id: 03af1639-78a6-402d-809b-902a0b00a77d
                        status: Completed
                        result: success
                        task_type: refresh
                        customer_id: b6f898f8-99e8-4529-8e90-64d96fe05aa4
              responses:
                200:
                  description: 'Your server returns this code if it accepts the callback'
                300:
                  description: 'The notification will not be retried, redirects will not be followed'
                400:
                  description: 'The notification will not be retried'
                500:
                  description: |
                    The request will be retried shortly. If it fails multiple times, we will stop attempting to deliver the notification for this single event. 
  '/v1/open-banking/refresh/{task_id}':
    get:
      tags:
        - 'Manage a Connection'
      summary: 'Retrieve Refresh Status'
      description: |
        Check the status of an account information refresh task e.g. progress on account information download. If the task is not yet completed, the status will be shown as pending. If the status is completed, then the data is ready to be collected via the [Retrieve OB Data](#tag/Retrieve-OB-Data) endpoints.
      operationId: open_banking_refresh_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/TaskId'
      responses:
        200:
          description: 'The request was successfully processed.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/OpenBankingRefreshResponse'
              examples:
                completed:
                  summary: Completed
                  value:
                    operation_id: open_banking_refresh_get
                    data:
                      provider: Barclays
                      status: Complete
                      result: success
                      reconnect_required: false
                      step: 4
                      text: Completed
                    metadata:
                      has_new_transactions: true
                      status: Complete
                pending:
                  summary: Pending
                  value:
                    operation_id: open_banking_refresh_get
                    data:
                      provider: Barclays
                      status: Pending
                      reconnect_required: false
                      step: 1
                      text: 'Fetching access token'
                    metadata:
                      status: Pending
                      next_url: /v1/open-banking/refresh/360e5821-4f18-4077-83f4-c9a7c1768bea
                      next_url_delay: 50
                failed_provider_failure:
                  summary: 'Provider Failure'
                  value:
                    operation_id: open_banking_refresh_get
                    data:
                      task_id: 1ceb1d81-a80e-4825-a7c0-4d69424c9874
                      provider: Barclays
                      status: Failed
                      result: provider_failure
                      reconnect_required: false
                      step: 2
                      text: 'Fetching accounts'
                    metadata:
                      status: Failed
                failed_connection_not_found:
                  summary: 'Connection not found'
                  value:
                    operation_id: open_banking_refresh_get
                    data:
                      task_id: 1ceb1d81-a80e-4825-a7c0-4d69424c9874
                      provider: Barclays
                      status: Failed
                      result: connection_not_found
                      reconnect_required: false
                      step: 4
                      text: Completed
                    metadata:
                      status: Failed
                failed_reconnect_required:
                  summary: 'Reconnection Required'
                  value:
                    operation_id: open_banking_refresh_get
                    data:
                      provider: Barclays
                      status: Failed
                      result: connection_revoked
                      reconnect_required: true
                      step: 4
                      text: Completed
                    metadata:
                      status: Failed
        400:
          description: 'The request contains an invalid payload'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: open_banking_refresh_get
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  customer_id: 'This value should not be blank'
        405:
          description: 'The request uses an unexpected HTTP method'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/open-banking/account-access-consents:
    get:
      tags:
        - 'Manage a Connection'
      summary: 'List Customer Consents'
      description: |
        Retrieve the list of all available Open Banking consents granted by the customer.
      operationId: open_banking_connections_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecretOptional'
        -
          $ref: 'components.yaml#/parameters/ConsentStatus'
      responses:
        200:
          description: 'The list of consents'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/GetOBConsentsResponse'
              example:
                operation_id: open_banking_connections_get
                data:
                  -
                    id: 1ceb1d81-a80e-4825-a7c0-4d69424c9874
                    customer_id: 8e826e72-5cab-4426-897f-5317992a95f0
                    provider: Natwest_Sandbox
                    transaction_from_date: '2020-03-23T14:46:32Z'
                    expiration_date: '2021-06-21T14:46:33Z'
                    created_at: '2021-03-23T14:46:33Z'
                    last_consented_on: '2021-03-23T14:47:01Z'
                    status: authorised
                    permissions:
                      - ReadAccounts
                      - ReadBalances
                      - ReadTransactions
                    raw_version: v1.1
                    raw_format: obie
                    raw:
                      ConsentId: 87ccf4c3-62b1-49c1-9a49-26919f954deb
                      TransactionFromDateTime: null
                      StatusUpdateDateTime: null
                      Status: AwaitingAuthorisation
                      Permissions:
                        - ReadAccountsDetail
                        - ReadBalances
                        - ReadTransactionsDetail
                        - ReadTransactionsDebits
                        - ReadTransactionsCredits
                    account_ids:
                      - aa86f72c-476a-3355-b54c-614a815fae40
                    last_synced_at: '2021-06-15T11:01:30.07Z'
                  -
                    id: a080272e-c449-4a75-861a-9feb53075946
                    customer_id: 8e826e72-5cab-4426-897f-5317992a95f0
                    provider: Amex
                    transaction_from_date: '2020-04-24T15:46:32Z'
                    transaction_to_date: '0001-01-01T00:00:00Z'
                    expiration_date: '2021-07-21T14:46:33Z'
                    created_at: '2021-04-24T15:42:13Z'
                    last_consented_on: '2021-04-24T15:42:13Z'
                    status: authorised
                    permissions:
                      - ReadAccounts
                      - ReadBalances
                      - ReadTransactions
                    raw_version: v1.1
                    raw_format: amex
                    raw: null
                    account_ids:
                      - bb98k51y-564t-8560-c99d-232b977gef68
                    last_synced_at: '2021-06-16T09:13:41.32Z'
                metadata:
                  results: 2
        400:
          description: 'Bad Request that fails validations on headers'
        401:
          description: 'Unauthorized (BearerToken in ''Authorization'' header fails the authentication)'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/open-banking/account-access-consent/revoke:
    post:
      tags:
        - 'Manage a Connection'
      summary: 'Initiate Revoke Consent'
      description: |
        Start a task to remove consent to download further customer account information and remove Bud’s ability to download further information for a specified customer account.
      operationId: open_banking_account_access_consent_revoke_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/RevokeAccountAccessIntentRequest'
            example:
              provider: Barclays
      responses:
        202:
          description: 'The request has been accepted for processing'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/TaskCreatedResponse'
              example:
                operation_id: open_banking_account_access_consent_revoke_post
                data:
                  task_id: 1ceb1d81-a80e-4825-a7c0-4d69424c9874
        400:
          description: 'Bad Request that fails validations on headers & payload'
        401:
          description: 'Unauthorized (BearerToken in ''Authorization'' header fails the authentication)'
        5XX:
          description: 'An unexpected error occurred on the server side'
  '/v1/open-banking/account-access-consent/revoke/{task_id}':
    get:
      tags:
        - 'Manage a Connection'
      summary: 'Retrieve Revoke Consent Status'
      description: |
        Check the status and result of a Revoke Consent task.
      operationId: open_banking_account_access_consent_revoke_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/TaskId'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/RevokeAccountAccessIntentTastStatusResponse'
              examples:
                completed:
                  summary: Completed
                  value:
                    operation_id: open_banking_account_access_consent_revoke_get
                    metadata:
                      status: Completed
                pending:
                  summary: Pending
                  value:
                    operation_id: open_banking_account_access_consent_revoke_get
                    metadata:
                      status: Pending
                failed:
                  summary: Failed
                  value:
                    operation_id: open_banking_account_access_consent_revoke_get
                    metadata:
                      status: Failed
                      error_code: 1
                      error_message: 'Error message'
        400:
          description: 'Bad Request that fails validations on headers & payload'
        401:
          description: 'Unauthorized (BearerToken in ''Authorization'' header fails the authentication)'
        5XX:
          description: 'An unexpected error occurred on the server side'
  '/v1/open-banking/account-access-consents/{consent_id}/reconfirm':
    post:
      tags:
        - 'Manage a Connection'
      summary: 'Reconfirm Consent'
      description: |
        Reconfirm a customer's consent to extend the expiration date by 90 days. If the provider requires SCA authentication or the consent status is not showing "Authorised" or the consent is expired, the `reconnect_required` flag will show as true. If false, the consent has been extended.
      operationId: open_banking_consents_reconfirm_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/ConsentId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/ReconfirmConsentRequest'
            example:
              provider: Barclays
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/ReconfirmConsentResponse'
              example:
                operation_id: open_banking_consents_reconfirm_post
                data:
                  provider_id: Barclays
                  reconnect_required: false
        400:
          description: 'Bad Request that fails validations on headers & payload'
        401:
          description: 'Unauthorized (BearerToken in ''Authorization'' header fails the authentication)'
        404:
          description: 'Consent not found'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/ingest/accounts:
    post:
      tags:
        - 'Ingest First Party Data'
      summary: 'Ingest Accounts'
      description: |
        Initiate the asynchronous process of pushing a customer's account(s) and balance(s) through the Bud architecture.

        This request creates a task that stores the given accounts and balances against the specified customers.

        The Task ID returned by this request can be used to verify the current status of the process.
      operationId: ingest_accounts_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/IngestAccountsContentType'
      requestBody:
        required: true
        content:
          application/bud-accounts+json:
            schema:
              $ref: 'components.yaml#/schemas/IngestAccountsRequest'
            example:
              -
                customer_id: c3339af9-2426-44d4-9c4d-ddb8fd281e23
                customer_secret: 95793c357ce9f3738f302db9579e453d03ce44eba814512d0c8038f7c376f586
                accounts:
                  -
                    provider: Barclays
                    account_id: 99473c28-21cf-4a9a-b79e-fd643dd7a4bc
                    currency: GBP
                    account_type: Personal
                    account_sub_type: CurrentAccount
                    details:
                      -
                        scheme_name: UK.OBIE.SortCodeAccountNumber
                        identification: '98765432165444'
                        secondary_identification: '00021'
                        name: 'Mr Kevin'
                    balances:
                      -
                        amount:
                          value: '7.00'
                          currency: GBP
                        credit_debit_indicator: outgoing_debit
                        credit_line:
                          -
                            included: true
                            amount:
                              value: '200.00'
                              currency: GBP
                            type: Credit
                        date: '2020-12-01'
                        time: '00:00:00'
                        type: InterimBooked
              -
                customer_id: 85db4cdf-5f79-4f4e-8388-f9a52da598a2
                customer_secret: 6075654df0e057e97535ab31b80561d7d9e8409606738c2633cdd6dab63e089a
                accounts:
                  -
                    provider: Lloyds
                    account_id: bfd4ea71-58d7-4b24-8820-95029875cc9a
                    currency: GBP
                    account_type: Personal
                    account_sub_type: CurrentAccount
                    details:
                      -
                        scheme_name: UK.OBIE.SortCodeAccountNumber
                        identification: '12312312313200'
                        secondary_identification: '00022'
                        name: 'Mr Kevin'
                    balances:
                      -
                        amount:
                          value: '70005.00'
                          currency: GBP
                        credit_debit_indicator: incoming_credit
                        credit_line:
                          -
                            included: true
                            amount:
                              value: '100.00'
                              currency: GBP
                            type: Credit
                        date: '2020-12-01'
                        time: '00:00:00'
                        type: InterimBooked
      responses:
        202:
          description: 'A new Task has been created to ingest the given accounts. The generated `task_id` can be used to check the Task''s status'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/IngestTransactionsResponse'
              example:
                operation_id: ingest_accounts_post
                data:
                  task_id: 4cef424c-1d7f-4cab-8be2-aee7e1774a00
                metadata:
                  next_url: /v1/ingest/accounts/4cef424c-1d7f-4cab-8be2-aee7e1774a00
                  next_url_delay: 50
        400:
          description: 'Bad Request that fails validations on headers & payload'
        401:
          description: 'Unauthorized (BearerToken in ''Authorization'' header fails the authentication)'
        5XX:
          description: 'An unexpected error occurred on the server side'
  '/v1/ingest/accounts/{task_id}':
    get:
      tags:
        - 'Ingest First Party Data'
      summary: 'Retrieve Accounts Ingestion Task Status'
      description: |
        Check the status of an ingest accounts request.

        The given status has an overall value and a specific status for each given customer.
      operationId: ingest_accounts_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/TaskId'
      responses:
        200:
          description: 'The request was successfully processed.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/IngestStatusResponse'
              examples:
                Success:
                  value:
                    summary: 'Successfully completed'
                    operation_id: ingest_accounts_get
                    data:
                      id: 4cef424c-1d7f-4cab-8be2-aee7e1774a00
                      status: Completed
                      sub_tasks:
                        -
                          id: e6277c5a-c73d-47f5-847f-36bff8618691
                          customer_id: c3339af9-2426-44d4-9c4d-ddb8fd281e23
                          status: Completed
                          errors: null
                        -
                          id: 661d6ec2-1b08-4f30-9ede-d4d18db26b09
                          customer_id: 85db4cdf-5f79-4f4e-8388-f9a52da598a2
                          status: Completed
                          errors: null
                'Validation Failure':
                  value:
                    summary: 'Validation error'
                    operation_id: ingest_accounts_get
                    data:
                      id: 4cef424c-1d7f-4cab-8be2-aee7e1774a00
                      status: Failed
                      sub_tasks:
                        -
                          id: e6277c5a-c73d-47f5-847f-36bff8618691
                          customer_id: c3339af9-2426-44d4-9c4d-ddb8fd281e23
                          status: Failed
                          errors:
                            accounts.0.account_id: 'account_id is required'
                            accounts.1.provider: 'provider is required'
                        -
                          id: 661d6ec2-1b08-4f30-9ede-d4d18db26b09
                          customer_id: 85db4cdf-5f79-4f4e-8388-f9a52da598a2
                          status: Failed
                          errors:
                            accounts.1.provider: 'provider is required'
                'Transient Failure':
                  value:
                    operation_id: ingest_accounts_get
                    data:
                      id: 4cef424c-1d7f-4cab-8be2-aee7e1774a00
                      status: Failed
                      sub_tasks:
                        -
                          id: e6277c5a-c73d-47f5-847f-36bff8618691
                          customer_id: c3339af9-2426-44d4-9c4d-ddb8fd281e23
                          status: Failed
                          errors:
                            error: 'unable to persist accounts'
        405:
          description: 'The request uses an unexpected HTTP method'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/ingest/transactions:
    post:
      tags:
        - 'Ingest First Party Data'
      summary: 'Ingest Transactions'
      description: |
        Initiate the asynchronous process of pushing a customer's transaction(s) through the Bud architecture to apply Bud's enrichment and insights services to first party transactional data. This request creates a task that stores the given transactions against the specified customers and initiates the relevant enrichment process.

        The enrichment services applied to the data will depend upon the relevant scopes assigned to your Client ID.

        The Task ID returned by this request can be used to verify the current status of the process.
      operationId: ingest_transactions_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/IngestTransactionsContentType'
      requestBody:
        required: true
        content:
          application/bud-transaction-v2+json:
            schema:
              $ref: 'components.yaml#/schemas/IngestTransactionsRequest'
      responses:
        202:
          description: 'A new Task has been created to ingest the given transactions. The generated `task_id` can be used to check the Task''s status'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/IngestTransactionsResponse'
              example:
                operation_id: ingest_transactions_post
                data:
                  task_id: 4cef424c-1d7f-4cab-8be2-aee7e1774a00
                metadata:
                  next_url: /v1/ingest/transactions/4cef424c-1d7f-4cab-8be2-aee7e1774a00
                  next_url_delay: 50
        400:
          description: 'Bad Request that fails validations on headers & payload'
        401:
          description: 'Unauthorized (BearerToken in ''Authorization'' header fails the authentication)'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v2/ingest/transactions:
    post:
      tags:
        - 'Ingest First Party Data'
      summary: 'Ingest Transactions V2'
      description: |
        This endpoint initiates a 'blocking' transaction ingestion and enrichment process. It will return partially enriched transactions and a Task ID which would then be used for finding out the current status of the full enrichment process. The complete enrichment services applied to the data will depend upon the relevant scopes assigned to your Client ID.

        If a 'X-Disable-Synchronous' header is present and set to true, the process will be entirely 'non-blocking', with the returned Task ID providing access to the status of the full enrichment process.
      operationId: v2_ingest_transactions_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/IngestTransactionsV2ContentType'
        -
          $ref: 'components.yaml#/parameters/DisableSynchronous'
      requestBody:
        required: true
        content:
          application/bud-transaction-v3+json:
            schema:
              $ref: 'components.yaml#/schemas/IngestTransactionsV3Request'
      responses:
        200:
          description: |
            The synchronous enrichment request has succeeded and enriched transaction returned. 

            A new Task has been created to ingest and fully enrich the given transactions. 

            The generated `task_id` can be used to check the Task's status.
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/IngestV2SyncResponse'
              example:
                operation_id: v2_ingest_transactions_post
                data:
                  -
                    customer_id: 4cef424c-1d7f-4cab-8be2-aee7e1774a00
                    enriched_transactions:
                      -
                        transaction_id: another_transaction_id
                        account_id: another_account_id
                        description: 'paypal* specialty coffee london GBR'
                        credit_debit_indicator: debit
                        status: booked
                        amount:
                          value: '10.99'
                          currency: GBP
                        date_time: '2022-05-28T10:00:00Z00:00'
                        enrichments:
                          categories:
                            l1:
                              slug: eating_out
                              confidence: '0.99'
                            l2:
                              slug: cafes_and_eating_out
                              confidence: '0.98'
                          merchant:
                            id: 01cc2d49-6144-46f1-9414-67c99b139a95
                            slug: specialty_coffee
                            display_name: 'Specialty Coffee Supplier Ltd.'
                            logo: 'http://url/specialty_coffee_supplier_logo.jpeg'
                          processor:
                            id: 18f63293-0217-4520-bbf0-071dca7a9d04
                            slug: paypal
                            display_name: PayPal
                            logo: 'http://url/paypal_logo.jpeg'
                          names:
                            - 'jane doe'
                metadata:
                  task_id: 4cef424c-1d7f-4cab-8be2-aee7e1774a00
                  next_url: /v1/ingest/transactions/4cef424c-1d7f-4cab-8be2-aee7e1774a00
                  next_url_delay: 50
        202:
          description: 'A new Task has been created to ingest the given transactions. The generated `task_id` can be used to check the Task''s status'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/IngestV2AsyncResponse'
              example:
                operation_id: v2_ingest_transactions_post
                metadata:
                  task_id: 4cef424c-1d7f-4cab-8be2-aee7e1774a00
                  next_url: /v1/ingest/transactions/4cef424c-1d7f-4cab-8be2-aee7e1774a00
                  next_url_delay: 50
        400:
          description: 'The server will not process the request due to a client error.'
          content:
            application/json:
              schema:
                oneOf:
                  -
                    $ref: 'components.yaml#/schemas/BodyDecodeError'
                  -
                    $ref: 'components.yaml#/schemas/ValidationError'
        401:
          description: 'Unauthorized (BearerToken in ''Authorization'' header fails the authentication)'
        5XX:
          description: 'An unexpected error occurred on the server side'
        503:
          description: 'An unexpected error occurred on the enrichment server. Sync Only'
        504:
          description: 'An unexpected timeout occurred on the enrichment server. Sync Only'
  '/v1/ingest/transactions/{task_id}':
    get:
      tags:
        - 'Ingest First Party Data'
      summary: 'Retrieve Transaction Ingestion Task Status'
      description: |
        Check the status of an ingest transactions request. Please note that this works for both the Ingest Transactions V1 and V2 endpoints.

        The given status has an overall value and a specific status for each given customer.
      operationId: ingest_transactions_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/TaskId'
      responses:
        200:
          description: 'The request was successfully processed.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/IngestStatusResponse'
              examples:
                Success:
                  value:
                    operation_id: ingest_transactions_get
                    data:
                      id: 4cef424c-1d7f-4cab-8be2-aee7e1774a00
                      status: Completed
                      sub_tasks:
                        -
                          id: e6277c5a-c73d-47f5-847f-36bff8618691
                          customer_id: c3339af9-2426-44d4-9c4d-ddb8fd281e23
                          status: Completed
                          errors: null
                        -
                          id: 661d6ec2-1b08-4f30-9ede-d4d18db26b09
                          customer_id: 85db4cdf-5f79-4f4e-8388-f9a52da598a2
                          status: Completed
                          errors: null
                'Validation Failure':
                  value:
                    operation_id: ingest_transactions_get
                    data:
                      id: 4cef424c-1d7f-4cab-8be2-aee7e1774a00
                      status: Failed
                      sub_tasks:
                        -
                          id: e6277c5a-c73d-47f5-847f-36bff8618691
                          customer_id: c3339af9-2426-44d4-9c4d-ddb8fd281e23
                          status: Failed
                          errors:
                            transactions.0.provider: 'provider is required'
                            transactions.0.account_id: 'account_id is required'
                            transactions.1.provider: 'provider is required'
                            transactions.2.transaction_id: 'transaction_id is required'
                        -
                          id: 661d6ec2-1b08-4f30-9ede-d4d18db26b09
                          customer_id: 85db4cdf-5f79-4f4e-8388-f9a52da598a2
                          status: Failed
                          errors:
                            transactions.1.provider: 'provider is required'
                'Transient Failure':
                  value:
                    operation_id: ingest_transactions_get
                    data:
                      id: 4cef424c-1d7f-4cab-8be2-aee7e1774a00
                      status: Failed
                      sub_tasks:
                        -
                          id: e6277c5a-c73d-47f5-847f-36bff8618691
                          customer_id: c3339af9-2426-44d4-9c4d-ddb8fd281e23
                          status: Failed
                          errors:
                            error: 'unable to persist transactions'
        400:
          description: 'The server will not process the request due to a client error.'
          content:
            application/json:
              schema:
                oneOf:
                  -
                    $ref: 'components.yaml#/schemas/FailedValidationError'
                  -
                    $ref: 'components.yaml#/schemas/TaskNotFoundError'
        405:
          description: 'The request uses an unexpected HTTP method'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/customers:
    post:
      security:
        -
          OAuth2: []
      tags:
        - 'Manage Customers'
      summary: 'Create Customer'
      deprecated: true
      description: |
        This endpoint is used to create a new Customer in order for them to consume the Bud services.

        **Please note: this endpoint is now deprecated, please migrate to using the POST /v2/customers endpoint.**
      operationId: customers_create
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
      requestBody:
        required: false
        content:
          application/json:
            schema:
              properties:
                customer_context:
                  $ref: 'components.yaml#/schemas/CustomerContext'
            example:
              customer_context:
                type: personal
                region: GB
                locale: en-GB
      responses:
        201:
          description: 'The resource has been successfully created.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/CustomerCreateResponse'
              example:
                operation_id: customers_create
                data:
                  customer_id: 360e5821-4f18-4077-83f4-c9a7c1768bea
                  customer_secret: 63ae14a67e5cf8c8f7bf5376479d13e9
                  customer_context:
                    type: personal
                    region: GB
                    locale: en-GB
        400:
          description: 'The request contains an invalid payload.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: customers_create
                code_id: failed_validation
                message: 'Failed validation.'
                errors:
                  client_id: 'This value should not be blank'
        401:
          description: 'An unauthenticated request was received.'
        405:
          description: 'The request uses an unexpected HTTP method.'
        5XX:
          description: 'An unexpected error occurred on the server side.'
  /v2/customers:
    post:
      security:
        -
          OAuth2: []
      tags:
        - 'Manage Customers'
      summary: 'Create Customer(s)'
      description: 'This endpoint is used to create new Customers in order for them to consume the Bud services.'
      operationId: v2_customers_post
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/CreateCustomersPayload'
            example:
              number_of_customers: 3
              customer_context:
                type: personal
                region: GB
                locale: en-GB
      responses:
        201:
          description: 'The resource has been successfully created.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/CustomersCreateResponse'
              examples:
                'Multiple Customers':
                  value:
                    operation_id: v2_customers_post
                    data:
                      -
                        customer_id: 360e5821-4f18-4077-83f4-c9a7c1768bea
                        customer_secret: 63ae14a67e5cf8c8f7bf5376479d13e9
                        customer_context:
                          type: personal
                          region: GB
                          locale: en-GB
                      -
                        customer_id: 7788d43e-4eb1-11eb-ae93-0242ac130002
                        customer_secret: 63ae14a67e5cf8c8f7bf5376479d13e5
                        customer_context:
                          type: personal
                          region: GB
                          locale: en-GB
                      -
                        customer_id: 8e4b6f88-4eb1-11eb-ae93-0242ac130002
                        customer_secret: a951d12bf19e2874254cb2833dc5a8c3
                        customer_context:
                          type: personal
                          region: GB
                          locale: en-GB
                    metadata:
                      results: 3
                'Single Customer':
                  value:
                    operation_id: v2_customers_post
                    data:
                      -
                        customer_id: 360e5821-4f18-4077-83f4-c9a7c1768bea
                        customer_secret: 63ae14a67e5cf8c8f7bf5376479d13e9
                        customer_context:
                          type: personal
                          region: GB
                          locale: en-GB
                    metadata:
                      results: 1
        400:
          description: 'The request contains an invalid payload.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v2_customers_post
                code_id: failed_validation
                message: 'Failed validation.'
                errors:
                  client_id: 'This value should not be blank'
        401:
          description: 'An unauthenticated request was received.'
        405:
          description: 'The request uses an unexpected HTTP method.'
        5XX:
          description: 'An unexpected error occurred on the server side.'
  '/v1/customers/{customer_id}':
    delete:
      security:
        -
          OAuth2: []
      tags:
        - 'Manage Customers'
      summary: 'Remove Customer'
      description: 'This endpoint is used to delete an existing Customer.'
      operationId: customers_delete
      parameters:
        -
          in: path
          name: customer_id
          schema:
            type: string
          required: true
          description: 'The resource identifier.'
        -
          $ref: 'components.yaml#/parameters/ClientId'
      responses:
        204:
          description: 'The request was successfully processed and no content is returned.'
        401:
          description: 'An unauthenticated request was received.'
        404:
          description: 'The resource was not found.'
        405:
          description: 'The request uses an unexpected HTTP method.'
        5XX:
          description: 'An unexpected error occurred on the server side.'
  '/v1/customers/{customer_id}/context':
    get:
      security:
        -
          OAuth2: []
      tags:
        - 'Manage Customers'
      summary: 'Retrieve Customer Context'
      description: 'Retrieve the customer level customer context, i.e. a set of parameters that defines their language, region and their customer type.'
      operationId: v1_customer_context_get
      parameters:
        -
          in: path
          name: customer_id
          schema:
            type: string
          required: true
          description: 'The resource identifier.'
        -
          $ref: 'components.yaml#/parameters/ClientId'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/CustomerContextResponse'
              example:
                operation_id: v1_customer_context_get
                data:
                  type: personal
                  region: GB
                  locale: en-GB
        401:
          description: 'An unauthenticated request was received.'
        404:
          description: 'The resource was not found.'
        405:
          description: 'The request uses an unexpected HTTP method.'
        5XX:
          description: 'An unexpected error occurred on the server side.'
    put:
      security:
        -
          OAuth2: []
      tags:
        - 'Manage Customers'
      summary: 'Update Customer Context'
      description: 'Set the customer level customer context.'
      operationId: v1_customer_context_put
      parameters:
        -
          in: path
          name: customer_id
          schema:
            type: string
          required: true
          description: 'The resource identifier.'
        -
          $ref: 'components.yaml#/parameters/ClientId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/UpdateCustomerContextRequest'
            example:
              region: GB
              locale: en-GB
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/UpdateCustomerContextResponse'
              example:
                operation_id: v1_customer_context_put
                data:
                  region: GB
                  locale: en-GB
        401:
          description: 'An unauthenticated request was received.'
        404:
          description: 'The resource was not found.'
        405:
          description: 'The request uses an unexpected HTTP method.'
        5XX:
          description: 'An unexpected error occurred on the server side.'
  /v1/categories/double-cat:
    get:
      tags:
        - 'Enrichment Resources'
      summary: 'List Categories'
      description: |
        Retrieve a list of primary and secondary categories supported by Bud's current categorisation engine.
      operationId: categories_double_cat_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
      responses:
        200:
          description: 'List of available categories.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/DoubleCatCategoriesResponse'
              example:
                operation_id: categories_double_cat_get
                data:
                  categories:
                    - bills
                    - eating_out
                    - entertainment
                    - expenses
                    - finances
                    - general
                    - groceries
                    - personal_care
                    - services
                    - shopping
                    - transport
                    - travel
                  subcategories:
                    - accommodation
                    - activities
                    - bars_and_pubs
                    - beauty
                    - benefits
                    - boat
                    - books_and_reading
                    - bus
                    - business_expenses
                    - cafes_and_lunch
                    - car_payments
                    - car_sharing
                    - care_provision
                    - cash_withdrawals
                    - charity
                    - childcare
                    - children_and_babies
                    - cinema
                    - cleaning
                    - clothing
                    - convenience_stores
                    - credit_cards
                    - cycling
                    - department_stores
                    - education_and_school_fees
                    - electronics
                    - events
                    - fast_food
                    - flights
                    - furniture_and_appliances
                    - gambling_and_betting
                    - gaming
                    - gardening
                    - general_banking
                    - gym_and_fitness
                    - hardware_and_diy
                    - healthcare
                    - home_improvements
                    - income
                    - insurance
                    - interest_payments
                    - investments
                    - laundry
                    - loans
                    - mobile_phone
                    - mortgage_and_rent
                    - museums_and_art_galleries
                    - music
                    - online_shopping
                    - other_bills
                    - other_eating_out
                    - other_entertainment
                    - other_expenses
                    - other_finances
                    - other_general
                    - other_groceries
                    - other_personal_care
                    - other_services
                    - other_shopping
                    - other_transport
                    - other_travel
                    - package_holidays
                    - parking_and_tolls
                    - pensions
                    - petrol
                    - pets
                    - pharmacies_and_health_products
                    - postage_and_shipping
                    - public_transport
                    - refunds
                    - repairs
                    - restaurants
                    - savings
                    - service_stations
                    - software_and_apps
                    - speciality_food_and_drink_shops
                    - sports
                    - subscriptions
                    - supermarkets
                    - takeaway
                    - taxes
                    - taxi
                    - train
                    - transfers_in
                    - transfers_out
                    - travel_purchases
                    - tv_broadband_and_phone
                    - utilities
                    - vehicle
                    - vehicle_hire
        400:
          description: 'The request contains an invalid payload'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: categories_double_cat_get
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  client_id: 'This value should not be blank'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/categories/totals:
    get:
      tags:
        - 'Enrichment Totals'
      summary: 'Retrieve Category Totals'
      description: |
        Provides a customer’s total income and expenditure for each primary and secondary category, over a given time period.

        The header parameters X-From and X-To allow you to filter the result to a specified datetime range.
      operationId: v1_categories_totals_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/HeaderFrom'
        -
          $ref: 'components.yaml#/parameters/HeaderTo'
      responses:
        200:
          description: 'The operation was successful'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/CategoriesTotalResponse'
              example:
                operation_id: v1_categories_totals_get
                data:
                  categories:
                    -
                      category:
                        id: shopping
                        label: Shopping
                      credit_amount:
                        -
                          value: '15.90'
                          currency: GBP
                      debit_amount:
                        -
                          value: '397.80'
                          currency: GBP
                  sub_categories:
                    -
                      category:
                        id: gaming
                        label: Gaming
                      credit_amount:
                        -
                          value: '9.99'
                          currency: GBP
                      debit_amount:
                        -
                          value: '0.00'
                          currency: GBP
        400:
          description: 'The request contains an invalid payload'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_categories_totals_get
                code_id: failed_validation
                message: 'Failed validation.'
                errors:
                  client_id: 'This value should not be blank'
        401:
          description: 'An unauthenticated request was received'
        405:
          description: 'The request uses an unexpected HTTP method'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/merchants/totals:
    get:
      tags:
        - 'Enrichment Totals'
      summary: 'Retrieve Merchant Totals V1'
      deprecated: true
      description: |
        Provides a customer’s total income and expenditure for each merchant.
      operationId: merchants_totals_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/From'
        -
          $ref: 'components.yaml#/parameters/To'
      responses:
        200:
          description: 'The request was successfully processed'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/MerchantTotalsResponse'
              example:
                operation_id: merchants_totals_get
                data:
                  total_outgoing:
                    amount: '5838.11'
                    currency: GBP
                  total_incoming:
                    amount: '15001.00'
                    currency: GBP
                  unknown_spend:
                    amount: '5782.48'
                    currency: GBP
                    transactions: 11
                  merchant_spend:
                    argos:
                      amount: '10.45'
                      currency: GBP
                      transactions: 1
                    tesco:
                      amount: '10.45'
                      currency: GBP
                      transactions: 1
                    uber:
                      amount: '34.73'
                      currency: GBP
                      transactions: 2
                metadata:
                  from: '2018-01-01'
                  to: '2018-01-17'
                  transaction_count: 3
        204:
          description: 'No transactions found'
        400:
          description: 'The request contains an invalid payload'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: merchants_totals_get
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  client_id: 'This value should not be blank'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v2/merchants/totals:
    get:
      tags:
        - 'Enrichment Totals'
      summary: 'Retrieve Merchant Totals V2'
      description: |
        Provides a customer’s total debit and credit amounts for each merchant.
      operationId: v2_merchants_totals_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/From'
        -
          $ref: 'components.yaml#/parameters/To'
        -
          $ref: 'components.yaml#/parameters/MerchantsTotalsIncludeCategories'
        -
          $ref: 'components.yaml#/parameters/MerchantsTotalsExcludeCategories'
      responses:
        200:
          description: 'The request was successfully processed'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/MerchantTotalsResponseV2'
              example:
                operation_id: v2_merchants_totals_get
                data:
                  -
                    merchant:
                      id: tesco
                      logo: 'https://thisisbud.com/merchants/tesco.png'
                      name: Tesco
                    total_debit:
                      value: '130.23'
                      currency: GBP
                    total_credit:
                      value: '12.21'
                      currency: GBP
                    transaction_count: 8
                  -
                    merchant:
                      id: waitrose
                      logo: 'https://thisisbud.com/merchants/waitrose.png'
                      name: Waitrose
                    total_debit:
                      value: '240.23'
                      currency: GBP
                    total_credit:
                      value: '6.56'
                      currency: GBP
                    transaction_count: 10
                metadata:
                  from: '2018-01-01'
                  to: '2018-01-17'
                  results: 2
        204:
          description: 'No transactions found'
        400:
          description: 'The request contains an invalid payload'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v2_merchants_totals_get
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  client_id: 'This value should not be blank'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/benefits/totals:
    get:
      tags:
        - 'Enrichment Totals'
      summary: 'Retrieve Benefits Totals'
      description: |
        Provides a customers' total income under each detected benefit type
      operationId: v1_benefits_totals_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/From'
        -
          $ref: 'components.yaml#/parameters/To'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BenefitsTotalsResponseV1'
              example:
                operation_id: v1_benefits_totals_get
                data:
                  -
                    benefit:
                      type: disability_living_allowance
                      display_name: 'Disability Living Allowance'
                    total_credit:
                      value: '333.28'
                      currency: GBP
                metadata:
                  from: '2022-03-19'
                  to: '2022-04-19'
                  results: 1
        204:
          description: 'No transactions found'
        400:
          description: 'The request contains an invalid payload'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: merchants_totals_get
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  client_id: 'This value should not be blank'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/open-banking/accounts:
    get:
      tags:
        - 'Fetch Financial Data'
      summary: 'List Accounts'
      description: |
        List a customer’s current, credit card and savings accounts held on the Bud platform along with each account’s balance. 

        An X-Account-Id header parameter can be used in order to get the details for a specific account.
      operationId: accounts_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/OBAccountId'
      responses:
        200:
          description: 'The request was successfully processed.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/OBListAccountsResponse'
              examples:
                'All accounts':
                  value:
                    operation_id: accounts_get
                    data:
                      -
                        account_id: 3fa85f64-5717-4562-b3fc-2c963f66afa6
                        currency: GBP
                        account_type: Personal
                        account_sub_type: Savings
                        nickname: 'Holiday Funds'
                        details:
                          -
                            scheme_name: UK.OBIE.SortCodeAccountNumber
                            identification: '80200110203345'
                            name: 'Mr Kevin'
                            secondary_identification: '00021'
                        provider: HSBC
                        balances:
                          -
                            account_id: aa86f72c-476a-3355-b54c-614a815fae40
                            amount:
                              amount: '357.90'
                              currency: GBP
                            credit_debit_indicator: Credit
                            credit_line:
                              -
                                included: true
                                amount:
                                  amount: '272.90'
                                  currency: GBP
                                type: Temporary
                            date_time: '2019-02-27T06:11:57+0000'
                            type: InterimBooked
                        parties:
                          -
                            full_name: 'Jane Doe'
                            type: sole
                      -
                        account_id: 423fdf64-5317-4562-b3fc-268abd8e9ff9
                        currency: GBP
                        account_type: Personal
                        account_sub_type: CurrentAccount
                        nickname: 'Current Account'
                        details:
                          -
                            scheme_name: UK.OBIE.SortCodeAccountNumber
                            identification: '80200110203346'
                            name: 'Mr Kevin'
                            secondary_identification: '00022'
                        provider: Lloyds
                        balances:
                          -
                            account_id: aa86f72c-476a-3355-b54c-614a815fae40
                            amount:
                              amount: '357.90'
                              currency: GBP
                            credit_debit_indicator: Credit
                            credit_line:
                              -
                                included: true
                                amount:
                                  amount: '272.90'
                                  currency: GBP
                                type: Temporary
                            date_time: '2019-02-27T06:11:57+0000'
                            type: InterimBooked
                        parties:
                          -
                            full_name: 'Jane Doe'
                            type: joint
                    metadata:
                      results: 2
                'Specific Account':
                  value:
                    operation_id: accounts_get
                    data:
                      account_id: 3fa85f64-5717-4562-b3fc-2c963f66afa6
                      currency: GBP
                      account_type: Personal
                      account_sub_type: SavingsAccount
                      nickname: 'Holiday Funds'
                      details:
                        -
                          scheme_name: UK.OBIE.SortCodeAccountNumber
                          identification: '80200110203345'
                          name: 'Mr Kevin'
                          secondary_identification: '00021'
                      provider: Lloyds
                      balances:
                        -
                          account_id: aa86f72c-476a-3355-b54c-614a815fae40
                          amount:
                            amount: '357.90'
                            currency: GBP
                          credit_debit_indicator: Credit
                          credit_line:
                            -
                              included: true
                              amount:
                                amount: '272.90'
                                currency: GBP
                              type: Temporary
                          date_time: '2019-02-27T06:11:57+0000'
                          type: InterimBooked
                      parties:
                        -
                          full_name: 'Mr Kevin'
                          type: sole
                    metadata:
                      results: 1
        401:
          description: 'An unauthenticated request was received.'
        405:
          description: 'The request uses an unexpected HTTP method.'
        5XX:
          description: 'An unexpected error occurred on the server side.'
  /v1/open-banking/transactions:
    get:
      tags:
        - 'Fetch Financial Data'
      summary: 'List Transactions'
      deprecated: true
      description: |
        List the transactions for each of the customer’s accounts held on the Bud platform.

        By default this endpoint will return the last 3 months of transactions unless a valid `from` and `to` range is given (*where `from` is older than `to`).

        **Please note: support will cease for this endpoint on the 1st of August 2023 - please complete your migration to the List Transactions V2 endpoint by that point in time. For further details, contact your Bud account manager or email `help@thisisbud.com`.**
      operationId: transactions_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/HeaderFrom'
        -
          $ref: 'components.yaml#/parameters/HeaderTo'
        -
          $ref: 'components.yaml#/parameters/OBAccountId'
      responses:
        200:
          description: 'The request was successfully processed.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/OBListTransactionsResponse'
              examples:
                'All Account Transactions':
                  value:
                    operation_id: transactions_get
                    data:
                      -
                        id: 980ef9ba0211a05ee3ca92ed2c38b77ec8a49d5cb5c7d72e3dcdb9981000000-1
                        provider: Lloyds
                        raw_transaction:
                          account_id: '100000'
                          transaction_id: '100001'
                          transaction_reference: 'Ref 100001'
                          amount:
                            amount: '10.00'
                            currency: GBP
                          credit_debit_indicator: Credit
                          status: Booked
                          booking_date_time: '2019-05-07T00:00:00+0000'
                          value_date_time: '2019-06-15T00:00:00+0000'
                          address_line: London
                          transaction_information: '6278 16Mar19 CD HONEST BURGERS LONDON GB'
                          bank_transaction_code:
                            code: ReceivedCreditTransfer
                            sub_code: DomesticCreditTransfer
                          proprietary_bank_transaction_code:
                            code: Transfer
                            issuer: AlphaBank
                          balance:
                            amount:
                              amount: '230.00'
                              currency: GBP
                            credit_debit_indicator: Credit
                            type: InterimBooked
                          merchant_details:
                            merchant_name: 'Eddie Ching'
                            merchant_category_code: MNC1
                          statement_reference:
                            - REF1
                          currency_exchange:
                            contract_identification: 'GBP to AUD'
                            exchange_rate: '1.83'
                            instructed_amount:
                              amount: '10.00'
                              currency: GBP
                            quotation_date: '2019-04-11T00:00:00+0000'
                            source_currency: GBP
                            target_currency: AUD
                            unit_currency: GBP
                          creditor_agent:
                            scheme_name: BICFI
                            identification: AlphaBank
                            name: 'AlphaBank business account'
                            postal_address:
                              address_type: Business
                              building_number: '1'
                              country: 'United Kingdom'
                              country_subdivision: England
                              department: admin
                              postcode: 'EC1V 9NR'
                              street_name: 'street name'
                              sub_department: reception
                              town_name: london
                              address_line:
                                - 'line 1'
                                - 'line 2'
                                - 'line 3'
                          creditor_account:
                            scheme_name: IBAN
                            identification: 'Bobs Bills'
                            name: Account1
                            secondary_identification: SecId
                          debtor_agent:
                            scheme_name: IBAN
                            identification: 'Bobs Bills'
                            name: 'Bobs bank account'
                            postal_address:
                              address_type: Business
                              building_number: '1'
                              country: 'United Kingdom'
                              country_subdivision: England
                              department: admin
                              postcode: 'EC1V 9NR'
                              street_name: 'street name'
                              sub_department: reception
                              town_name: london
                              address_line:
                                - 'line 1'
                                - 'line 2'
                                - 'line 3'
                          debtor_account:
                            scheme_name: BICFI
                            identification: AlphaBank
                            name: BB1
                            secondary_identification: 4435534GG
                          card_instrument:
                            card_scheme_name: AmericanExpress
                            card_authorisation_type: Contactless
                            cardholder_name: 'Mr Bob Smith'
                            identification: 'PAYMENT xxxxx'
                          charge_amount:
                            amount: '10.00'
                            currency: GBP
                          supplementary_data:
                            unknown_elements: true
                        enrichment:
                          categoriser:
                            categories:
                              -
                                category_name: groceries
                                confidence: '0.88'
                            subcategories:
                              -
                                subcategory_name: super_markets_and_grocery_stores
                                confidence: '0.93'
                          merchant:
                            id: honest_burgers
                            merchant_name: 'Honest Burgers'
                            merchant_logo: 'https://assets.example.com/image.jpg'
                            merchant_confidence: '1'
                          regular_payments:
                            label: '-1'
                            score: '0'
                            period: unknown
                          carbon_tracker:
                            co2_amount_kg: 7.02
                      -
                        id: 980ef9ba0211a05ee3ca92ed2c38b77ec8a49d5cb5c7d72e3dcdb9981a025e74-1
                        provider: Lloyds
                        raw_transaction:
                          account_id: '200000'
                          transaction_id: '200001'
                          transaction_reference: 'Ref 200001'
                          amount:
                            amount: '20.00'
                            currency: GBP
                          credit_debit_indicator: Credit
                          status: Booked
                          booking_date_time: '2019-04-12T00:00:00+0000'
                          value_date_time: '2019-04-15T00:00:00+0000'
                          address_line: Liverpool
                          transaction_information: '111 CLOSE GATE LANE'
                          bank_transaction_code:
                            code: ReceivedCreditTransfer
                            sub_code: DomesticCreditTransfer
                          proprietary_bank_transaction_code:
                            code: Transfer
                            issuer: BlinkBank
                          balance:
                            amount:
                              amount: '230.20'
                              currency: GBP
                            credit_debit_indicator: Credit
                            type: InterimBooked
                          merchant_details:
                            merchant_name: 'Rick Rock'
                            merchant_category_code: RR1
                          statement_reference:
                            - REF1
                            - REF2
                          currency_exchange:
                            contract_identification: 'GBP to AUD'
                            exchange_rate: '1.83'
                            instructed_amount:
                              amount: '11.00'
                              currency: GBP
                            quotation_date: '2019-05-04T00:00:00+0000'
                            source_currency: GBP
                            target_currency: AUD
                            unit_currency: GBP
                          creditor_agent:
                            scheme_name: BICFI
                            identification: BlinkBank
                            name: BlinkBank
                            postal_address:
                              address_type: Business
                              building_number: '1'
                              country: 'United Kingdom'
                              country_subdivision: England
                              department: admin
                              postcode: 'EC1V 9NR'
                              street_name: 'street name'
                              sub_department: reception
                              town_name: london
                              address_line:
                                - 'line 1'
                                - 'line 2'
                                - 'line 3'
                          creditor_account:
                            scheme_name: IBAN
                            identification: 'Roman Erik'
                            name: Account1
                            secondary_identification: null
                          debtor_agent:
                            scheme_name: IBAN
                            identification: 'Roman Erik'
                            name: 'Roman Erik'
                            postal_address:
                              address_type: Business
                              building_number: '1'
                              country: 'United Kingdom'
                              country_subdivision: England
                              department: admin
                              postcode: 'EC1V 9NR'
                              street_name: 'street name'
                              sub_department: reception
                              town_name: london
                              address_line:
                                - 'line 1'
                                - 'line 2'
                                - 'line 3'
                          debtor_account:
                            scheme_name: BICFI
                            identification: BlinkBank
                            name: BB1
                            secondary_identification: null
                          card_instrument:
                            card_scheme_name: Visa
                            card_authorisation_type: Contactless
                            cardholder_name: 'Elly Bon'
                            identification: ABC123
                          charge_amount:
                            amount: '2.00'
                            currency: GBP
                          supplementary_data:
                            unknown_elements: true
                        enrichment:
                          categoriser:
                            categories:
                              -
                                category_name: groceries
                                confidence: '0.88'
                            subcategories:
                              -
                                subcategory_name: super_markets_and_grocery_stores
                                confidence: '0.93'
                          merchant:
                            id: rick_rock
                            merchant_name: 'Rick Rock'
                            merchant_logo: 'https://assets.example.com/image.jpg'
                            merchant_confidence: '1'
                          regular_payments:
                            label: '-1'
                            score: '0'
                            period: unknown
                          carbon_tracker:
                            co2_amount_kg: 1.26
                    metadata:
                      from: '2019-03-27'
                      to: '2019-03-29'
                      results: 2
                'Specific Account Transactions':
                  value:
                    operation_id: transactions_get
                    data:
                      -
                        id: 980ef9ba0211a05ee3ca92ed2c38b77ec8a49d5cb5c7d72e3dcdb9981000000
                        provider: Lloyds
                        raw_transaction:
                          account_id: '100000'
                          transaction_id: '100001'
                          transaction_reference: 'Ref 100001'
                          amount:
                            amount: '10.00'
                            currency: GBP
                          credit_debit_indicator: Credit
                          status: Booked
                          booking_date_time: '2019-05-07T00:00:00+0000'
                          value_date_time: '2019-06-15T00:00:00+0000'
                          address_line: London
                          transaction_information: '6278 16Mar19 CD HONEST BURGERS LONDON GB'
                          bank_transaction_code:
                            code: ReceivedCreditTransfer
                            sub_code: DomesticCreditTransfer
                          proprietary_bank_transaction_code:
                            code: Transfer
                            issuer: AlphaBank
                          balance:
                            amount:
                              amount: '230.00'
                              currency: GBP
                            credit_debit_indicator: Credit
                            type: InterimBooked
                          merchant_details:
                            merchant_name: 'Eddie Ching'
                            merchant_category_code: MNC1
                          statement_reference:
                            - REF1
                          currency_exchange:
                            contract_identification: 'GBP to AUD'
                            exchange_rate: '1.83'
                            instructed_amount:
                              amount: '10.00'
                              currency: GBP
                            quotation_date: '2019-04-11T00:00:00+0000'
                            source_currency: GBP
                            target_currency: AUD
                            unit_currency: GBP
                          creditor_agent:
                            scheme_name: BICFI
                            identification: AlphaBank
                            name: 'AlphaBank business account'
                            postal_address:
                              address_type: Business
                              building_number: '1'
                              country: 'United Kingdom'
                              country_subdivision: England
                              department: admin
                              postcode: 'EC1V 9NR'
                              street_name: 'street name'
                              sub_department: reception
                              town_name: london
                              address_line:
                                - 'line 1'
                                - 'line 2'
                                - 'line 3'
                          creditor_account:
                            scheme_name: IBAN
                            identification: 'Bobs Bills'
                            name: Account1
                            secondary_identification: SecId
                          debtor_agent:
                            scheme_name: IBAN
                            identification: 'Bobs Bills'
                            name: 'Bobs bank account'
                            postal_address:
                              address_type: Business
                              building_number: '1'
                              country: 'United Kingdom'
                              country_subdivision: England
                              department: admin
                              postcode: 'EC1V 9NR'
                              street_name: 'street name'
                              sub_department: reception
                              town_name: london
                              address_line:
                                - 'line 1'
                                - 'line 2'
                                - 'line 3'
                          debtor_account:
                            scheme_name: BICFI
                            identification: AlphaBank
                            name: BB1
                            secondary_identification: 4435534GG
                          card_instrument:
                            card_scheme_name: AmericanExpress
                            card_authorisation_type: Contactless
                            cardholder_name: 'Mr Bob Smith'
                            identification: 'PAYMENT xxxxx'
                          charge_amount:
                            amount: '10.00'
                            currency: GBP
                          supplementary_data:
                            unknown_elements: true
                        enrichment:
                          categoriser:
                            categories:
                              -
                                category_name: groceries
                                confidence: '0.88'
                            subcategories:
                              -
                                subcategory_name: super_markets_and_grocery_stores
                                confidence: '0.93'
                          merchant:
                            id: honest_burgers
                            merchant_name: 'Honest Burgers'
                            merchant_logo: 'https://assets.example.com/image.jpg'
                            merchant_confidence: '1'
                          regular_payments:
                            label: de153aaed3b7427as8o9uoljk23098jlksdosd27de5e8df68224d33d3b74272-1
                            score: '0.9656'
                            period: monthly
                          carbon_tracker:
                            co2_amount_kg: 7.02
                      -
                        id: 980ef9ba0211a05ee3ca92ed2c38b77ec8a49d5cb5c7d72e3dcdb9981a025e74
                        provider: Lloyds
                        raw_transaction:
                          account_id: '100000'
                          transaction_id: '200001'
                          transaction_reference: 'Ref 200001'
                          amount:
                            amount: '20.00'
                            currency: GBP
                          credit_debit_indicator: Credit
                          status: Booked
                          booking_date_time: '2019-04-13T00:00:00+0000'
                          value_date_time: '2019-04-16T00:00:00+0000'
                          address_line: Liverpool
                          transaction_information: '111 CLOSE GATE LANE'
                          bank_transaction_code:
                            code: ReceivedCreditTransfer
                            sub_code: DomesticCreditTransfer
                          proprietary_bank_transaction_code:
                            code: Transfer
                            issuer: BlinkBank
                          balance:
                            amount:
                              amount: '230.20'
                              currency: GBP
                            credit_debit_indicator: Credit
                            type: InterimBooked
                          merchant_details:
                            merchant_name: 'Rick Rock'
                            merchant_category_code: RR1
                          statement_reference:
                            - REF1
                            - REF2
                          currency_exchange:
                            contract_identification: 'GBP to AUD'
                            exchange_rate: '1.83'
                            instructed_amount:
                              amount: '11.00'
                              currency: GBP
                            quotation_date: '2019-05-04T00:00:00+0000'
                            source_currency: GBP
                            target_currency: AUD
                            unit_currency: GBP
                          creditor_agent:
                            scheme_name: BICFI
                            identification: BlinkBank
                            name: BlinkBank
                            postal_address:
                              address_type: Business
                              building_number: '1'
                              country: 'United Kingdom'
                              country_subdivision: England
                              department: admin
                              postcode: 'EC1V 9NR'
                              street_name: 'street name'
                              sub_department: reception
                              town_name: london
                              address_line:
                                - 'line 1'
                                - 'line 2'
                                - 'line 3'
                          creditor_account:
                            scheme_name: IBAN
                            identification: 'Roman Erik'
                            name: Account1
                            secondary_identification: null
                          debtor_agent:
                            scheme_name: IBAN
                            identification: 'Roman Erik'
                            name: 'Roman Erik'
                            postal_address:
                              address_type: Business
                              building_number: '1'
                              country: 'United Kingdom'
                              country_subdivision: England
                              department: admin
                              postcode: 'EC1V 9NR'
                              street_name: 'street name'
                              sub_department: reception
                              town_name: london
                              address_line:
                                - 'line 1'
                                - 'line 2'
                                - 'line 3'
                          debtor_account:
                            scheme_name: BICFI
                            identification: BlinkBank
                            name: BB1
                            secondary_identification: null
                          card_instrument:
                            card_scheme_name: Visa
                            card_authorisation_type: Contactless
                            cardholder_name: 'Elly Bon'
                            identification: ABC123
                          charge_amount:
                            amount: '2.00'
                            currency: GBP
                          supplementary_data:
                            unknown_elements: true
                        enrichment:
                          categoriser:
                            categories:
                              -
                                category_name: groceries
                                confidence: '0.88'
                            subcategories:
                              -
                                subcategory_name: super_markets_and_grocery_stores
                                confidence: '0.93'
                          merchant:
                            id: rick_rock
                            merchant_name: 'Rick Rock'
                            merchant_logo: 'https://assets.example.com/image.jpg'
                            merchant_confidence: '1'
                          regular_payments:
                            label: sdf09823lkjewf9jlk31908sadsaoiusd3ggs3g2gk7099dkh0123-2
                            score: '0.4987'
                            period: quarterly
                          carbon_tracker:
                            co2_amount_kg: 1.26
                    metadata:
                      from: '2019-03-27'
                      to: '2019-03-29'
                      results: 2
        401:
          description: 'An unauthenticated request was received.'
        405:
          description: 'The request uses an unexpected HTTP method.'
        5XX:
          description: 'An unexpected error occurred on the server side.'
  /financial/v2/transactions:
    get:
      tags:
        - 'Fetch Financial Data'
      summary: 'List Transactions V2'
      description: |
        List the transactions for a customer across all ingestion sources. Ordered by `date_time` and then `transaction_id` descending.
      operationId: v2_transactions_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          in: query
          name: date_from
          schema:
            type: string
          example: '2022-02-28'
          description: 'UTC Date (YYYY-MM-DD) from which the transactions should be returned from.'
        -
          in: query
          name: date_to
          schema:
            type: string
          example: '2022-05-28'
          description: 'UTC Date (YYYY-MM-DD) from which the transactions should be returned to.'
        -
          in: query
          name: page_size
          schema:
            type: integer
          example: 100
          description: 'Maximum number of results to be returned. Defaults to 100, maximum is 200'
        -
          in: query
          name: page_token
          schema:
            type: string
          example: eyJvZmZzZXQiOjEwMH0
          description: 'The token required to fetch a specific page of results. Provided by the `next_page_token` field in the previous request.'
        -
          in: query
          name: account_id
          schema:
            type: string
          example: an_account_id
          description: 'Identifier of the accounts from which transactions should be returned.'
        -
          in: query
          name: merchant
          schema:
            type: string
          description: 'Human readable identifier of the merchants for which associated transactions should be returned.'
          example: a_merchant_slug
        -
          in: query
          name: category_l1
          schema:
            type: string
          example: bills
          description: 'Identifier of the Category Level 1 for which associated transactions should be returned.'
        -
          in: query
          name: category_l2
          schema:
            type: string
          example: tv_and_broadband
          description: 'Identifier of the Category Level 2 for which associated transactions should be returned.'
        -
          in: query
          name: include_tags
          schema:
            type: array
            items:
              type: string
          example: regular-transaction
          description: 'Tags for which associated transactions should be returned.'
        -
          in: query
          name: exclude_tags
          schema:
            type: array
            items:
              type: string
          example: benefit
          description: 'Tags for which associated transactions should not be returned.'
      responses:
        200:
          description: 'The request was successfully processed.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListTransactionsResponse'
              examples:
                'Multiple Transactions':
                  value:
                    operation_id: v2_transactions_get
                    data:
                      -
                        transaction_id: a_transaction_id
                        account_id: an_account_id
                        provider: a_bank_account_provider
                        description: 'paypal* specialty coffee'
                        credit_debit_indicator: debit
                        status: booked
                        amount:
                          value: '10.99'
                          currency: GBP
                        date_time: '2022-05-28T10:00:00Z'
                        enrichments:
                          categories:
                            l1:
                              slug: eating_out
                              confidence: '0.99'
                            l2:
                              slug: cafes_and_eating_out
                              confidence: '0.98'
                          merchant:
                            id: 01cc2d49-6144-46f1-9414-67c99b139a95
                            slug: specialty_coffee
                            display_name: 'Specialty Coffee Supplier Ltd.'
                            logo: 'http://url/specialty_coffee_supplier_logo.jpeg'
                          processor:
                            id: 18f63293-0217-4520-bbf0-071dca7a9d04
                            slug: paypal
                            display_name: PayPal
                            logo: 'http://url/paypal_logo.jpeg'
                          regularity:
                            frequency: monthly
                            predicted_date_times:
                              - '2022-06-28T15:00:00Z'
                              - '2022-07-28T15:00:00Z'
                              - '2022-08-28T15:00:00Z'
                            group_label: a_group_id
                          transaction_types:
                            - card
                            - debit
                          names:
                            - 'jane doe'
                        tags:
                          - regular-transaction
                      -
                        transaction_id: another_transaction_id
                        account_id: another_account_id
                        provider: another_bank_account_provider
                        description: 'Tesco 2956 London GBR'
                        credit_debit_indicator: debit
                        status: booked
                        amount:
                          value: '50.23'
                          currency: GBP
                        date_time: '2022-05-26T10:00:00Z'
                        enrichments:
                          categories:
                            l1:
                              slug: eating_out
                              confidence: '0.99'
                            l2:
                              slug: cafes_and_eating_out
                              confidence: '0.98'
                          merchant:
                            id: 0980cf54-6052-4527-84ff-e6f9b169884f
                            slug: tesco_stores
                            display_name: Tesco
                            logo: 'http://url/tesco_stores_logo.jpeg'
                          location:
                            address:
                              address_lines:
                                - '224-226 Portobello Rd'
                                - London
                              country: GBR
                          transaction_types:
                            - card
                            - debit
                    metadata:
                      results: 2
                      next_page_token: eyJvZmZzZXQiOjEwMH0
                'Single Transaction Without Enrichments':
                  value:
                    operation_id: v2_transactions_get
                    data:
                      -
                        transaction_id: a_transaction_id
                        account_id: an_account_id
                        provider: a_bank_account_provider
                        description: a_transaction_description
                        credit_debit_indicator: credit
                        status: pending
                        amount:
                          value: '10.99'
                          currency: GBP
                        date_time: '2022-01-02T15:00:00Z'
                    metadata:
                      results: 1
                      next_page_token: eyJvZmZzZXQiOjEwMH0
                'No Transactions':
                  value:
                    operation_id: v2_transactions_get
                    data: []
                    metadata:
                      results: 0
        401:
          description: 'An unauthenticated request was received.'
        405:
          description: 'The request uses an unexpected HTTP method.'
        5XX:
          description: 'An unexpected error occurred on the server side.'
  /financial/beta/accounts:
    get:
      tags:
        - 'Fetch Financial Data'
      summary: 'List Accounts V2 (beta)'
      description: |
        *Beta endpoint not subject to breaking change restrictions. This endpoint will eventually be moved to `/financial/v2/accounts`.*

        Retrieves a list of accounts for a customer. This result can be filtered using the query parameters outlined below.

        Bud sometimes adjusts the `balance.date` for some balance types, based on the `type` supplied on account ingestion. This is done so the
        data returned from this endpoint is correct and easy to understand and consume regardless of the account provider or ingestion method.

        Below is a table of balance types that have their date adjusted before it is returned from this endpoint.

        | Balance Type                                                                    | Date Adjustment                                                                                      | Example                                                      |
        |:--------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------|:-------------------------------------------------------------|
        | `ClosingAvailable`, `ClosingBooked`, `ClosingCleared`                           | This is the balance at the end of the previous day. The date and time are set to then.               | `2023-01-12T13:00:00Z` is returned as `2023-01-11T23:59:59Z` |
        | `OpeningAvailable`, `OpeningBooked`, `OpeningCleared`, `PreviouslyClosedBooked` | This is the balance at the start of the day. The time is set to the start of then.                   | `2023-01-12T13:00:00Z` is returned as `2023-01-12T00:00:00Z` |
        | `Expected`                                                                      | This is the balance including, pending transactions, at the end of the day. The time is set to then. | `2023-01-12T13:00:00Z` is returned as `2023-01-12T23:59:59Z` |

        > 📘 Do you have feedback?
        > Beta endpoints rely on customer feedback to get better and more powerful for everyone.
        > If you have any suggestions, feedback or questions, please use the `Did this page help you?` buttons at the bottom of this page to let us know.
        > Any feedback you can provide will allow us to further improve prior to releasing this as a full production endpoint.
      operationId: financial_beta_accounts
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/QueryCurrency'
        -
          $ref: 'components.yaml#/parameters/QueryProvider'
        -
          in: query
          name: account_type
          schema:
            type: string
            enum:
              - charge_card
              - credit_card
              - current_account
              - e_money
              - loan
              - mortgage
              - pre_paid_card
              - savings
          example: current_account
          description: 'Specifies the types of accounts to be returned, this can be added to the URI multiple times for multiple account types'
        -
          in: query
          name: holder_type
          schema:
            type: string
            enum:
              - personal
              - business
              - sole
              - joint
              - delegate
          example: personal
          description: 'Specifies the accounts with a holder of the given type to be returned, this can be added to the URI multiple times for accounts with different holder types'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/ListAccountsV2Response'
              examples:
                'Single Holder Personal Account':
                  value:
                    operation_id: financial_beta_accounts
                    data:
                      -
                        account_id: ee7a2d6a-2baa-461a-aca2-844e88a3f3e7
                        currency: GBP
                        holder:
                          holder_name: 'David Smith'
                          holder_type: personal
                        account_name: 'My Current Account'
                        account_type: current_account
                        provider: BankOfBud
                        identifiers:
                          uk_sort_code: '126432'
                          uk_account_number: '31510604'
                        balance:
                          date: '2023-01-12T00:00:00Z'
                          booked:
                            amount:
                              value: '3552.61'
                              currency: GBP
                            credit_debit_indicator: debit
                          credit_limit:
                            value: '1000.00'
                            currency: GBP
                    metadata:
                      parameters:
                        currencies:
                          - GBP
                      result_count: 1
                'Multiple Holder Joint Account':
                  value:
                    operation_id: financial_beta_accounts
                    data:
                      -
                        account_id: 928fed73-2eb9-4910-8a26-22b6c76fb9fa
                        currency: GBP
                        holders:
                          -
                            holder_name: 'David Smith'
                            holder_type: joint
                          -
                            holder_name: 'Jane Smith'
                            holder_type: joint
                        account_name: 'Household Account'
                        account_type: current_account
                        provider: BankOfBud
                        identifiers:
                          uk_sort_code: '124332'
                          uk_account_number: '12642318'
                        balance:
                          date: '2023-01-12T00:00:00Z'
                          booked:
                            amount:
                              value: '1532.61'
                              currency: GBP
                            credit_debit_indicator: credit
                          credit_limit:
                            value: '1500.00'
                            currency: GBP
                    metadata:
                      parameters: null
                      result_count: 1
        400:
          description: 'Bad Request'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              examples:
                'CustomerID Not Sent':
                  value:
                    operation_id: financial_beta_accounts
                    code_id: failed_validation
                    message: 'Invalid request payload.'
                    errors:
                      error:
                        X-Customer-Id: 'not present'
                'CustomerID and CustomerSecret Not Sent':
                  value:
                    operation_id: financial_beta_accounts
                    code_id: failed_validation
                    message: 'Invalid request payload.'
                    errors:
                      error:
                        X-Customer-Id: 'not present'
                        X-Customer-Secret: 'not present'
        500:
          description: 'Server Error'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/ServerErrorResponse'
              example:
                operation_id: unknown
                code_id: unknown
                message: 'An error occurred while processing your request. Get in touch with us and provide us your request id: 7ef63242-ba6d-4661-8014-f9eaa9cb2ad8'
  '/financial/beta/accounts/{account_id}':
    get:
      tags:
        - 'Fetch Financial Data'
      summary: 'Retrieve Account By ID V2 (beta)'
      description: |
        *Beta endpoint not subject to breaking change restrictions. This endpoint will eventually be moved to `/financial/v2/accounts/{account_id}`.*

        Retrieves a specific account for a customer by `account_id`.

        Bud sometimes adjusts the `balance.date` for some balance types, based on the `type` supplied on account ingestion. This is done so the
        data returned from this endpoint is correct and easy to understand and consume regardless of the account provider or ingestion method.

        Below is a table of balance types that have their date adjusted before it is returned from this endpoint.

        | Balance Type                                                                    | Date Adjustment                                                                                      | Example                                                      |
        |:--------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------|:-------------------------------------------------------------|
        | `ClosingAvailable`, `ClosingBooked`, `ClosingCleared`                           | This is the balance at the end of the previous day. The date and time are set to then.               | `2023-01-12T13:00:00Z` is returned as `2023-01-11T23:59:59Z` |
        | `OpeningAvailable`, `OpeningBooked`, `OpeningCleared`, `PreviouslyClosedBooked` | This is the balance at the start of the day. The time is set to the start of then.                   | `2023-01-12T13:00:00Z` is returned as `2023-01-12T00:00:00Z` |
        | `Expected`                                                                      | This is the balance including, pending transactions, at the end of the day. The time is set to then. | `2023-01-12T13:00:00Z` is returned as `2023-01-12T23:59:59Z` |

        > 📘 Do you have feedback?
        > Beta endpoints rely on customer feedback to get better and more powerful for everyone.
        > If you have any suggestions, feedback or questions, please use the `Did this page help you?` buttons at the bottom of this page to let us know.
        > Any feedback you can provide will allow us to further improve prior to releasing this as a full production endpoint.
      operationId: financial_beta_accounts_account_id
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/PathAccountID'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/RetrieveAccountByIDV2Response'
              examples:
                'Single Holder Personal Account':
                  value:
                    operation_id: financial_beta_accounts_account_id
                    data:
                      account_id: ee7a2d6a-2baa-461a-aca2-844e88a3f3e7
                      currency: GBP
                      holder:
                        holder_name: 'David Smith'
                        holder_type: personal
                      account_name: 'My Current Account'
                      account_type: current_account
                      provider: BankOfBud
                      identifiers:
                        uk_sort_code: '126432'
                        uk_account_number: '31510604'
                      balance:
                        date: '2023-01-12T00:00:00Z'
                        booked:
                          amount:
                            value: '3552.61'
                            currency: GBP
                          credit_debit_indicator: debit
                        credit_limit:
                          value: '1000.00'
                          currency: GBP
                    metadata: null
                'Multiple Holder Joint Account':
                  value:
                    operation_id: financial_beta_accounts_account_id
                    data:
                      account_id: 928fed73-2eb9-4910-8a26-22b6c76fb9fa
                      currency: GBP
                      holders:
                        -
                          holder_name: 'David Smith'
                          holder_type: joint
                        -
                          holder_name: 'Jane Smith'
                          holder_type: joint
                      account_name: 'Household Account'
                      account_type: current_account
                      provider: BankOfBud
                      identifiers:
                        uk_sort_code: '124332'
                        uk_account_number: '12642318'
                      balance:
                        date: '2023-01-12T00:00:00Z'
                        booked:
                          amount:
                            value: '1532.61'
                            currency: GBP
                          credit_debit_indicator: credit
                        credit_limit:
                          value: '1500.00'
                          currency: GBP
                    metadata: null
        400:
          description: 'Bad Request'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              examples:
                'CustomerID Not Sent':
                  value:
                    operation_id: financial_beta_accounts_account_id
                    code_id: failed_validation
                    message: 'Invalid request payload.'
                    errors:
                      error:
                        X-Customer-Id: 'not present'
                'CustomerID and CustomerSecret Not Sent':
                  value:
                    operation_id: financial_beta_accounts_account_id
                    code_id: failed_validation
                    message: 'Invalid request payload.'
                    errors:
                      error:
                        X-Customer-Id: 'not present'
                        X-Customer-Secret: 'not present'
        500:
          description: 'Server Error'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/ServerErrorResponse'
              example:
                operation_id: unknown
                code_id: unknown
                message: 'An error occurred while processing your request. Get in touch with us and provide us your request id: 7ef63242-ba6d-4661-8014-f9eaa9cb2ad8'
  /financial/beta/balances:
    get:
      tags:
        - 'Fetch Financial Data'
      summary: 'Balances Over Time (Beta)'
      description: |
        *Beta endpoint not subject to breaking change restrictions.* 

        - Will eventually be moved to `/financial/v2/balances`

        List the balances of each bank account for a customer accross all ingestion sources. Ordered by balance date.

        It calculates the balance for each date, by iterating from the date the account was last refreshed to the `to` and `from` dates provided. It then checks all the transactions within this range, calculating the balance at the end of each day.

        This endpoint limits the date from which it gets balances from either by the oldest `transaction_window` on the account if they are present, or by the oldest transaction within the requested date range available.

        For users ingesting data via the `Ingest Accounts` endpoint, you can increase the range and accuracy of the data supplied from this service by including the transaction_window field upon acccount ingestion.

        > 📘 Do you have feedback?
        > Beta endpoints rely on customer feedback to get better and more powerful for everyone.
        > If you have any suggestions, feedback or questions, please use the `Did this page help you?` buttons at the bottom of this page to let us know.
        > Any feedback you can provide will allow us to further improve prior to releasing this as a full production endpoint.
      operationId: financial_v2_balances_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/QueryFromDate'
        -
          $ref: 'components.yaml#/parameters/QueryToDate'
        -
          in: query
          name: granularity
          schema:
            type: string
            enum:
              - daily
              - weekly
              - biweekly
              - monthly
              - quarterly
              - six_monthly
              - annually
          example: daily
          description: 'Specifies in what interval the balance over time should be retrieved.'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/GetBalancesResponse'
              example:
                operation_id: financial_v2_balances_get
                data:
                  -
                    account_id: 5b271e24-9ea5-4d7e-b5da-64f01d32db22
                    account_type: personal
                    account_sub_type: current_account
                    balances:
                      -
                        date: '2022-11-15'
                        booked:
                          amount:
                            value: '900.00'
                            currency: GBP
                          credit_debit_indicator: credit
                        pending:
                          amount:
                            value: '850.00'
                            currency: GBP
                          credit_debit_indicator: credit
                      -
                        date: '2022-11-14'
                        booked:
                          amount:
                            value: '950.00'
                            currency: GBP
                          credit_debit_indicator: credit
                        pending:
                          amount:
                            value: '900.00'
                            currency: GBP
                          credit_debit_indicator: credit
                  -
                    account_id: b6e9ea3c-71f9-4572-983a-3e5e85470dad
                    account_type: personal
                    account_sub_type: savings
                    balances:
                      -
                        date: '2022-11-15'
                        booked:
                          amount:
                            value: '500'
                            currency: JPY
                          credit_debit_indicator: credit
                metadata:
                  accounts:
                    5b271e24-9ea5-4d7e-b5da-64f01d32db22:
                      balance_count: 2
                      from: '2022-11-14'
                      to: '2022-11-15'
                    b6e9ea3c-71f9-4572-983a-3e5e85470dad:
                      balance_count: 1
                      from: '2022-11-15'
                      to: '2022-11-15'
                  parameters:
                    from: '2020-12-22'
                    to: '2022-11-15'
                    granularity: daily
        400:
          description: 'Bad Request'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
        500:
          description: 'Server Error'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/ServerErrorResponse'
              example:
                operation_id: financial_v2_balances_get
                code_id: internal_error
                message: 'Internal server error has occurred.'
                errors:
                  error: 'failed to format amount'
  '/financial/beta/accounts/{account_id}/balances':
    get:
      tags:
        - 'Fetch Financial Data'
      summary: 'Balances Over Time By Account (Beta)'
      description: |
        *Beta endpoint not subject to breaking change restrictions.* 

        - Will eventually be moved to `/financial/v2/accounts/{account_id}/balances`

        List the balances of a specific bank account for a customer accross all ingestion sources. Ordered by balance date.

        It calculates the balance for each date, by iterating from the date the account was last refreshed to the `to` and `from` dates provided. It then checks all the transactions within this range, calculating the balance at the end of each day.

        This endpoint limits the date from which it gets balances from either by the oldest `transaction_window` on the account if they are present, or by the oldest transaction within the requested date range available.

        For users ingesting data via the `Ingest Accounts` endpoint, you can increase the range and accuracy of the data supplied from this service by including the transaction_window field upon acccount ingestion.

        > 📘 Do you have feedback?
        > Beta endpoints rely on customer feedback to get better and more powerful for everyone.
        > If you have any suggestions, feedback or questions, please use the `Did this page help you?` buttons at the bottom of this page to let us know.
        > Any feedback you can provide will allow us to further improve prior to releasing this as a full production endpoint.
      operationId: financial_v2_accounts_balances_get
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/QueryFromDate'
        -
          $ref: 'components.yaml#/parameters/QueryToDate'
        -
          $ref: 'components.yaml#/parameters/PathAccountID'
        -
          in: query
          name: granularity
          schema:
            type: string
            enum:
              - daily
              - weekly
              - biweekly
              - monthly
              - quarterly
              - six_monthly
              - annually
          example: daily
          description: 'Specifies in what interval the balance over time should be retrieved.'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/GetBalancesForAccountIDResponse'
              example:
                operation_id: financial_v2_accounts_balances_get
                data:
                  -
                    date: '2022-11-15'
                    booked:
                      amount:
                        value: '900.00'
                        currency: GBP
                      credit_debit_indicator: credit
                    pending:
                      amount:
                        value: '850.00'
                        currency: GBP
                      credit_debit_indicator: credit
                  -
                    date: '2022-11-14'
                    booked:
                      amount:
                        value: '950.00'
                        currency: GBP
                      credit_debit_indicator: credit
                    pending:
                      amount:
                        value: '900.00'
                        currency: GBP
                      credit_debit_indicator: credit
                metadata:
                  account:
                    balance_count: 2
                    from: '2022-11-14'
                    to: '2022-11-15'
                  parameters:
                    from: '2020-12-22'
                    to: '2022-11-15'
                    granularity: daily
        400:
          description: 'Bad Request'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: financial_v2_accounts_balances_get
                code_id: failed_validation
                message: 'Invalid request payload.'
                errors:
                  CustomerID: 'not present'
                  CustomerSecret: 'not present'
        404:
          description: 'Not Found'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestNotFoundResponse'
              example:
                operation_id: financial_v2_accounts_balances_get
                code_id: account_not_found
                message: 'The specified account could not be found. Please check the account identifier is correct. The account might be closed or suspended.'
        500:
          description: 'Server Error'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/ServerErrorResponse'
              example:
                operation_id: financial_v2_accounts_balances_get
                code_id: internal_error
                message: 'Internal server error has occurred.'
                errors:
                  error: 'failed to format amount'
  '/v1/provider/{provider}':
    delete:
      tags:
        - 'Manage Financial Data'
      summary: 'Remove Provider Data'
      description: |
        Delete all data (transactions, enrichments, accounts) related to the specified provider.
      operationId: v1_provider_delete
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/OBProvider'
      responses:
        204:
          description: 'The request was successfully processed.'
        400:
          description: 'Bad request.'
        401:
          description: 'An unauthenticated request was received.'
        405:
          description: 'The request uses an unexpected HTTP method.'
        5XX:
          description: 'An unexpected error occurred on the server side.'
  /v1/recategorise/customer-corrections/double-cat:
    post:
      tags:
        - 'Manage Financial Data'
      summary: 'Recategorise Transactions V1'
      description: |
        Allow a customer to change a transaction’s category and/or subcategory.

        Tag all similar transactions (those that currently exist and those that happen in the future) with the new category and/or subcategory value for a given customer.

        Similar transactions are determined based on transactions with similar descriptions & amounts.
      operationId: recategorise_customer_double_cat_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/RecategoriseCustomerRequestDoublecat'
            example:
              -
                account_id: 5f44d9d6-8de0-4bc7-8db2-c26aea40ed62
                transaction_id: 7affc586-5600-4434-ac5f-1a845260d7d9
                category_name: eating_out
                subcategory_name: other_eating_out
      responses:
        200:
          description: 'The request was successfully processed'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/RecategoriseCustomerResponseDoublecat'
              example:
                operation_id: recategorise_customer_double_cat_post
                data:
                  -
                    account_id: 5f44d9d6-8de0-4bc7-8db2-c26aea40ed62
                    transaction_id: 7affc586-5600-4434-ac5f-1a845260d7d9
                    category_name: eating_out
                    subcategory_name: other_eating_out
                metadata:
                  results: 1
        400:
          description: 'The request contains an invalid payload'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: recategorise_customer_double_cat_post
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  category_name: 'This value should not be blank'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /corrections/v2/categories:
    post:
      tags:
        - 'Manage Financial Data'
      summary: 'Recategorise Transactions V2'
      description: |
        Allow a customer to change a transaction’s (and similar transactions') category and/or subcategory.

        If `include_similar` is set to `true`, then all previous and future transactions (i.e. those that are yet to happen yet) that are similar in nature to the specified transaction id will be corrected with the provided category and/or subcategory.

        Similar transactions are determined based on transactions with similar descriptions & amounts.
      operationId: corrections_v2_categories_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/CustomerCategoryCorrectionRequest'
            example:
              -
                transaction_id: 7affc586-5600-4434-ac5f-1a845260d7d9
                category_l1: food_and_drink
                category_l2: coffee
                include_similar: false
      responses:
        200:
          description: 'The request was successfully processed'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/CustomerCategoryCorrectionResponse'
              example:
                operation_id: corrections_v2_categories_post
                data:
                  -
                    transaction_id: 7affc586-5600-4434-ac5f-1a845260d7d9
                    category_l1: food_and_drink
                    category_l2: coffee
                    include_similar: false
                metadata:
                  results: 1
        400:
          description: 'The request contains an invalid payload'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: corrections_v2_categories_post
                code_id: validation_error
                message: 'Bad request payload'
                errors:
                  X-Client-ID: 'This value should not be blank'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/transactions/attributes/client-labels:
    post:
      tags:
        - 'Manage Financial Data'
      summary: 'Create Transaction Rule(s)'
      description: 'Submit rules for adding custom attributes to transactions based on properties of the transaction. Rules can be a combination of an exact match on the amount, cdi, currency and description.'
      operationId: v1_transactions_attributes_client_labels_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/TransactionAttributesClientLabelsRequest'
            example:
              -
                match_attributes:
                  -
                    type: exact
                    name: amount
                    value: '1800.00'
                  -
                    type: exact
                    name: cdi
                    value: Credit
                set_attribute:
                  values:
                    - 'freelance income'
                    - 'pocket money'
      responses:
        200:
          description: 'The operation was successful'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/TransactionAttributesClientLabelsResponse'
              example:
                operation_id: v1_transactions_attributes_client_labels_post
                data:
                  rules_created: 2
        400:
          description: 'The request contains an invalid payload'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_transactions_attributes_client_labels_post
                code_id: 'Bad Request'
                message: 'Required field in payload not set'
                errors:
                  'match_attributes[0].type': 'this field is required'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        413:
          description: 'More than 1000 corrections were requested'
        422:
          description: 'Transaction(s) not found, corrections could not be processed'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/regular-transactions:
    get:
      tags:
        - 'Regular Insights'
      summary: 'Retrieve Regular Transactions'
      description: |
        Provides a list of customer transactions that occur regularly. Currently the following periods are supported:
        - `daily`
        - `weekly`
        - `biweekly`
        - `monthly`
        - `quarterly`
        - `unknown`
      operationId: regular_transactions_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
      responses:
        200:
          description: 'The request was successfully processed'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/RegularTransactionsResponse'
              example:
                operation_id: regular_transactions_get
                data:
                  -
                    label: 7fa6c13ac15468dd61cc7680f005b1dcdd9504d7-0
                    period: monthly
                    score: '0.9892'
                    transactions:
                      -
                        provider: Barclays
                        account_id: 688cb2e1-fca9-4d77-bbd3-604abb3c9d46
                        transaction_id: 3c6f2abd-87ff-4b57-b7c7-c500926571e7
                        transaction_description: 'Bank credit paypal'
                        date: '2019-07-04T00:00:00+0000'
                        amount:
                          amount: '49.99'
                          currency: GBP
                        credit_debit_indicator: Debit
                        merchant:
                          id: paypal
                          name: PayPal
                          logo: 'https://assets.thisisbud.com/bud-datasci-images/merchant_logos/a3af57fc-ec8a-4258-a8da-8d34f11640f6/v1/paypal.jpeg'
                      -
                        provider: Barclays
                        account_id: 688cb2e1-fca9-4d77-bbd3-604abb3c9d46
                        transaction_id: d06bef46-7500-4d34-a419-bb2c5e4ee9fa
                        transaction_description: 'Bank credit paypal'
                        date: '2019-08-04T00:00:00+0000'
                        amount:
                          amount: '52.3'
                          currency: GBP
                        credit_debit_indicator: Debit
                        merchant:
                          id: paypal
                          name: PayPal
                          logo: 'https://assets.thisisbud.com/bud-datasci-images/merchant_logos/a3af57fc-ec8a-4258-a8da-8d34f11640f6/v1/paypal.jpeg'
                  -
                    label: 8a29913437a6d2e72a9576a15593f43d92cfc2eb-0
                    period: monthly
                    score: '0.9892'
                    transactions:
                      -
                        provider: Lloyds
                        account_id: 688cb2e1-fca9-4d77-bbd3-604abb3c9d46
                        transaction_id: c5a50ce9-5523-47b4-8c08-3cd8e30e34a6
                        transaction_description: 'Foxtons - Rent'
                        date: '2019-06-02T00:00:00+0000'
                        amount:
                          amount: '1325'
                          currency: GBP
                        credit_debit_indicator: Debit
                        merchant:
                          id: foxtonslimited
                          name: 'FOXTONS LIMITED'
                          logo: 'https://assets.thisisbud.com/bud-datasci-images/merchant_logo_placeholder.png'
                      -
                        provider: Lloyds
                        account_id: 688cb2e1-fca9-4d77-bbd3-604abb3c9d46
                        transaction_id: 70778a02-ea30-4465-b651-65189fd3c51d
                        transaction_description: 'Foxtons - Rent'
                        date: '2019-07-02T00:00:00+0000'
                        amount:
                          amount: '1325'
                          currency: GBP
                        credit_debit_indicator: Debit
                        merchant:
                          id: foxtonslimited
                          name: 'FOXTONS LIMITED'
                          logo: 'https://assets.thisisbud.com/bud-datasci-images/merchant_logo_placeholder.png'
        204:
          description: 'No transactions found'
        400:
          description: 'The request contains an invalid payload'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: regular_transactions_get
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  client_id: 'This value should not be blank'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/future-transactions:
    get:
      tags:
        - 'Regular Insights'
      summary: 'Retrieve Upcoming Transactions V1'
      description: |
        Provides a list of transactions predicted to occur in the next three months. Currently the following periods are supported:
        - `daily`
        - `weekly`
        - `biweekly`
        - `monthly`
        - `quarterly`
        - `unknown`
      operationId: future_transactions_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
      responses:
        200:
          description: 'The request was successfully processed'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/FutureTransactionsResponse'
              example:
                operation_id: future_transactions_get
                data:
                  -
                    transaction_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                    account_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                    transaction_description: Bud
                    provider: Lloyds
                    date: '2019-07-01T01:00:00+0100'
                    amount:
                      amount: '1234.56'
                      currency: GBP
                    credit_debit_indicator: Credit
                    label: 8a29913437a6d2e72a9576a15593f43d92cfc2eb-0
                    period: monthly
                    score: '0.9892'
                    future_dates:
                      - '2019-08-01T01:00:00+0100'
                      - '2019-09-01T01:00:00+0100'
                      - '2019-10-01T01:00:00+0100'
        204:
          description: 'No transactions found'
        400:
          description: 'The request contains an invalid payload'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: future_transactions_get
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  client_id: 'This value should not be blank'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v2/future-transactions:
    get:
      tags:
        - 'Regular Insights'
      summary: 'Retrieve Upcoming Transactions V2'
      description: |
        Provides a list of transactions predicted to occur in the next specified number of months. Currently the following periods are supported:
        - `daily`
        - `weekly`
        - `biweekly`
        - `monthly`
        - `quarterly`
        - `six_monthly`
        - `annually`
        - `unknown`
      operationId: v2_future_transactions_get
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/FutureTransactionsMonthsProjection'
        -
          $ref: 'components.yaml#/parameters/FutureTransactionsChangePercentage'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/FutureTransactionV2Response'
              example:
                operation_id: v2_future_transactions_get
                data:
                  -
                    transaction_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                    account_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                    transaction_description: Bud
                    label: 8a29913437a6d2e72a9576a15593f43d92cfc2eb-0
                    period: monthly
                    date_time: '2019-07-01T01:00:00Z'
                    amount:
                      value: '100.00'
                      currency: GBP
                    credit_debit_indicator: credit
                    confidence: '0.9892'
                    future_transactions:
                      -
                        date: '2022-08-01'
                        amount:
                          value: '102.00'
                          currency: GBP
                      -
                        date: '2022-09-01'
                        amount:
                          value: '104.04'
                          currency: GBP
                      -
                        date: '2022-10-01'
                        amount:
                          value: '106.12'
                          currency: GBP
                      -
                        date: '2022-11-01'
                        amount:
                          value: '108.24'
                          currency: GBP
                metadata:
                  results: 1
                  months: 4
                  change_percentages:
                    -
                      l2: bills
                      value: !!float 2
        204:
          description: 'No transactions'
        400:
          description: 'Bad request'
        401:
          description: 'Unauthorized request'
  /v1/salary:
    get:
      tags:
        - 'Income Insights'
      summary: 'Retrieve Salary Information'
      description: |
        Provides a list of transactions most likely to be a customer’s salary.
      operationId: salary_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
      responses:
        200:
          description: 'The request was successfully processed'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/SalaryResponse'
              example:
                operation_id: salary_get
                data:
                  -
                    transaction_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                    account_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                    transaction_description: Bud
                    provider: Lloyds
                    date: '2019-07-01T01:00:00+0100'
                    amount:
                      amount: '1234.56'
                      currency: GBP
                    credit_debit_indicator: Credit
                    confidence: '0.9998'
                    period: monthly
                metadata:
                  results: 1
        400:
          description: 'The request contains an invalid payload'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: salary_get
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  client_id: 'This value should not be blank'
        401:
          description: 'Unauthorised request'
        404:
          description: 'No transactions found'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/income:
    get:
      tags:
        - 'Income Insights'
      summary: 'Retrieve Income Transactions V1'
      description: |
        Provides a list of a customer's income based transactions found within their connected accounts, and predicts whether each income transaction is related to a customer's `salary_or_wages`. Any income which is not salary or wages is given the type `other_income`, which can include other income sources such as investments or pension income.

        **Notes:**
        - Transactions are filtered to return the latest income transaction per transaction reference. For instance, if the customer has 4 salary transactions all with the same reference of `Monthly Salary`, only the latest will be returned.
      operationId: v1_income_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/From'
        -
          $ref: 'components.yaml#/parameters/To'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/IncomeResponseV1'
              example:
                operation_id: v1_income_get
                data:
                  -
                    account_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                    transaction_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                    description: Bud
                    date: '2021-01-11T01:00:00+0100'
                    amount:
                      amount: '1234.56'
                      currency: GBP
                    credit_debit_indicator: Credit
                    enrichment:
                      categoriser:
                        categories:
                          -
                            category_name: finances
                            confidence: '0.8057'
                            label: Finances
                        subcategories:
                          -
                            subcategory_name: transfers_in
                            confidence: '0.7811'
                            label: 'Transfers In'
                        l3:
                          -
                            name: salary
                            confidence: '0.6805'
                            label: Salary
                      merchant:
                        id: bud
                        merchant_name: Bud
                        merchant_logo: 'https://thisisbud.com/merchants/bud.png'
                        merchant_confidence: '0.9501'
                      income:
                        label: salary_or_wages
                        confidence: '0.9408'
                metadata:
                  from: '2020-01-01'
                  to: '2022-01-01'
                  results: 1
        204:
          description: 'No transactions'
        400:
          description: 'Bad request'
        401:
          description: 'Unauthorised request'
        404:
          description: 'No transactions found'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v2/income:
    get:
      tags:
        - 'Income Insights'
      summary: 'Retrieve Income Transactions V2'
      description: |
        Provides a list of a customer's income based transactions found within their connected accounts, and predicts whether each income transaction is related to a customer's `salary_or_wages`. Any income which is not salary or wages is given the type `other_income`, which can include other income sources such as investments or pension income.

        **Notes:**
        - Transactions with multiple currencies are supported, but the statistics are currently only calculated for one currency. The endpoint takes the currency of the first transaction and ignores non-matching currencies in its calculations.
        - In contrast to the V1 endpoint, Income Finder V2 no longer filters income transactions to only return the latest per reference.
      operationId: v2_income_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/From'
        -
          $ref: 'components.yaml#/parameters/To'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/IncomeResponseV2'
              example:
                operation_id: v2_income_get
                data:
                  transactions:
                    -
                      transaction_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                      account_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                      transaction_description: Bud
                      provider: Barclays
                      date: '2021-01-11T01:00:00+0100'
                      amount:
                        value: '1234.56'
                        currency: GBP
                      credit_debit_indicator: Credit
                      enrichment:
                        categories:
                          l1:
                            -
                              name: finances
                              confidence: '0.8057'
                              label: Finances
                          l2:
                            -
                              name: transfers_in
                              confidence: '0.7811'
                              label: 'Transfers In'
                          l3:
                            -
                              name: salary
                              confidence: '0.6805'
                              label: Salary
                        merchant:
                          id: bud
                          name: Bud
                          logo: 'https://thisisbud.com/merchants/bud.png'
                          confidence: '0.9501'
                        income:
                          type: salary_or_wages
                          confidence: '0.9408'
                  statistics:
                    average:
                      monthly:
                        income:
                          value: '1234.56'
                          currency: GBP
                        regular_income:
                          value: '1234.56'
                          currency: GBP
                metadata:
                  from: '2021-01-01'
                  to: '2021-01-31'
                  results: 1
        204:
          description: 'No transactions'
        400:
          description: 'Bad request'
        401:
          description: 'Unauthorised request'
        404:
          description: 'No transactions found'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/benefits:
    get:
      tags:
        - 'Income Insights'
      summary: 'Retrieve Benefits Transactions'
      description: |
        Provides a list of a customer's benefits based transactions found within their connected accounts.
      operationId: v1_benefits_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/From'
        -
          $ref: 'components.yaml#/parameters/To'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BenefitsResponseV1'
              example:
                operation_id: v1_benefits_get
                data:
                  -
                    transaction_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                    account_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                    transaction_description: 'NATWEST DWP DLA GBR'
                    provider: Natwest
                    date: '2022-03-21T01:00:00+0100'
                    amount:
                      amount: '333.28'
                      currency: GBP
                    credit_debit_indicator: Credit
                    benefit:
                      type: disability_living_allowance
                      display_name: 'Disability Living Allowance'
                metadata:
                  from: '2022-03-19'
                  to: '2022-04-19'
                  results: 1
        204:
          description: 'No transactions'
        400:
          description: 'Bad request'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/loans:
    get:
      tags:
        - 'Expenditure Insights'
      summary: 'Retrieve Loan Transactions'
      description: |
        Provides a list of a customers' outgoing loan transactions found within their connected accounts.

        **Notes:**
        - Transactions with multiple currencies are supported, but the statistics are currently only calculated for one currency. The endpoint takes the currency of the first transaction and ignores non-matching currencies in its calculations.
      operationId: v1_loans_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/From'
        -
          $ref: 'components.yaml#/parameters/To'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/LoansResponseV1'
              example:
                operation_id: v1_loans_get
                data:
                  transactions:
                    -
                      transaction_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                      account_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                      transaction_description: 'Bud Loan Repayment'
                      provider: Natwest
                      date: '2022-03-21T01:00:00+0100'
                      amount:
                        value: '133.28'
                        currency: GBP
                      credit_debit_indicator: Debit
                      merchant:
                        id: bud
                        name: Bud
                        logo: 'https://thisisbud.com/merchants/bud.png'
                        confidence: '0.875'
                  statistics:
                    total_debit:
                      value: '133.28'
                      currency: GBP
                metadata:
                  results: 1
                  from: '2022-03-19'
                  to: '2022-04-19'
        204:
          description: 'No transactions'
        400:
          description: 'Bad request'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/debt-collection:
    get:
      tags:
        - 'Expenditure Insights'
      summary: 'Retrieve Debt Collection Transactions'
      description: |
        Provides a list of a customers' outgoing debt collection transactions found within their connected accounts.

        **Notes:**
        - Transactions with multiple currencies are supported, but the statistics are currently only calculated for one currency. The endpoint takes the currency of the first transaction and ignores non-matching currencies in its calculations.
      operationId: v1_debt_collection_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/From'
        -
          $ref: 'components.yaml#/parameters/To'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/DebtCollectionResponseV1'
              example:
                operation_id: v1_debt_collection_get
                data:
                  transactions:
                    -
                      transaction_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                      account_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                      transaction_description: 'Bud Debt Collection Payment'
                      provider: Barclays
                      date: '2021-04-11T01:00:00+0100'
                      amount:
                        value: '100.00'
                        currency: GBP
                      credit_debit_indicator: Debit
                      merchant:
                        id: debtcollector
                        name: 'Debt Collector'
                        logo: 'https://thisisbud.com/merchants/debtcollector.png'
                        confidence: '0.12345'
                  statistics:
                    total_debit:
                      value: '100.00'
                      currency: GBP
                    income_relations:
                      expense_to_income_ratio: '0.100'
                      total_income:
                        value: '1000.00'
                        currency: GBP
                metadata:
                  results: 1
                  from: '2022-03-19'
                  to: '2022-04-19'
        204:
          description: 'No transactions'
        400:
          description: 'Bad request'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/products:
    get:
      tags:
        - 'Expenditure Insights'
      summary: 'Get Financial Products'
      description: |
        The Financial Product Finder creates a summary of a customer's financial products using their transaction history. Currently, it can detect:

        - Loans
        - Buy Now, Pay Later (BNPL)
        - Mortgages
        - Insurance products
        - Credit Cards
        - Private Pensions
        - Savings & Investments

        **Notes:**
        - The Financial Product Finder currently only finds products from `debit` transactions.
      operationId: v1_products_get
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/From'
        -
          $ref: 'components.yaml#/parameters/To'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/GetProductsResponseV1'
              example:
                operation_id: v1_products_get
                data:
                  -
                    transaction_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                    account_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                    transaction_description: 'Nationwide Mortgage Payment'
                    provider: Barclays
                    date: '2021-04-11T01:00:00+0100'
                    amount:
                      value: '1000.00'
                      currency: GBP
                    credit_debit_indicator: Debit
                    merchant:
                      id: nationwidebuildingsociety
                      logo: 'https://assets.thisisbud.com/bud-datasci-images/merchant_logos/e121c7aa-a254-41bb-ad3e-33b988f791be/v1/nationwidebuildingsociety.jpeg'
                      name: 'Nationwide Building Society'
                      confidence: '0.823456'
                    product:
                      type:
                        - mortgage
                      period: monthly
                metadata:
                  results: 1
                  from: '2022-03-19'
                  to: '2022-04-19'
        204:
          description: 'No transactions found'
        400:
          description: 'The request contains an invalid payload'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/subscriptions:
    get:
      tags:
        - 'Expenditure Insights'
      summary: 'Retrieve Subscriptions'
      description: 'This endpoint is used to retrieve information about a user''s subscriptions'
      operationId: v1_subscriptions_get
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/From'
        -
          $ref: 'components.yaml#/parameters/To'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/GetSubscriptionsResponseV1'
              example:
                operation_id: v1_subscriptions_get
                data:
                  -
                    subscription_type: tv_and_film
                    period: monthly
                    categories:
                      l1: bills
                      l2: tv_broadband_and_phone
                    merchant:
                      id: netflix
                      name: Netflix
                      logo: 'https://assets.thisisbud.com/netflix_logo_placeholder.jpeg'
                    transactions:
                      -
                        transaction_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                        account_id: an_account_id
                        transaction_description: Netflix
                        provider: Barclays
                        date: '2022-03-21T01:00:00+0100'
                        amount:
                          value: '9.99'
                          currency: GBP
                        credit_debit_indicator: Debit
                      -
                        transaction_id: hdcc55c6-f347-4abc-8c66-61ff290d8bd4
                        account_id: an_account_id
                        transaction_description: Netflix
                        provider: Barclays
                        date: '2022-04-21T01:00:00+0100'
                        amount:
                          value: '9.99'
                          currency: GBP
                        credit_debit_indicator: Debit
                  -
                    subscription_type: unknown
                    period: unknown
                    categories:
                      l1: general
                      l2: other_general
                    transactions:
                      -
                        transaction_id: idcc55c6-f347-4abc-8c66-61ff290d8bd4
                        account_id: an_account_id
                        transaction_description: 'A Random Subscription Payment'
                        provider: Barclays
                        date: '2022-05-11T01:00:00+0100'
                        amount:
                          value: '59.99'
                          currency: GBP
                        credit_debit_indicator: Debit
                metadata:
                  results: 2
                  from: '2022-03-19'
                  to: '2022-05-19'
        204:
          description: 'No subscriptions found'
        400:
          description: 'The request contains an invalid payload'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/energy-switching/energy-payments:
    post:
      tags:
        - 'Expenditure Insights'
      summary: 'Initiate Energy Payments Discovery'
      description: 'Start the process of detecting a customer''s energy payments from their aggregated transactional history.'
      operationId: energy_switching_energy_payments_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
      responses:
        201:
          description: 'Successful response'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/EnergyPaymentSearch'
              example:
                operation_id: energy_switching_energy_payments_post
                data:
                  task_id: f85318cf-7cf3-4529-b9ff-0a87bd75fab1
        400:
          description: 'Bad request'
        401:
          description: 'Unauthorised request'
        5XX:
          description: 'An unexpected error occurred on the server side'
  '/v1/energy-switching/energy-payments/{task_id}':
    get:
      tags:
        - 'Expenditure Insights'
      summary: 'Retrieve Energy Payments'
      operationId: energy_switching_energy_payments_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/TaskId'
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
      responses:
        200:
          description: 'Successful response'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/EnergyPaymentSearchResponse'
              examples:
                'Payments detected':
                  value:
                    operation_id: energy_switching_energy_payments_get
                    data:
                      -
                        transaction_id: cb28d018-147f-4ae9-a613-449d9fcf282b
                        supplier:
                          id: british-gas
                          name: 'British Gas'
                          logo: 'https://assets.thisisbud.com/british-gas.jpg'
                        payment_type: 1
                        amount:
                          amount: 1250.25
                          currency: GBP
                        provider: Barclays
                      -
                        transaction_id: 34cb968d-88f4-4b3b-a861-fcd97bc12680
                        supplier:
                          id: scottish-power
                          name: 'Scottish Power'
                          logo: 'https://assets.thisisbud.com/scottish-power.jpg'
                        payment_type: 1
                        amount:
                          amount: 750.75
                          currency: GBP
                        provider: Monzo
                    metadata:
                      status: complete
                'No energy payments detected':
                  value:
                    operation_id: energy_switching_energy_payments_get
                    data: []
                    metadata:
                      status: failed
                      reason: 'No energy transactions detected'
        400:
          description: 'Bad request'
        401:
          description: 'Unauthorised request'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/affordability/spending-groups:
    post:
      tags:
        - 'Assess Affordability'
      summary: 'Create Spending Groups'
      description: |
        Provide a list of groups and categories to be returned as a breakdown of spending, along with all sources of income. If no groups are specified by the client, the Bud default standard of the most commonly used categories and groups will be returned. The header parameters X-From-Month and X-To-Month allow you to filter the result to a specified range of months.
      operationId: v1_affordability_spending_groups_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/HeaderFromSpendingGroups'
        -
          $ref: 'components.yaml#/parameters/HeaderToSpendingGroups'
        -
          $ref: 'components.yaml#/parameters/FromMonthSpendingGroups'
        -
          $ref: 'components.yaml#/parameters/ToMonthSpendingGroups'
        -
          $ref: 'components.yaml#/parameters/HeaderCurrency'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/AffordabilitySpendRequestSchema'
            example:
              -
                name: total_income
                transaction_categories:
                  - employment_income
                  - benefits
                  - other_income
              -
                name: essential_spending
                transaction_categories:
                  - mortgage_repayment
                  - utilities_water
                  - utilities_energy
                  - public_transport
      responses:
        200:
          description: 'The request was successfully processed'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/AffordabilitySpendingGroupsResponse'
              example:
                operation_id: v1_affordability_spending_groups_post
                data:
                  totals:
                    total_income:
                      total:
                        incoming:
                          value: '7500.00'
                          currency: GBP
                        outgoing:
                          value: '0.00'
                          currency: GBP
                      average:
                        incoming:
                          value: '2500.00'
                          currency: GBP
                        outgoing:
                          value: '0.00'
                          currency: GBP
                      minimum:
                        incoming:
                          value: '2500.00'
                          currency: GBP
                        outgoing:
                          value: '0.00'
                          currency: GBP
                      maximum:
                        incoming:
                          value: '2500.00'
                          currency: GBP
                        outgoing:
                          value: '0.00'
                          currency: GBP
                      transaction_count: 3
                      income_percentage: '100.00'
                    essential_spending:
                      total:
                        incoming:
                          value: '0.00'
                          currency: GBP
                        outgoing:
                          value: '3394.74'
                          currency: GBP
                      average:
                        incoming:
                          value: '0.00'
                          currency: GBP
                        outgoing:
                          value: '1131.58'
                          currency: GBP
                      minimum:
                        incoming:
                          value: '0.00'
                          currency: GBP
                        outgoing:
                          value: '1131.58'
                          currency: GBP
                      maximum:
                        incoming:
                          value: '0.00'
                          currency: GBP
                        outgoing:
                          value: '1131.58'
                          currency: GBP
                      transaction_count: 9
                      income_percentage: '45.26'
                  categories:
                    total_income:
                      employment_income:
                        total:
                          incoming:
                            value: '7500.00'
                            currency: GBP
                          outgoing:
                            value: '0.00'
                            currency: GBP
                        average:
                          incoming:
                            value: '2500.00'
                            currency: GBP
                          outgoing:
                            value: '0.00'
                            currency: GBP
                        minimum:
                          incoming:
                            value: '2500.00'
                            currency: GBP
                          outgoing:
                            value: '0.00'
                            currency: GBP
                        maximum:
                          incoming:
                            value: '2500.00'
                            currency: GBP
                          outgoing:
                            value: '0.00'
                            currency: GBP
                        transaction_count: 3
                        income_percentage: '100.00'
                      benefits:
                        total:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '0.00'
                            currency: GBP
                        average:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '0.00'
                            currency: GBP
                        minimum:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '0.00'
                            currency: GBP
                        maximum:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '0.00'
                            currency: GBP
                        transaction_count: 0
                        income_percentage: '0.00'
                      other_income:
                        total:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '0.00'
                            currency: GBP
                        average:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '0.00'
                            currency: GBP
                        minimum:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '0.00'
                            currency: GBP
                        maximum:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '0.00'
                            currency: GBP
                        transaction_count: 0
                        income_percentage: '0.00'
                    essential_spending:
                      mortgage_repayment:
                        total:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '3000.00'
                            currency: GBP
                        average:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '1000.00'
                            currency: GBP
                        minimum:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '1000.00'
                            currency: GBP
                        maximum:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '1000.00'
                            currency: GBP
                        transaction_count: 3
                        income_percentage: '40.00'
                      utilities_water:
                        total:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '103.74'
                            currency: GBP
                        average:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '34.58'
                            currency: GBP
                        minimum:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '34.58'
                            currency: GBP
                        maximum:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '34.58'
                            currency: GBP
                        transaction_count: 3
                        income_percentage: '1.38'
                      utilities_energy:
                        total:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '291.00'
                            currency: GBP
                        average:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '97.00'
                            currency: GBP
                        minimum:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '97.00'
                            currency: GBP
                        maximum:
                          incoming:
                            value: '0.00'
                            currency: GBP
                          outgoing:
                            value: '97.00'
                            currency: GBP
                        transaction_count: 3
                        income_percentage: '3.88'
                metadata:
                  schema:
                    -
                      name: total_income
                      transaction_categories:
                        - employment_income
                        - benefits
                        - other_income
                    -
                      name: essential_spending
                      transaction_categories:
                        - mortgage_repayment
                        - utilities_water
                        - utilities_energy
                        - public_transport
                  from: '2020-01-01'
                  to: '2020-03-31'
        400:
          description: 'The request contains an invalid payload'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/affordability/report:
    get:
      tags:
        - 'Affordability Report'
      summary: 'Affordability Report'
      description: 'Get an overview of a customer''s financial status.'
      operationId: v1_affordability_report
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/URLMonthFrom'
        -
          $ref: 'components.yaml#/parameters/URLMonthTo'
        -
          in: query
          name: currency
          schema:
            type: string
            description: 'Currency code for relevant transactions (default `GBP`).'
      responses:
        200:
          description: 'The request was successfully processed'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/AffordabilityReportResponse'
              example:
                operation_id: v1_affordability_report
                data:
                  months_assessed:
                    start: 2022-01
                    end: 2022-03
                  accounts:
                    connected: 3
                    holder_names:
                      - 'John Doe'
                    missing_data:
                      income: false
                      expenditure: false
                  assessment:
                    income:
                      net_disposable:
                        predicted_monthly:
                          value: '1500.00'
                          currency: GBP
                        _links:
                          transactions: '/v1/affordability/transactions?criteria=net_disposable_income'
                      net_discretionary:
                        predicted_monthly:
                          value: '70.00'
                          currency: GBP
                        _links:
                          income_transactions: '/v1/affordability/transactions?criteria=net_disposable_income'
                          expenditure_transactions: '/v1/affordability/transactions?criteria=essential_expenditure'
                    expenditure:
                      fixed:
                        predicted_monthly:
                          value: '1000.00'
                          currency: GBP
                        _links:
                          transactions: '/v1/affordability/transactions?criteria=fixed_expenditure'
                      flexible:
                        predicted_monthly_range:
                          low:
                            value: '10.00'
                            currency: GBP
                          high:
                            value: '100.00'
                            currency: GBP
                          average:
                            value: '56.00'
                            currency: GBP
                        _links:
                          transactions: '/v1/affordability/transactions?criteria=flexible_expenditure'
                      essential:
                        predicted_monthly:
                          value: '500.00'
                          currency: GBP
                        _links:
                          transactions: '/v1/affordability/transactions?criteria=essential_expenditure'
                      non_essential:
                        predicted_monthly:
                          value: '80.00'
                          currency: GBP
                        _links:
                          transactions: '/v1/affordability/transactions?criteria=non_essential_expenditure'
        400:
          description: 'The request contains an invalid payload'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/affordability/transactions:
    get:
      tags:
        - 'Affordability Report'
      summary: 'Affordability Transactions'
      description: 'View the transactions that were used to calculate a customer''s affordability report.'
      operationId: v1_affordability_transactions
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/DateFrom'
        -
          $ref: 'components.yaml#/parameters/DateTo'
        -
          $ref: 'components.yaml#/parameters/Criteria'
      responses:
        200:
          description: 'The request was successfully processed'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/SpendingGroupsTransactionsResponse'
              example:
                operation_id: v1_affordability_transactions_get
                data:
                  -
                    transaction_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                    account_id: fdcc55c6-f347-4abc-8c66-61ff290d8bd4
                    description: Bud
                    date: '2012-05-30'
                    indicator: Credit
                    amount:
                      amount: '1500.00'
                      currency: GBP
                    categories:
                      l1: finances
                      l2: income
                    criteria_satisfied:
                      - net_disposable_income
        400:
          description: 'The request contains an invalid payload'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/kyc/check/company:
    post:
      tags:
        - 'Perform KYC Check'
      summary: 'Initiate Company Check'
      description: 'Initiate a task to perform a check against a company.'
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
      operationId: v1_kyc_check_company_post
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/CheckCompanyRequest'
            example:
              company:
                description: 'Bud Financial Limited'
                name: 'Bud financial'
                phone:
                  number: '4407492429214'
                  type: mobile
                registered:
                  country: GB
                  county: 'Greater London'
                  line_five: null
                  line_four: null
                  line_six: null
                  line_three: 'Ground floor'
                  name_number: 25B
                  postcode: E29DG
                  state: 'United Kingdom'
                  street: 'Vyner Street'
                  town: London
                registration_number: '09651629'
                tax_number: '9651629'
                trading:
                  country: GB
                  county: 'Greater London'
                  line_five: null
                  line_four: null
                  line_six: null
                  line_three: 'Ground floor'
                  name_number: 25B
                  postcode: E29DG
                  state: 'United Kingdom'
                  street: 'Vyner Street'
                  town: London
                type: Ltd
                vat_number: GB243609761
                website: thisisbud.com
              contacts:
                -
                  bank_account:
                    account_number: '31926819'
                    sort_code: '123456'
                  current_address:
                    country: GB
                    county: 'Greater London'
                    line_five: null
                    line_four: null
                    line_six: null
                    line_three: 'Ground floor'
                    name_number: 25B
                    postcode: E29DG
                    state: 'United Kingdom'
                    street: 'Vyner Street'
                    town: London
                  date_of_birth: '1984-12-26'
                  email_address:
                    - test@thisisbud.com
                  first_name: John
                  gender: male
                  identification_details:
                    -
                      issuing_country: GB
                      number: P4312345
                      type: passport
                  last_name: Doh
                  middle_name: Paul
                  phone:
                    -
                      number: '07939225566'
                      type: mobile
                  previous_address:
                    -
                      country: GB
                      county: 'Greater London'
                      line_five: null
                      line_four: null
                      line_six: null
                      line_three: 'Ground floor'
                      name_number: 25B
                      postcode: E29DG
                      state: 'United Kingdom'
                      street: 'Vyner Street'
                      town: London
                  title: mr
              custom_data:
                -
                  key: my-user-id
                  value: '123'
              header:
                profile_uuid: cee4baf2-09a7-4185-bce1-d35236d93e0b
                transaction_reference: cos-1
      responses:
        201:
          description: 'The company check has been initiated.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/CheckResponseCheckId'
              example:
                operation_id: v1_kyc_check_company_post
                data:
                  check_uuid: 264e05261ac411d66fd597763baf63142e2894810495788bc5dedcb5fbabcdef
        400:
          description: 'The request contains an invalid payload.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadKycRequestResponse'
              example:
                operation_id: v1_kyc_check_company_post
                error:
                  timestamp: '2021-01-08T12:19:33.331'
                  status: 400
                  error: 'Bad Request'
                  path: /v3/check/company
                  errorDetail:
                    -
                      field: company
                      message: 'must not be null'
        405:
          description: 'The request uses an unexpected HTTP method.'
        5XX:
          description: 'An unexpected error occurred on the server side.'
  /v1/kyc/check/person:
    post:
      tags:
        - 'Perform KYC Check'
      summary: 'Initiate Person Check'
      description: 'Initiate a task to perform a check against a person.'
      operationId: v1_kyc_check_person_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/CheckPersonRequest'
            example:
              person:
                bank_account:
                  account_number: '31926819'
                  sort_code: '123456'
                current_address:
                  country: GB
                  county: 'Greater London'
                  line_five: null
                  line_four: null
                  line_six: null
                  line_three: 'Ground floor'
                  name_number: 25B
                  postcode: E29DG
                  state: 'United Kingdom'
                  street: 'Vyner Street'
                  town: London
                date_of_birth: '1984-12-26'
                email_address:
                  - test@thisisbud.com
                first_name: John
                gender: male
                identification_details:
                  -
                    issuing_country: GB
                    number: P4312345
                    type: passport
                last_name: Doh
                middle_name: Paul
                phone:
                  -
                    number: '07939225566'
                    type: mobile
                previous_address:
                  -
                    country: GB
                    county: 'Greater London'
                    line_five: null
                    line_four: null
                    line_six: null
                    line_three: 'Ground floor'
                    name_number: 25B
                    postcode: E29DG
                    state: 'United Kingdom'
                    street: 'Vyner Street'
                    town: London
                title: mr
              custom_data:
                -
                  key: my-user-id
                  value: '123'
              header:
                profile_uuid: cee4baf2-09a7-4185-bce1-d35236d93e0b
                transaction_reference: ppl-38
      responses:
        201:
          description: 'The person check has been initiated.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/CheckResponseCheckId'
              example:
                operation_id: v1_kyc_check_person_post
                data:
                  check_uuid: 264e05261ac411d66fd597763baf63142e2894810495788bc5dedcb5fbabcdef
        400:
          description: 'The request contains an invalid payload.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadKycRequestResponse'
              example:
                operation_id: v1_kyc_check_person_post
                error:
                  timestamp: '2021-01-08T12:19:33.331'
                  status: 400
                  error: 'Bad Request'
                  path: /v3/check/person
                  errorDetail:
                    -
                      field: person
                      message: 'must not be null'
        405:
          description: 'The request uses an unexpected HTTP method.'
        5XX:
          description: 'An unexpected error occurred on the server side.'
  '/v1/kyc/check/{check_uuid}':
    get:
      tags:
        - 'Perform KYC Check'
      summary: 'Retrieve KYC Check'
      description: 'Return a summary for a check.'
      operationId: v1_kyc_check_status_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          name: check_uuid
          in: path
          description: checkUuid
          required: true
          schema:
            type: string
      responses:
        200:
          description: 'The company check has been initiated.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/CheckStatusResponse'
              examples:
                Green:
                  value:
                    operation_id: v1_kyc_check_status_get
                    data:
                      alerts:
                        -
                          category: company
                          crid: '1069'
                          message: 'Company postcode does not match registered company postcode'
                          score: 50
                          type: alert
                      category: company
                      center_location: string
                      client_name: ''
                      company_name: Bud
                      date: '2021-01-14 14:17:35'
                      document_count: 0
                      org_uid: 3737f60f-d009-4dcc-bee2-d35236d93e0b
                      profile:
                        name: 'Bud 2+2'
                        uuid: cee4baf2-09a7-4185-bce1-d35236d93e0b
                      rag: green
                      score: 50
                      status: live
                      suspicious: false
                      transaction_reference: cos-1
                      user: budwebservicetest
                      uuid: 31d952f1871666fc0597fb4901378ecb7fb6f413c8ff0df0f0b2a90b9c24fa8d
                Amber:
                  value:
                    operation_id: v1_kyc_check_status_get
                    data:
                      alerts:
                        -
                          category: company
                          crid: '1069'
                          message: 'Company not found on Companies Register for selected country'
                          score: 100
                          type: alert
                        -
                          type: alert
                          crid: '1599'
                          message: 'Company Status is Administration'
                          score: 100
                      category: company
                      center_location: string
                      client_name: ''
                      company_name: Bud
                      date: '2021-01-14 14:17:35'
                      document_count: 0
                      org_uid: 3737f60f-d009-4dcc-bee2-d35236d93e0b
                      profile:
                        name: 'Bud 2+2'
                        uuid: cee4baf2-09a7-4185-bce1-d35236d93e0b
                      rag: amber
                      score: 100
                      status: live
                      suspicious: false
                      transaction_reference: cos-3
                      user: budwebservicetest
                      uuid: 31d952f1871666fc0597fb4901378ecb7fb6f413c8ff0df0f0b2a90b9c24fa8d
                Red:
                  value:
                    operation_id: v1_kyc_check_status_get
                    data:
                      alerts:
                        -
                          type: alert
                          crid: '1599'
                          message: 'Company Status is Administration'
                          score: 100
                      category: company
                      center_location: string
                      client_name: ''
                      company_name: Bud
                      date: '2021-01-14 14:17:35'
                      document_count: 0
                      org_uid: 3737f60f-d009-4dcc-bee2-d35236d93e0b
                      profile:
                        name: 'Bud 2+2'
                        uuid: cee4baf2-09a7-4185-bce1-d35236d93e0b
                      rag: red
                      score: 100
                      status: live
                      suspicious: false
                      transaction_reference: cos-3
                      user: budwebservicetest
                      uuid: 31d952f1871666fc0597fb4901378ecb7fb6f413c8ff0df0f0b2a90b9c24fa8d
                Error:
                  value:
                    operation_id: v1_kyc_check_status_get
                    data:
                      uuid: 1621fbc8e76aae853606545dc6a05fbd578d9d50760445a12a9a5a57f376038d
                      error_messages:
                        - 'Wrong Credentials. ProfileId and OrganisationId do not match.'
        404:
          description: 'The resource was not found.'
        405:
          description: 'The request uses an unexpected HTTP method.'
        5XX:
          description: 'An unexpected error occurred on the server side.'
  /v1/payments/providers:
    get:
      tags:
        - 'Initiate Payment - TPP'
        - 'Initiate Payment - TSP'
      summary: 'List Providers'
      description: 'This endpoint is used list the payment service providers (PSPs) supported via Bud''s Payment APIs.'
      operationId: v1_payments_providers_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/PaymentProviderRegionFilter'
        -
          $ref: 'components.yaml#/parameters/PaymentProviderServiceFilter'
        -
          $ref: 'components.yaml#/parameters/PaymentProviderTypeFilter'
      responses:
        200:
          description: 'Successful request'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/PaymentProvidersResponse'
              example:
                operation_id: v1_payments_providers_get
                data:
                  -
                    provider: barclays
                    display_name: Barclays
                    icon: 'https://www.thisisbud.com/provider/resource/#1'
                    services:
                      - domestic-single-payment
                      - domestic-standing-order
                      - domestic-scheduled-payment
                    maintenance_status: active
                    maintenance_window:
                      start: '2019-08-07T11:48:00+0000'
                      end: '2019-08-07T11:00:00+0000'
                    country_code: GBR
                    implementation_type: OpenbankingUK
                    supported_currencies:
                      - GBP
                    required_actions:
                      - confirm_single_payment
                      - confirm_standing_order
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/payments/single/bud-pay-url:
    post:
      tags:
        - 'Initiate Payment - TPP'
      summary: 'Retrieve Bud Pay URL - Single Payment'
      description: 'Retrieve a Bud Pay URL to initiate a single payment. Please note that this endpoint should be used if you are using Bud as a Third Party Provider (TPP), i.e. you are not yourself regulated as an Payment Initiation Service Provider (PISP)'
      operationId: v1_payments_single_bud_pay_url_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/PaymentsSingleBudPayURLRequest'
            examples:
              'Bud Pay URL UK':
                value:
                  redirect_url: 'https://client-redirect-url/example'
                  provider: natwest
                  provider_types:
                    - retail
                  payment_details:
                    reference: 'PAYMENT REFERENCE'
                    recipient:
                      type: SortCodeAccountNumber
                      name: 'MR TEST RECIPIENT'
                      account_number: '01234501234567'
                    sender:
                      user_id: client-defined-user-id
                      name: 'Mr TEST SENDER'
                    amount:
                      value: '2.50'
                      currency: GBP
              'Bud Pay URL Europe':
                value:
                  redirect_url: 'https://client-redirect-url/foo'
                  provider: commerzbank
                  payment_details:
                    reference: 'REFERENCE FOR PAYMENT'
                    recipient:
                      type: IBAN
                      name: 'MR TEST RECIPIENT'
                      account_number: DE40100100103307118603
                    sender:
                      user_id: client-defined-user-id
                      name: 'Mr TEST SENDER'
                      type: IBAN
                      account_number: DE50100100103307118608
                    amount:
                      value: '2.50'
                      currency: EUR
      responses:
        200:
          description: 'Successful request'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BudPayResponse'
              example:
                operation_id: v1_payments_single_bud_pay_url_post
                data:
                  bud_pay_url: 'https://www.thisisbud.com/v1/payment/bud-pay'
                  payment_id: 56caec01-85cc-4fc6-8080-cc0f7ed03a7e
        400:
          description: 'The request contains an invalid payload and/or header'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_payments_single_bud_pay_url_post
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  redirect_url: 'This value should not be blank'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
      callbacks:
        payment-event:
          '{$request.body#/endpoint}':
            description: |
              This callback is sent to your configured Payment Status Updates webhook URL once a payment task has been successfully completed.
            post:
              parameters:
                -
                  $ref: 'components.yaml#/parameters/SignatureHeaderParameter'
                -
                  $ref: 'components.yaml#/parameters/SigningIdHeaderParameter'
              summary: 'Payment Update Notification Callback'
              requestBody:
                content:
                  application/json:
                    schema:
                      $ref: 'components.yaml#/schemas/PaymentStatusUpdatedNotificationBody'
                    example:
                      data:
                        payment_id: c8c934f0-366c-4656-a686-ada2aacd0d9f
                        service: domestic-single-payment
                        user_id: client-defined-user-id
                        event: payment.success
              responses:
                200:
                  description: 'Your server returns this code if it accepts the callback'
                300:
                  description: 'The notification will not be retried, redirects will not be followed'
                400:
                  description: 'The notification will not be retried'
                500:
                  description: |
                    The request will be retried shortly. If it fails multiple times, we will stop attempting to deliver the notification for this single event.
  /v1/payments/standing-order/bud-pay-url:
    post:
      tags:
        - 'Initiate Payment - TPP'
      summary: 'Retrieve Bud Pay URL - Standing Order'
      description: 'Retrieve a Bud Pay URL to initiate a Standing Order. Please note that this endpoint should be used if you are using Bud as a Third Party Provider (TPP), i.e. you are not yourself regulated as an Payment Initiation Service Provider (PISP)'
      operationId: v1_payments_standing_order_bud_pay_url_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/CreateStandingOrderRequest'
            example:
              redirect_url: 'https://client-redirect-url/example'
              provider_types:
                - retail
              provider: BankOfBudOBUK
              standing_order_details:
                reference: 'PAYMENT REFERENCE'
                recipient:
                  type: SortCodeAccountNumber
                  name: 'MR TEST RECIPIENT'
                  account_number: '01234501234567'
                sender:
                  user_id: client-defined-user-id
                  name: 'MR TEST SENDER'
                recurring_amount:
                  value: '2.50'
                  currency: GBP
                first_payment_date: '2023-02-10'
                last_payment_date: '2023-02-10'
                frequency: monthly
      responses:
        200:
          description: 'Successful request'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BudPayResponse'
              example:
                operation_id: v1_payments_standing_order_bud_pay_url_post
                data:
                  bud_pay_url: 'https://www.thisisbud.com/v1/payment/bud-pay'
                  payment_id: 56caec01-85cc-4fc6-8080-cc0f7ed03a7e
        400:
          description: 'The request contains an invalid payload and/or header'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_payments_standing_order_bud_pay_url_post
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  redirect_url: 'This value should not be blank'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
      callbacks:
        payment-event:
          '{$request.body#/endpoint}':
            description: |
              This callback is sent to your configured Payment Status Updates webhook URL once a payment task has been successfully completed.
            post:
              parameters:
                -
                  $ref: 'components.yaml#/parameters/SignatureHeaderParameter'
                -
                  $ref: 'components.yaml#/parameters/SigningIdHeaderParameter'
              summary: 'Payment Update Notification Callback'
              requestBody:
                content:
                  application/json:
                    schema:
                      $ref: 'components.yaml#/schemas/PaymentStatusUpdatedNotificationBody'
                    example:
                      data:
                        payment_id: c8c934f0-366c-4656-a686-ada2aacd0d9f
                        service: domestic-standing-order
                        user_id: client-defined-user-id
                        event: payment.success
              responses:
                200:
                  description: 'Your server returns this code if it accepts the callback'
                300:
                  description: 'The notification will not be retried, redirects will not be followed'
                400:
                  description: 'The notification will not be retried'
                500:
                  description: |
                    The request will be retried shortly. If it fails multiple times, we will stop attempting to deliver the notification for this single event.
  /v1/payments/scheduled/bud-pay-url:
    post:
      tags:
        - 'Initiate Payment - TPP'
      summary: 'Retrieve Bud Pay URL - Scheduled Payment'
      description: 'Retrieve a Bud Pay URL to initiate a Scheduled Payment. Please note that this endpoint should be used if you are using Bud as a Third Party Provider (TPP), i.e. you are not yourself regulated as an Payment Initiation Service Provider (PISP)'
      operationId: v1_payments_scheduled_bud_pay_url_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/CreateScheduledPaymentRequest'
            example:
              redirect_url: 'https://client-redirect-url/example'
              provider: natwest
              provider_types:
                - retail
              scheduled_payment_details:
                reference: 'PAYMENT REFERENCE'
                recipient:
                  type: SortCodeAccountNumber
                  name: 'MR TEST RECIPIENT'
                  account_number: '01234501234567'
                sender:
                  user_id: client-defined-user-id
                  name: 'MR TEST SENDER'
                amount:
                  value: '2.50'
                  currency: GBP
                requested_execution_date: '2023-01-20'
      responses:
        200:
          description: 'Successful request'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BudPayResponse'
              example:
                operation_id: v1_payments_scheduled_bud_pay_url_post
                data:
                  bud_pay_url: 'https://www.thisisbud.com/v1/payment/bud-pay'
                  payment_id: 56caec01-85cc-4fc6-8080-cc0f7ed03a7e
        400:
          description: 'The request contains an invalid payload and/or header'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_payments_scheduled_bud_pay_url_post
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  redirect_url: 'This value should not be blank'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
      callbacks:
        payment-event:
          '{$request.body#/endpoint}':
            description: |
              This callback is sent to your configured Payment Status Updates webhook URL once a payment task has been successfully completed.
            post:
              parameters:
                -
                  $ref: 'components.yaml#/parameters/SignatureHeaderParameter'
                -
                  $ref: 'components.yaml#/parameters/SigningIdHeaderParameter'
              summary: 'Payment Update Notification Callback'
              requestBody:
                content:
                  application/json:
                    schema:
                      $ref: 'components.yaml#/schemas/PaymentStatusUpdatedNotificationBody'
                    example:
                      data:
                        payment_id: c8c934f0-366c-4656-a686-ada2aacd0d9f
                        service: domestic-scheduled-payment
                        user_id: client-defined-user-id
                        event: payment.success
              responses:
                200:
                  description: 'Your server returns this code if it accepts the callback'
                300:
                  description: 'The notification will not be retried, redirects will not be followed'
                400:
                  description: 'The notification will not be retried'
                500:
                  description: |
                    The request will be retried shortly. If it fails multiple times, we will stop attempting to deliver the notification for this single event.
  /v1/payments/single:
    post:
      tags:
        - 'Initiate Payment - TSP'
      summary: 'Create Single Payment'
      description: 'Create a unique single payment identifier and retrieve the authorisation url for the specific payment provider. Please note that this endpoint can only be used in the event that you are using Bud as a Technical Service Provider (TSP), i.e. you must have be regulated as an Payment Initiation Service Provider (PISP)'
      operationId: v1_payments_single_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/SinglePaymentRequest'
            examples:
              'Create Payment UK':
                value:
                  redirect_url: 'https://your-app.com/connected?my-parameter=xyz'
                  provider: lloyds
                  payment_details:
                    reference: 'PAYMENT REFERENCE'
                    recipient:
                      type: SortCodeAccountNumber
                      name: 'MR TEST RECIPIENT'
                      account_number: '01234501234567'
                    sender:
                      user_id: client-defined-user-id
                      name: 'MR TEST SENDER'
                    amount:
                      value: '2.50'
                      currency: GBP
              'Create Payment Europe':
                value:
                  redirect_url: 'https://your-app.com/connected?my-parameter=xyz'
                  provider: commerzbank
                  payment_details:
                    reference: 'PAYMENT REFERENCE'
                    recipient:
                      type: IBAN
                      name: 'MR TEST RECIPIENT'
                      account_number: DE40100100103307118605
                    sender:
                      user_id: client-defined-user-id
                      type: IBAN
                      name: 'MR TEST SENDER'
                      account_number: DE02100100109307118608
                    amount:
                      value: '2.50'
                      currency: EUR
      responses:
        200:
          description: 'Successful request'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/SinglePaymentResponse'
              example:
                operation_id: v1_payments_single_post
                data:
                  payment_id: 56caec01-85cc-4fc6-8080-cc0f7ed03a7e
                  authorisation_url: 'https://www.thisisbud.com/provider/specific/redirect/url'
                  required_action: confirm_single_payment
        400:
          description: 'The request contains an invalid payload and/or header'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_payments_single_post
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  recipient.sort_code: 'Sort code must match `^\d{6}$`'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
    get:
      tags:
        - 'Manage Payments'
      summary: 'List Single Payments'
      description: 'Retrieve and view the status of multiple payments'
      operationId: v1_payment_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/PaymentIdHeader'
        -
          $ref: 'components.yaml#/parameters/PageNumber'
        -
          $ref: 'components.yaml#/parameters/PaymentSenderProviders'
        -
          $ref: 'components.yaml#/parameters/PaymentStatusCodes'
        -
          $ref: 'components.yaml#/parameters/PaymentDateFrom'
        -
          $ref: 'components.yaml#/parameters/PaymentDateTo'
        -
          $ref: 'components.yaml#/parameters/PaymentAmountFrom'
        -
          $ref: 'components.yaml#/parameters/PaymentAmountTo'
      responses:
        200:
          description: 'Successful request'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/ListSinglePaymentResponse'
              examples:
                'Payment Status List UK':
                  value:
                    operation_id: v1_payment_get
                    data:
                      -
                        payment_id: 89f80199-1199-400e-9092-17208f6f39f5
                        organisation_id: 22f80199-1199-400e-9092-17208f6f39f0
                        client_id: 22f80199-1199-400e-9092-17208f6f39f0
                        method: FPS
                        reference: Rent
                        recipient:
                          type: SortCodeAccountNumber
                          name: 'MR TEST RECIPIENT'
                          account_number: '01234501234567'
                        amount:
                          value: '10.00'
                          currency: GBP
                        sender:
                          user_id: client-defined-user-id
                          name: 'MR RANDOM SENDER'
                          provider: Natwest
                        known_charges:
                          recipient_charge:
                            charge: '1.50'
                            currency: GBP
                            recipient_receives: '7.00'
                          sender_charge:
                            charge: '1.50'
                            currency: GBP
                            bank_sends: '10.00'
                            total_cost: '11.50'
                        state:
                          status_code: SETTLED
                          status_message: 'Payment Settlement Complete'
                          history:
                            -
                              datetime: '2020-02-02T12:29:33.428944815Z'
                              code: CREATED
                              message: 'Payment created'
                            -
                              datetime: '2020-02-02T12:29:33.428944815Z'
                              code: AWAITING_AUTH
                              message: 'Awaiting Authentication'
                            -
                              datetime: '2020-02-02T12:29:33.428944815Z'
                              code: AUTHENTICATED
                              message: 'Authenticated; Confirming Funds'
                            -
                              datetime: '2020-02-02T12:29:33.428944815Z'
                              code: FUNDS_CONFIRMED
                              message: 'Funds Confirmed; Awaiting Payment Initiation'
                            -
                              datetime: '2020-02-02T12:29:33.428944815Z'
                              code: INITIATING
                              message: 'Initiating Payment'
                            -
                              datetime: '2020-02-02T12:29:33.428944815Z'
                              code: ACCEPTED
                              message: 'Payment Order Accepted'
                            -
                              datetime: '2020-02-02T12:29:33.428944815Z'
                              code: SETTLED
                              message: 'Payment Settlement Complete'
                        supplementary_status:
                          payment_order:
                            status: AcceptedSettlementInProgress
                            history:
                              -
                                datetime: '2020-02-02T12:29:37.628944815Z'
                                status: Pending
                              -
                                datetime: '2020-02-02T12:29:38.628944815Z'
                                status: AcceptedSettlementInProgress
                          consent:
                            status: Authorised
                            history:
                              -
                                datetime: '2020-02-02T12:29:34.828944815Z'
                                status: AwaitingAuthorisation
                              -
                                datetime: '2020-02-02T12:29:35.028944815Z'
                                status: Authorised
                          confirmation_of_funds:
                            status: Available
                            history:
                              -
                                datetime: '2020-02-02T12:29:35.028944815Z'
                                status: Available
                        required_action: null
                        errors:
                          -
                            code: FAILED_FUNDS_CONFIRMATION
                            description: 'The call to the provider to confirm funds returned an error'
                        created_at: '2020-02-02T12:29:33.428944815Z'
                    metadata:
                      total_results: 1000000
                      results: 10
                      page: 1
                      total_pages: 100000
                'Payment Status List Europe':
                  value:
                    operation_id: v1_payment_get
                    data:
                      -
                        payment_id: 89f80199-1199-400e-9092-17208f6f39f5
                        organisation_id: 22f80199-1199-400e-9092-17208f6f39f0
                        client_id: 22f80199-1199-400e-9092-17208f6f39f0
                        method: SEPA
                        reference: Rent
                        recipient:
                          type: IBAN
                          name: 'MR TEST RECIPIENT'
                          account_number: DE40100100103307118605
                        amount:
                          value: '10.00'
                          currency: EUR
                        sender:
                          user_id: client-defined-user-id
                          type: IBAN
                          name: 'MR RANDOM SENDER'
                          account_number: DE02100100109307118606
                          provider: commerzbank
                        known_charges:
                          recipient_charge:
                            charge: '1.50'
                            currency: EUR
                            recipient_receives: '7.00'
                          sender_charge:
                            charge: '1.50'
                            currency: EUR
                            bank_sends: '10.00'
                            total_cost: '11.50'
                        state:
                          status_code: SETTLED
                          status_message: 'Payment Settlement Complete'
                          history:
                            -
                              datetime: '2020-02-02T12:29:33.428944815Z'
                              code: CREATED
                              message: 'Payment created'
                            -
                              datetime: '2020-02-02T12:29:33.428944815Z'
                              code: AWAITING_AUTH
                              message: 'Awaiting Authentication'
                            -
                              datetime: '2020-02-02T12:29:33.428944815Z'
                              code: AUTHENTICATED
                              message: 'Authenticated; Confirming Funds'
                            -
                              datetime: '2020-02-02T12:29:33.428944815Z'
                              code: FUNDS_CONFIRMED
                              message: 'Funds Confirmed; Awaiting Payment Initiation'
                            -
                              datetime: '2020-02-02T12:29:33.428944815Z'
                              code: INITIATING
                              message: 'Initiating Payment'
                            -
                              datetime: '2020-02-02T12:29:33.428944815Z'
                              code: ACCEPTED
                              message: 'Payment Order Accepted'
                            -
                              datetime: '2020-02-02T12:29:33.428944815Z'
                              code: SETTLED
                              message: 'Payment Settlement Complete'
                        supplementary_status:
                          payment_order:
                            status: AcceptedSettlementInProgress
                            history:
                              -
                                datetime: '2020-02-02T12:29:37.628944815Z'
                                status: Pending
                              -
                                datetime: '2020-02-02T12:29:38.628944815Z'
                                status: AcceptedSettlementInProgress
                          consent:
                            status: Authorised
                            history:
                              -
                                datetime: '2020-02-02T12:29:34.828944815Z'
                                status: AwaitingAuthorisation
                              -
                                datetime: '2020-02-02T12:29:35.028944815Z'
                                status: Authorised
                          confirmation_of_funds:
                            status: Available
                            history:
                              -
                                datetime: '2020-02-02T12:29:35.028944815Z'
                                status: Available
                        required_action: null
                        errors:
                          -
                            code: FAILED_FUNDS_CONFIRMATION
                            description: 'The call to the provider to confirm funds returned an error'
                        created_at: '2020-02-02T12:29:33.428944815Z'
                    metadata:
                      total_results: 1000000
                      results: 10
                      page: 1
                      total_pages: 100000
        404:
          description: 'Resource not found'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_payments_payment_id_get
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  payment_id: 'Value not found'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/payments/authorisation-codes:
    post:
      tags:
        - 'Initiate Payment - TSP'
      summary: 'Submit Authorisation Codes'
      description: |
        When using Bud as a TSP (Technical Service Provider) and doing full app-to-app authorisation, the customer is returned from the provider directly back to your app. Your app will then need to send all the query and hash fragment parameters to Bud so that we can continue with the payment flow.

        Query and fragment parameters should be merged with query taking precedence. If you receive a request /path?a=1#a=2&b=3 then you should perform this request with {"a":"1","b":"3"}.

        Regardless of what parameters are present, all of them should be sent to Bud so that we can choose to either continue the connection or to map and record the error.

        State, Code and error are the most common parameters you will see, but this object may contain any number of unspecified properties. Currently state is a common property among all authorisation flows and is the current task ID. The state property is not guaranteed for the future of this API contract and will not be treated as backwards incompatible if a new authentication flow does not use it.
      operationId: v1_payments_authorisation_codes_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/AuthorisationCodesRequest'
            examples:
              Success:
                value:
                  state: e017bd1c-9b39-40cc-b9ec-e21fce26719e
                  code: 803A940E-2416-4A34-BF5F-4AC8C9977AC4
              Error:
                value:
                  state: e017bd1c-9b39-40cc-b9ec-e21fce26719e
                  error: access_denied
      responses:
        200:
          description: 'Successful request.'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/PaymentsAuthorisationCodesResponse'
              example:
                operation_id: v1_payments_authorisation_codes_post
                data:
                  result: success
                  payment_id: 5edb14fe-ab4b-4357-ae15-98765c599fb5
                  payment_type: single
        400:
          description: 'Request contained invalid/missing data'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/PaymentsErrorResponse'
              example:
                operation_id: v1_payments_authorisation_codes_post
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  payment: 'unable to find payment for [Payment ID]'
        500:
          description: 'An internal server error has occurred'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/PaymentsErrorResponse'
              example:
                operation_id: v1_payments_authorisation_codes_post
                code_id: internal_error
                message: 'Internal server error has occurred'
                errors:
                  db: 'could not fetch payment resource'
  '/v1/payments/single/{payment_id}/confirm':
    post:
      tags:
        - 'Initiate Payment - TSP'
      summary: 'Confirm Single Payment'
      description: 'Confirm and execute payment order for a specific payment.'
      operationId: v1_payments_single_confirm_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/PaymentId'
        -
          $ref: 'components.yaml#/parameters/ClientId'
      responses:
        201:
          description: 'Payment order created successfully'
          content:
            application/json:
              example:
                operation_id: v1_payments_single_confirm_post
        400:
          description: 'Not allowed to confirm payment. Either there is no consent, not authorised or the payment order has already been created'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_payments_single_confirm_post
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  payment: 'Payment initiation failed'
        401:
          description: 'Unauthorised request'
        404:
          description: 'Resource not found'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_payments_single_confirm_post
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  payment_id: 'Value not found'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  '/v1/payments/single/{payment_id}':
    get:
      tags:
        - 'Manage Payments'
      summary: 'Retrieve Single Payment Status'
      description: 'Retrieve and view the status of a payment'
      operationId: v1_payments_single_payment_id_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/PaymentId'
        -
          $ref: 'components.yaml#/parameters/ClientId'
      responses:
        200:
          description: 'Successful request'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/StatusSinglePaymentResponse'
              examples:
                'Payment Status UK':
                  value:
                    operation_id: v1_payments_single_payment_id_get
                    data:
                      payment_id: 89f80199-1199-400e-9092-17208f6f39f5
                      organisation_id: 22f80199-1199-400e-9092-17208f6f39f0
                      client_id: 22f80199-1199-400e-9092-17208f6f39f0
                      method: FPS
                      reference: Rent
                      recipient:
                        type: SortCodeAccountNumber
                        name: 'MR TEST RECIPIENT'
                        account_number: '01234501234567'
                      amount:
                        value: '10.00'
                        currency: GBP
                      sender:
                        user_id: client-defined-user-id
                        name: 'MR TEST SENDER'
                        provider: Natwest
                      known_charges:
                        recipient_charge:
                          charge: '1.50'
                          currency: GBP
                          recipient_receives: '7.00'
                        sender_charge:
                          charge: '1.50'
                          currency: GBP
                          bank_sends: '10.00'
                          total_cost: '11.50'
                      state:
                        status_code: SETTLED
                        status_message: 'Payment Settlement Complete'
                        history:
                          -
                            datetime: '2020-02-02T12:29:33.428944815Z'
                            code: CREATED
                            message: 'Payment created'
                          -
                            datetime: '2020-02-02T12:29:33.428944815Z'
                            code: AWAITING_AUTH
                            message: 'Awaiting Authentication'
                          -
                            datetime: '2020-02-02T12:29:33.428944815Z'
                            code: AUTHENTICATED
                            message: 'Authenticated; Confirming Funds'
                          -
                            datetime: '2020-02-02T12:29:33.428944815Z'
                            code: FUNDS_CONFIRMED
                            message: 'Funds Confirmed; Awaiting Payment Initiation'
                          -
                            datetime: '2020-02-02T12:29:33.428944815Z'
                            code: INITIATING
                            message: 'Initiating Payment'
                          -
                            datetime: '2020-02-02T12:29:33.428944815Z'
                            code: ACCEPTED
                            message: 'Payment Order Accepted'
                          -
                            datetime: '2020-02-02T12:29:33.428944815Z'
                            code: SETTLED
                            message: 'Payment Settlement Complete'
                      supplementary_status:
                        payment_order:
                          status: AcceptedSettlementInProgress
                          history:
                            -
                              datetime: '2020-02-02T12:29:37.628944815Z'
                              status: Pending
                            -
                              datetime: '2020-02-02T12:29:38.628944815Z'
                              status: AcceptedSettlementInProgress
                        consent:
                          status: Authorised
                          history:
                            -
                              datetime: '2020-02-02T12:29:34.828944815Z'
                              status: AwaitingAuthorisation
                            -
                              datetime: '2020-02-02T12:29:35.028944815Z'
                              status: Authorised
                        confirmation_of_funds:
                          status: Available
                          history:
                            -
                              datetime: '2020-02-02T12:29:35.028944815Z'
                              status: Available
                      required_action: null
                      errors:
                        -
                          code: FAILED_FUNDS_CONFIRMATION
                          description: 'The call to the provider to confirm funds returned an error'
                      created_at: '2020-02-02T12:29:33.428944815Z'
                    metadata: []
                'Payment Status Europe':
                  value:
                    operation_id: v1_payments_single_payment_id_get
                    data:
                      payment_id: 89f80199-1199-400e-9092-17208f6f39f5
                      organisation_id: 22f80199-1199-400e-9092-17208f6f39f0
                      client_id: 22f80199-1199-400e-9092-17208f6f39f0
                      method: SEPA
                      reference: Rent
                      recipient:
                        type: IBAN
                        name: 'MR TEST RECIPIENT'
                        account_number: DE40100100103307118609
                      amount:
                        value: '10.00'
                        currency: EUR
                      sender:
                        user_id: client-defined-user-id
                        type: IBAN
                        name: 'MR TEST SENDER'
                        account_number: DE02100100109307118606
                        provider: commerzbank
                      known_charges:
                        recipient_charge:
                          charge: '1.50'
                          currency: EUR
                          recipient_receives: '7.00'
                        sender_charge:
                          charge: '1.50'
                          currency: EUR
                          bank_sends: '10.00'
                          total_cost: '11.50'
                      state:
                        status_code: SETTLED
                        status_message: 'Payment Settlement Complete'
                        history:
                          -
                            datetime: '2020-02-02T12:29:33.428944815Z'
                            code: CREATED
                            message: 'Payment created'
                          -
                            datetime: '2020-02-02T12:29:33.428944815Z'
                            code: AWAITING_AUTH
                            message: 'Awaiting Authentication'
                          -
                            datetime: '2020-02-02T12:29:33.428944815Z'
                            code: AUTHENTICATED
                            message: 'Authenticated; Confirming Funds'
                          -
                            datetime: '2020-02-02T12:29:33.428944815Z'
                            code: FUNDS_CONFIRMED
                            message: 'Funds Confirmed; Awaiting Payment Initiation'
                          -
                            datetime: '2020-02-02T12:29:33.428944815Z'
                            code: INITIATING
                            message: 'Initiating Payment'
                          -
                            datetime: '2020-02-02T12:29:33.428944815Z'
                            code: ACCEPTED
                            message: 'Payment Order Accepted'
                          -
                            datetime: '2020-02-02T12:29:33.428944815Z'
                            code: SETTLED
                            message: 'Payment Settlement Complete'
                      supplementary_status:
                        payment_order:
                          status: AcceptedSettlementInProgress
                          history:
                            -
                              datetime: '2020-02-02T12:29:37.628944815Z'
                              status: Pending
                            -
                              datetime: '2020-02-02T12:29:38.628944815Z'
                              status: AcceptedSettlementInProgress
                        consent:
                          status: Authorised
                          history:
                            -
                              datetime: '2020-02-02T12:29:34.828944815Z'
                              status: AwaitingAuthorisation
                            -
                              datetime: '2020-02-02T12:29:35.028944815Z'
                              status: Authorised
                        confirmation_of_funds:
                          status: Available
                          history:
                            -
                              datetime: '2020-02-02T12:29:35.028944815Z'
                              status: Available
                      required_action: null
                      errors:
                        -
                          code: FAILED_FUNDS_CONFIRMATION
                          description: 'The call to the provider to confirm funds returned an error'
                      created_at: '2020-02-02T12:29:33.428944815Z'
                    metadata: []
        404:
          description: 'Resource not found'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_payments_single_payment_id_get
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  payment_id: 'Value not found'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/payments/standing-order:
    post:
      tags:
        - 'Initiate Payment - TSP'
      summary: 'Create Standing Order'
      description: 'Create a new Standing Order payment identifier and retrieve the authorisation url for the specific payment provider. Please note that this endpoint can only be used in the event that you are using Bud as a Technical Service Provider (TSP), i.e. you must have be regulated as an Payment Initiation Service Provider (PISP)'
      operationId: v1_payments_standing_order_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/CreateStandingOrderRequest'
            example:
              redirect_url: 'https://your-app.com/connected?my-parameter=xyz'
              provider: lloyds
              standing_order_details:
                reference: 'PAYMENT REFERENCE'
                recipient:
                  type: SortCodeAccountNumber
                  name: 'MR TEST RECIPIENT'
                  account_number: '01234501234567'
                sender:
                  user_id: client-defined-user-id
                  name: 'MR TEST SENDER'
                recurring_amount:
                  value: '2.50'
                  currency: GBP
                first_payment_date: '2020-02-02T12:29:33.428944815Z'
                last_payment_date: '2021-02-02T12:29:33.428944815Z'
                frequency: monthly
      responses:
        200:
          description: 'Successful request'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/CreateStandingOrderResponse'
              example:
                operation_id: v1_payments_standing_order_post
                data:
                  authorisation_url: 'https://www.thisisbud.com/provider/specific/redirect/url'
                  payment_id: 56caec01-85cc-4fc6-8080-cc0f7ed03a7e
                  required_action: confirm_standing_order
        400:
          description: 'The request contains an invalid payload and/or header'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_payments_standing_order_post
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  recipient.sort_code: 'Sort code must match `^\d{6}$`'
                  standing_order_details.recipient.name: 'Name must not be empty'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
    get:
      tags:
        - 'Manage Payments'
      summary: 'List Standing Orders'
      description: 'Retrieve and view the status of multiple Standing Orders'
      operationId: v1_payments_standing_order_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/PaymentIdHeader'
        -
          $ref: 'components.yaml#/parameters/PageNumber'
        -
          $ref: 'components.yaml#/parameters/PaymentSenderProviders'
        -
          $ref: 'components.yaml#/parameters/PaymentStatusCodes'
        -
          $ref: 'components.yaml#/parameters/PaymentDateFrom'
        -
          $ref: 'components.yaml#/parameters/PaymentDateTo'
        -
          $ref: 'components.yaml#/parameters/PaymentAmountFrom'
        -
          $ref: 'components.yaml#/parameters/PaymentAmountTo'
      responses:
        200:
          description: 'Successful request'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/ListStandingOrderResponse'
              example:
                operation_id: v1_payments_standing_order_get
                data:
                  -
                    payment_id: 89f80199-1199-400e-9092-17208f6f39f5
                    organisation_id: 22f80199-1199-400e-9092-17208f6f39f0
                    client_id: 22f80199-1199-400e-9092-17208f6f39f0
                    reference: Rent
                    recipient:
                      type: SortCodeAccountNumber
                      name: 'MR TEST RECIPIENT'
                      account_number: '01234501234567'
                    recurring_amount:
                      value: '10.00'
                      currency: GBP
                    sender:
                      user_id: client-defined-user-id
                      name: 'MR RANDOM SENDER'
                      provider: Natwest
                    known_charges:
                      recipient_charge:
                        charge: '1.50'
                        currency: GBP
                        recipient_receives: '7.00'
                      sender_charge:
                        charge: '1.50'
                        currency: GBP
                        bank_sends: '10.00'
                        total_cost: '11.50'
                    state:
                      status_code: COMPLETED
                      status_message: 'Standing Order Creation Completed'
                      history:
                        -
                          datetime: '2020-02-02T12:29:33.428944815Z'
                          code: CREATED
                          message: 'Standing Order Created'
                        -
                          datetime: '2020-02-02T12:29:33.428944815Z'
                          code: AWAITING_AUTH
                          message: 'Awaiting Customer Authentication'
                        -
                          datetime: '2020-02-02T12:29:33.428944815Z'
                          code: AUTH_COMPLETED
                          message: 'Authentication Completed'
                        -
                          datetime: '2020-02-02T12:29:33.428944815Z'
                          code: PENDING
                          message: 'Payment Order Pending'
                        -
                          datetime: '2020-02-02T12:29:33.428944815Z'
                          code: COMPLETED
                          message: 'Standing Order Creation Completed'
                    errors:
                      -
                        code: FAILED
                        description: 'The call to the provider to confirm funds returned an error'
                    created_at: '2020-02-02T12:29:33.428944815Z'
                    first_payment_date: '2020-02-02T12:29:33.428944815Z'
                    last_payment_date: '2021-02-02T12:29:33.428944815Z'
                    frequency: monthly
                    required_action: null
                metadata:
                  total_results: 1000000
                  results: 10
                  page: 1
                  total_pages: 100000
        400:
          description: 'Resource not found'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_payments_standing_order_get
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  filter: 'X-Date-From is in the wrong format (expected 2006-01-02T15:04:05Z)'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  '/v1/payments/standing-order/{payment_id}/confirm':
    post:
      tags:
        - 'Initiate Payment - TSP'
      summary: 'Confirm Standing Order'
      description: 'Confirm and execute a Standing Order for a specific payment id.'
      operationId: v1_payments_standing_order_confirm_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/PaymentId'
        -
          $ref: 'components.yaml#/parameters/ClientId'
      responses:
        201:
          description: 'Standing order created successfully'
          content:
            application/json:
              example:
                operation_id: v1_payments_standing_order_confirm_post
        400:
          description: 'Not allowed to confirm payment. Either there is no consent, not authorised or the payment order has already been created'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_payments_standing_order_confirm_post
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  payment: 'Payment initiation failed'
        401:
          description: 'Unauthorised request'
        404:
          description: 'Resource not found'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_payments_standing_order_confirm_post
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  payment_id: 'Value not found'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  '/v1/payments/standing-order/{payment_id}':
    get:
      tags:
        - 'Manage Payments'
      summary: 'Retrieve Standing Order Payment Status'
      description: 'Retrieve and view the status of a specific Standing Order payment'
      operationId: v1_payments_standing_order_payment_id_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/PaymentId'
        -
          $ref: 'components.yaml#/parameters/ClientId'
      responses:
        200:
          description: 'Successful request'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/StatusStandingOrderResponse'
              example:
                operation_id: v1_payments_standing_order_payment_id_get
                data:
                  payment_id: 89f80199-1199-400e-9092-17208f6f39f5
                  organisation_id: 22f80199-1199-400e-9092-17208f6f39f0
                  client_id: 22f80199-1199-400e-9092-17208f6f39f0
                  method: FPS
                  reference: Rent
                  recipient:
                    type: SortCodeAccountNumber
                    name: 'MR TEST RECIPIENT'
                    account_number: '01234501234567'
                  recurring_amount:
                    value: '10.00'
                    currency: GBP
                  sender:
                    user_id: client-defined-user-id
                    name: 'MR TEST SENDER'
                    provider: Natwest
                  known_charges:
                    recipient_charge:
                      charge: '1.50'
                      currency: GBP
                      recipient_receives: '7.00'
                    sender_charge:
                      charge: '1.50'
                      currency: GBP
                      bank_sends: '10.00'
                      total_cost: '11.50'
                  state:
                    status_code: COMPLETED
                    status_message: 'Standing Order Creation Completed'
                    history:
                      -
                        datetime: '2020-02-02T12:29:33.428944815Z'
                        code: CREATED
                        message: 'Standing Order Created'
                      -
                        datetime: '2020-02-02T12:29:33.428944815Z'
                        code: AWAITING_AUTH
                        message: 'Awaiting Customer Authentication'
                      -
                        datetime: '2020-02-02T12:29:33.428944815Z'
                        code: AUTH_COMPLETED
                        message: 'Authentication Completed'
                      -
                        datetime: '2020-02-02T12:29:33.428944815Z'
                        code: PENDING
                        message: 'Payment Order Pending'
                      -
                        datetime: '2020-02-02T12:29:33.428944815Z'
                        code: COMPLETED
                        message: 'Standing Order Creation Completed'
                  errors:
                    -
                      code: FAILED
                      description: 'The call to the provider to confirm funds returned an error'
                  created_at: '2020-02-02T12:29:33.428944815Z'
                  first_payment_date: '2020-02-02T12:29:33.428944815Z'
                  last_payment_date: '2021-02-02T12:29:33.428944815Z'
                  frequency: monthly
                  required_action: null
                metadata: []
        404:
          description: 'Resource not found'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_standing_order_get
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  payment_id: 'Value not found'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/payments/scheduled:
    post:
      tags:
        - 'Initiate Payment - TSP'
      summary: 'Create Scheduled Payment'
      description: 'Create a new scheduled payment identifier and retrieve the authorisation url for the specific payment provider. Please note that this endpoint can only be used in the event that you are using Bud as a Technical Service Provider (TSP), i.e. you must have be regulated as an Payment Initiation Service Provider (PISP)'
      operationId: v1_payments_scheduled_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/CreateScheduledPaymentRequest'
            example:
              redirect_url: 'https://your-app.com/connected?my-parameter=xyz'
              provider: lloyds
              scheduled_payment_details:
                reference: 'PAYMENT REFERENCE'
                recipient:
                  type: SortCodeAccountNumber
                  name: 'MR TEST RECIPIENT'
                  account_number: '01234501234567'
                sender:
                  user_id: client-defined-user-id
                  name: 'MR TEST SENDER'
                amount:
                  value: '2.50'
                  currency: GBP
                requested_execution_date: '2020-02-02T12:29:33.428944815Z'
      responses:
        200:
          description: 'Successful request'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/CreateScheduledPaymentResponse'
              example:
                operation_id: v1_payments_scheduled_post
                data:
                  authorisation_url: 'https://www.thisisbud.com/provider/specific/redirect/url'
                  payment_id: 56caec01-85cc-4fc6-8080-cc0f7ed03a7e
                  required_action: confirm_scheduled_payment
        400:
          description: 'The request contains an invalid payload and/or header'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_payments_scheduled_post
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  recipient.sort_code: 'Sort code must match `^\d{6}$`'
                  standing_order_details.recipient.name: 'Name must not be empty'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
    get:
      tags:
        - 'Manage Payments'
      summary: 'List Scheduled Payments'
      description: 'Retrieve and view the status of multiple Scheduled Payments'
      operationId: v1_payments_scheduled_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/PaymentIdHeader'
        -
          $ref: 'components.yaml#/parameters/PageNumber'
        -
          $ref: 'components.yaml#/parameters/PaymentSenderProviders'
        -
          $ref: 'components.yaml#/parameters/PaymentStatusCodes'
        -
          $ref: 'components.yaml#/parameters/PaymentDateFrom'
        -
          $ref: 'components.yaml#/parameters/PaymentDateTo'
        -
          $ref: 'components.yaml#/parameters/PaymentAmountFrom'
        -
          $ref: 'components.yaml#/parameters/PaymentAmountTo'
      responses:
        200:
          description: 'Successful request'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/ListScheduledPaymentResponse'
              example:
                operation_id: v1_payments_scheduled_get
                data:
                  -
                    payment_id: 89f80199-1199-400e-9092-17208f6f39f5
                    organisation_id: 22f80199-1199-400e-9092-17208f6f39f0
                    client_id: 22f80199-1199-400e-9092-17208f6f39f0
                    reference: Rent
                    recipient:
                      type: SortCodeAccountNumber
                      name: 'MR TEST RECIPIENT'
                      account_number: '01234501234567'
                    amount:
                      value: '10.00'
                      currency: GBP
                    sender:
                      user_id: client-defined-user-id
                      name: 'MR RANDOM SENDER'
                      provider: Natwest
                    known_charges:
                      recipient_charge:
                        charge: '1.50'
                        currency: GBP
                        recipient_receives: '7.00'
                      sender_charge:
                        charge: '1.50'
                        currency: GBP
                        bank_sends: '10.00'
                        total_cost: '11.50'
                    state:
                      status_code: COMPLETED
                      status_message: 'Scheduled Payment Creation Completed'
                      history:
                        -
                          datetime: '2020-02-02T12:29:33.428944815Z'
                          code: CREATED
                          message: 'Scheduled Payment Created'
                        -
                          datetime: '2020-02-02T12:29:33.428944815Z'
                          code: AWAITING_AUTH
                          message: 'Awaiting Customer Authentication'
                        -
                          datetime: '2020-02-02T12:29:33.428944815Z'
                          code: AUTH_COMPLETED
                          message: 'Authentication Completed'
                        -
                          datetime: '2020-02-02T12:29:33.428944815Z'
                          code: PENDING
                          message: 'Payment Order Pending'
                        -
                          datetime: '2020-02-02T12:29:33.428944815Z'
                          code: COMPLETED
                          message: 'Scheduled Payment Creation Completed'
                    errors:
                      -
                        code: FAILED
                        description: 'The call to the provider to confirm funds returned an error'
                    created_at: '2020-02-02T12:29:33.428944815Z'
                    requested_execution_date: '2020-02-02T12:29:33.428944815Z'
                metadata:
                  total_results: 1000000
                  results: 10
                  page: 1
                  total_pages: 100000
        400:
          description: 'Resource not found'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_payments_scheduled_get
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  filter: 'X-Date-From is in the wrong format (expected 2006-01-02T15:04:05Z)'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  '/v1/payments/scheduled/{payment_id}/confirm':
    post:
      tags:
        - 'Initiate Payment - TSP'
      summary: 'Confirm Scheduled Payment'
      description: 'Confirm and execute a Scheduled Payment for a specific payment id.'
      operationId: v1_payments_scheduled_payment_id_confirm_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/PaymentId'
        -
          $ref: 'components.yaml#/parameters/ClientId'
      responses:
        201:
          description: 'Request to create scheduled payment succeeded'
          content:
            application/json:
              example:
                operation_id: v1_payments_scheduled_payment_id_confirm_post
        400:
          description: 'Not allowed to confirm payment. Either there is no consent, not authorised or the payment order has already been created'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_payments_scheduled_payment_id_confirm_post
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  payment: 'Payment initiation failed'
        401:
          description: 'Unauthorised request'
        404:
          description: 'Resource not found'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_payments_scheduled_payment_id_confirm_post
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  payment_id: 'Value not found'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  '/v1/payments/scheduled/{payment_id}':
    get:
      tags:
        - 'Manage Payments'
      summary: 'Retrieve Scheduled Payment Status'
      description: 'Retrieve and view the status of a specific Scheduled payment'
      operationId: v1_payments_scheduled_payment_id_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/PaymentId'
        -
          $ref: 'components.yaml#/parameters/ClientId'
      responses:
        200:
          description: 'Successful request'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/GetScheduledPaymentResponse'
              example:
                operation_id: v1_payments_scheduled_payment_id_get
                data:
                  payment_id: 89f80199-1199-400e-9092-17208f6f39f5
                  organisation_id: 22f80199-1199-400e-9092-17208f6f39f0
                  client_id: 22f80199-1199-400e-9092-17208f6f39f0
                  method: FPS
                  reference: Rent
                  recipient:
                    type: SortCodeAccountNumber
                    name: 'MR TEST RECIPIENT'
                    account_number: '01234501234567'
                  amount:
                    value: '10.00'
                    currency: GBP
                  sender:
                    user_id: client-defined-user-id
                    name: 'MR TEST SENDER'
                    provider: Natwest
                  known_charges:
                    recipient_charge:
                      charge: '1.50'
                      currency: GBP
                      recipient_receives: '7.00'
                    sender_charge:
                      charge: '1.50'
                      currency: GBP
                      bank_sends: '10.00'
                      total_cost: '11.50'
                  state:
                    status_code: COMPLETED
                    status_message: 'Scheduled Payment Creation Completed'
                    history:
                      -
                        datetime: '2020-02-02T12:29:33.428944815Z'
                        code: CREATED
                        message: 'Scheduled Payment Created'
                      -
                        datetime: '2020-02-02T12:29:33.428944815Z'
                        code: AWAITING_AUTH
                        message: 'Awaiting Customer Authentication'
                      -
                        datetime: '2020-02-02T12:29:33.428944815Z'
                        code: AUTH_COMPLETED
                        message: 'Authentication Completed'
                      -
                        datetime: '2020-02-02T12:29:33.428944815Z'
                        code: PENDING
                        message: 'Payment Order Pending'
                      -
                        datetime: '2020-02-02T12:29:33.428944815Z'
                        code: COMPLETED
                        message: 'Scheduled Payment Creation Completed'
                  errors:
                    -
                      code: FAILED
                      description: 'The call to the provider to confirm funds returned an error'
                  created_at: '2020-02-02T12:29:33.428944815Z'
                  requested_execution_date: '2020-02-02T12:29:33.428944815Z'
                  required_action: null
        404:
          description: 'Resource not found'
          content:
            application/json:
              schema:
                $ref: 'components.yaml#/schemas/BadRequestResponse'
              example:
                operation_id: v1_payments_scheduled_payment_id_get
                code_id: failed_validation
                message: 'Failed validation'
                errors:
                  payment_id: 'Value not found'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/signal/money-management:
    get:
      tags:
        - 'Everyday Money Management'
      summary: 'Retrieve Money Management'
      description: |
        Provides a list of potential scenarios where a customer might suffer some financial expense that cover the following:

        | Money Management                | Description                                                                            |
        |:--------------------------------|:---------------------------------------------------------------------------------------|
        | `overdraft`                     | Account is overdrawn (note that credit cards will not trigger this warning). |
        | `cannot_cover_bills`            | The total upcoming payments for exceeds the current balance. The time range used for analysing past payments is `(X-From, X-Today)` and the period used for predicting upcoming payments is `(X-Today, X-To)`. |
        | `late_income`                   | A regular incoming payment was expected to be received on the account and hasn't yet. |
        | `late_payment`                  | A regular outgoing payment was expected to come out of the account and hasn't yet.    |
        | `regular_payment_changed`       | The value of a regular payment has increased or decreased between the oldest and newest instance |
        | `suspected_duplicate_charge`    | A duplicate transaction is one of more transactions that are debit transactions, have a non-zero booking time, and have a non-zero amount. They must also have matching `account_id`, `transaction_reference`, `merchant_id` (if one exists), `amount`, `currency`, `date`, `booking_datetime` |
        | `regular_monthly_income_change` | The value of a regular income has increased or decreased based on the previous months income. As this is comparing income over whole months, only complete months are considered in the provided date range. For instance, if `X-From=2022-01-05` and `X-To=2022-04-05` then the range considered by this warning will be `(2022-01-01, 2022-03-31)`. In addition, the default treshold for a difference in amounts to trigger this warning is 10%. |
        | ~`large_expense`~ (deprecated)  | A transaction that exceeds 20% of the months income. Income is calculated by summing all credit transactions for that month |
        | ~`high_balance`~ (deprecated)   | Balance is greater than the sum of the essential expenses. Essential expenses are calculated by filtering transactions by 14 distinct subcategories and summing their amounts. |
      operationId: v1_signal_money_management_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/HeaderFrom'
        -
          $ref: 'components.yaml#/parameters/HeaderTo'
        -
          $ref: 'components.yaml#/parameters/Today'
        -
          $ref: 'components.yaml#/parameters/Delta'
      responses:
        200:
          description: 'The request was successfully processed'
          content:
            application/json:
              schema:
                required:
                  - operation_id
                  - data
                  - metadata
                properties:
                  operation_id:
                    type: string
                    enum:
                      - v1_signal_money_management_get
                  data:
                    $ref: 'components.yaml#/schemas/MoneyManagementResponse'
                  metadata:
                    $ref: 'components.yaml#/schemas/MoneyManagementMetaData'
              examples:
                Overdraft:
                  value:
                    operation_id: v1_signal_money_management_get
                    data:
                      -
                        type: overdraft
                        details:
                          account_id: b464ede0-c871-4ec2-84f0-1f6903bc736b
                          overdrawn_by:
                            value: '200.00'
                            currency: GBP
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-31'
                      today: '2020-02-04'
                'Cannot Cover Bills':
                  value:
                    operation_id: v1_signal_money_management_get
                    data:
                      -
                        type: cannot_cover_bills
                        details:
                          account_id: c9d6ab0b-93ba-450b-ac94-d9a72cbd668f
                          total_expected_payments:
                            value: '120.00'
                            currency: GBP
                          current_balance:
                            value: '100.00'
                            currency: GBP
                            credit_debit_indicator: Credit
                          transactions:
                            -
                              account_id: c9d6ab0b-93ba-450b-ac94-d9a72cbd668f
                              description: 'EDF Energy Bill'
                              provider: Barclays
                              date: '2020-02-15'
                              label: 6ad51923-1532-43ba-9c70-35c37b8742f7
                              credit_debit_indicator: Debit
                              amount:
                                value: '120.00'
                                currency: GBP
                              merchant:
                                id: edf_energy
                                name: 'EDF Energy'
                                logo: 'https://thisisbud.com/logos/edf_energy.png'
                              category_l1_name: bills
                              category_l2_name: utilities
                              category_l3_name: utilities_energy
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-31'
                      today: '2020-02-04'
                'Late Income':
                  value:
                    operation_id: v1_signal_money_management_get
                    data:
                      -
                        type: late_income
                        details:
                          account_id: c9d6ab0b-93ba-450b-ac94-d9a72cbd668f
                          label: bf257b0c-0685-494e-96dd-663ee01c1b3d
                          description: 'BUD SALARY'
                          expected_amount:
                            value: '1200.00'
                            currency: GBP
                          expected_date: '2020-02-01'
                          days_late: 2
                          merchant:
                            id: bud
                            name: 'Bud Financial'
                            logo: 'https://thisisbud.com/logos/bud.jpg'
                          category_l1: income
                          category_l2: salary
                          category_l3: salary
                      -
                        type: late_income
                        details:
                          account_id: 242b67fd-5085-4b0b-8916-505db5f60125
                          label: 2d00efc8-c324-49a7-8c34-794a45b6ce79
                          description: 'BANK REWARD SCHEME'
                          expected_amount:
                            value: '5.00'
                            currency: GBP
                          expected_date: '2020-02-02'
                          days_late: 1
                          merchant: null
                          category_l1: income
                          category_l2: other_income
                          category_l3: other_income
                    metadata:
                      results: 2
                      from: '2020-01-15'
                      to: '2020-02-15'
                      today: '2020-02-03'
                'Late Payment':
                  value:
                    operation_id: v1_signal_money_management_get
                    data:
                      -
                        type: late_payment
                        details:
                          account_id: c9d6ab0b-93ba-450b-ac94-d9a72cbd668f
                          label: 50fc920a-1175-4dae-82b1-d82a600007ce
                          description: 'GYM MEMBERSHIP'
                          expected_amount:
                            value: '80.00'
                            currency: GBP
                          expected_date: '2020-02-01'
                          days_late: 3
                          merchant:
                            id: some_gym
                            name: 'Some Gym'
                            logo: 'https://thisisbud.com/logos/some_gym.jpg'
                          category_l1: personal_care
                          category_l2: gym_and_fitness
                          category_l3: gym_membership
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-28'
                      today: '2020-02-04'
                'Regular Payment Changed':
                  value:
                    operation_id: v1_signal_money_management_get
                    data:
                      -
                        type: regular_payment_changed
                        details:
                          account_id: c9d6ab0b-93ba-450b-ac94-d9a72cbd668f
                          provider: Barclays
                          regular_payment_label: 6a6cd719f59534f9bb352e21ee541f8a85d3a93d-0
                          description: 'Energy Bill'
                          change: increase
                          delta:
                            value: '100.00'
                            currency: GBP
                          transactions:
                            -
                              account_id: c9d6ab0b-93ba-450b-ac94-d9a72cbd668f
                              transaction_id: 78c2e7d5ec7b00e07d8cdcd0037694733988850add8c65fa92f7134bf3143642-1
                              description: 'Energy Bill'
                              date: '2020-06-01'
                              label: 6ad51923-1532-43ba-9c70-35c37b8742f7
                              credit_debit_indicator: Debit
                              amount:
                                value: '500.00'
                                currency: GBP
                              merchant:
                                id: british_gas
                                name: 'British Gas'
                                logo: 'https://thisisbud.com/logos/british_gas.png'
                              category_l1_name: bills
                              category_l2_name: utilities
                              category_l3_name: utilities_energy
                            -
                              account_id: c9d6ab0b-93ba-450b-ac94-d9a72cbd668f
                              transaction_id: 1245359584085527da09acf52846e33e5b14034c4dd3458da17539e1ff710e59-1
                              description: 'Energy Bill'
                              date: '2020-05-01'
                              label: 9b52cd71-673b-4672-888c-360411a2bc19
                              credit_debit_indicator: Debit
                              amount:
                                value: '400.00'
                                currency: GBP
                              merchant:
                                id: british_gas
                                name: 'British Gas'
                                logo: 'https://thisisbud.com/logos/british_gas.png'
                              category_l1_name: bills
                              category_l2_name: utilities
                              category_l3_name: utilities_energy
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-31'
                      today: '2020-02-04'
                'Suspected Duplicate Charge':
                  value:
                    operation_id: v1_signal_money_management_get
                    data:
                      -
                        type: suspected_duplicate_charge
                        details:
                          -
                            account_id: c9d6ab0b-93ba-450b-ac94-d9a72cbd668f
                            transaction_id: 78c2e7d5ec7b00e07d8cdcd0037694733988850add8c65fa92f7134bf3143642-1
                            description: 'Energy Bill'
                            date: '2020-06-01'
                            label: 6ad51923-1532-43ba-9c70-35c37b8742f7
                            credit_debit_indicator: Debit
                            amount:
                              value: '500.00'
                              currency: GBP
                            merchant:
                              id: british_gas
                              name: 'British Gas'
                              logo: 'https://thisisbud.com/logos/british_gas.png'
                            category_l1_name: bills
                            category_l2_name: utilities
                            category_l3_name: utilities_energy
                          -
                            account_id: c9d6ab0b-93ba-450b-ac94-d9a72cbd668f
                            transaction_id: 78c2e7d5ec7b00e07d8cdcd0037694733988850add8c65fa92f7134bf3143642-1
                            description: 'Energy Bill'
                            date: '2020-06-01'
                            label: 6ad51923-1532-43ba-9c70-35c37b8742f7
                            credit_debit_indicator: Debit
                            amount:
                              value: '500.00'
                              currency: GBP
                            merchant:
                              id: british_gas
                              name: 'British Gas'
                              logo: 'https://thisisbud.com/logos/british_gas.png'
                            category_l1_name: bills
                            category_l2_name: utilities
                            category_l3_name: utilities_energy
                    metadata:
                      results: 2
                      from: '2020-02-01'
                      to: '2020-02-28'
                      today: '2020-02-04'
                'Large Expense':
                  value:
                    operation_id: v1_signal_money_management_get
                    data:
                      -
                        type: large_expense
                        details:
                          transaction_id: 1245359584085527da09acf52846e33e5b14034c4dd3458da17539e1ff107d12-1
                          account_id: c9d6ab0b-93ba-450b-ac94-d9a72cbd668f
                          amount:
                            value: '500.00'
                            currency: GBP
                          credit_debit_indicator: Debit
                          merchant:
                            id: sainsburys
                            name: Sainsburys
                            logo: 'https://thisisbud.com/logos/sainsburys.png'
                          l1_category_name: expenses
                          date: '2020-02-01'
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-28'
                      today: '2020-02-04'
                'High Balance':
                  value:
                    operation_id: v1_signal_money_management_get
                    data:
                      -
                        type: high_balance
                        details:
                          balance:
                            value: '1800.00'
                            currency: GBP
                          quarterly_total_expenses:
                            value: '500.00'
                            currency: GBP
                          total_debt:
                            value: '200.00'
                            currency: GBP
                          quarterly_expenses_by_category:
                            value: '500.00'
                            currency: GBP
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-28'
                      today: '2020-02-04'
                'Regular Monthly Income Changed':
                  value:
                    operation_id: v1_signal_money_management_get
                    data:
                      -
                        type: regular_monthly_income_change
                        details:
                          month: 2020-02
                          previous_month_income:
                            value: '1500.00'
                            currency: GBP
                          current_month_income:
                            value: '1000.00'
                            currency: GBP
                          proportion_change: '0.67'
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-28'
                      today: '2020-02-04'
        400:
          description: 'Bad Request that fails validations on headers & payload'
        401:
          description: 'Unauthorized (BearerToken in ''Authorization'' header fails the authentication)'
        403:
          description: Forbidden
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/signal/customer-characteristics:
    get:
      tags:
        - 'Customer Characteristics'
      summary: 'Retrieve Customer Characteristics'
      description: |
        Provides a list of potential scenarios where a customer might suffer some financial expense that cover the following:

        | Customer Characteristics             | Description |
        |:---------------------|:---------------------------------------------------------------------------------------|
        | `parent`             | User has childcare transactions |
        | `student_loan`       | User is paying off a student loan |
        | `pensioner`          | User receives pension income |                                                 
        | `saver`              | User receives savings income and / or deposits money into a savings / investment account |
        | `insurer`            | User has one or more insurance policies |
        | `overdraft_user`     | User was in their overdraft at midnight on any day during a set period|
        | `cash_user`          | User has made cash deposits and / or cash withdrawals |
        | `subscriber`         | User has one or more subscriptions|         
      operationId: v1_signal_customer_characteristics_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/HeaderFrom'
        -
          $ref: 'components.yaml#/parameters/HeaderTo'
        -
          $ref: 'components.yaml#/parameters/Today'
        -
          $ref: 'components.yaml#/parameters/Delta'
      responses:
        200:
          description: 'The request was successfully processed'
          content:
            application/json:
              schema:
                required:
                  - operation_id
                  - data
                  - metadata
                properties:
                  operation_id:
                    type: string
                    enum:
                      - v1_signal_customer_characteristics_get
                  data:
                    $ref: 'components.yaml#/schemas/CustomerCharacteristicResponse'
                  metadata:
                    $ref: 'components.yaml#/schemas/CustomerCharacteristicMetaData'
              examples:
                Parent:
                  value:
                    operation_id: v1_signal_customer_characteristics_get
                    data:
                      -
                        type: parent
                        details:
                          outgoing_categories:
                            childcare_and_nursery:
                              spending:
                                value: '500.00'
                                currency: GBP
                              spending_ratio: '0.20'
                              merchant:
                                - Mothercare
                              total_transactions: '1'
                          income:
                            value: '2500.00'
                            currency: GBP
                          expenditure:
                            value: '1000.00'
                            currency: GBP
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-31'
                      today: '2020-02-04'
                'Student Loan':
                  value:
                    operation_id: v1_signal_customer_characteristics_get
                    data:
                      -
                        type: student_loan
                        details:
                          outgoing_categories:
                            student_loan_repayment:
                              spending:
                                value: '500.00'
                                currency: GBP
                              spending_ratio: '0.20'
                              merchant: null
                              total_transactions: '1'
                          income:
                            value: '2500.00'
                            currency: GBP
                          expenditure:
                            value: '1000.00'
                            currency: GBP
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-31'
                      today: '2020-02-04'
                Pensioner:
                  value:
                    operation_id: v1_signal_customer_characteristics_get
                    data:
                      -
                        type: pensioner
                        details:
                          incoming_categories:
                            pension_income:
                              spending:
                                value: '500.00'
                                currency: GBP
                              spending_ratio: '0.20'
                              merchant:
                                - Aviva
                              total_transactions: '1'
                          income:
                            value: '2500.00'
                            currency: GBP
                          expenditure:
                            value: '1000.00'
                            currency: GBP
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-31'
                      today: '2020-02-04'
                Saver:
                  value:
                    operation_id: v1_signal_customer_characteristics_get
                    data:
                      -
                        type: saver
                        details:
                          outgoing_categories:
                            savings:
                              spending:
                                value: '500.00'
                                currency: GBP
                              spending_ratio: '0.20'
                              merchant: null
                              total_transactions: '1'
                          income:
                            value: '2500.00'
                            currency: GBP
                          expenditure:
                            value: '1000.00'
                            currency: GBP
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-31'
                      today: '2020-02-04'
                Insurer:
                  value:
                    operation_id: v1_signal_customer_characteristics_get
                    data:
                      -
                        type: insurer
                        details:
                          outgoing_categories:
                            vehicle_insurance:
                              spending:
                                value: '500.00'
                                currency: GBP
                              spending_ratio: '0.20'
                              merchant:
                                - 'Axa Insurance'
                              total_transactions: '1'
                          income:
                            value: '2500.00'
                            currency: GBP
                          expenditure:
                            value: '1000.00'
                            currency: GBP
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-31'
                      today: '2020-02-04'
                Overdraft:
                  value:
                    operation_id: v1_signal_customer_characteristics_get
                    data:
                      -
                        type: overdraft
                        details:
                          account_id: 3a8454c8-e1de-4f21-98f9-571393f1c823
                          days_in_overdraft: '30'
                          ratio_days_in_overdraft: '1.00'
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-31'
                      today: '2020-02-04'
                'Cash User':
                  value:
                    operation_id: v1_signal_customer_characteristics_get
                    data:
                      -
                        type: cash_user
                        details:
                          outgoing_categories:
                            cash_withdrawals:
                              spending:
                                value: '500.00'
                                currency: GBP
                              spending_ratio: '0.20'
                              merchant: null
                              total_transactions: '1'
                          income:
                            value: '2500.00'
                            currency: GBP
                          expenditure:
                            value: '1000.00'
                            currency: GBP
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-31'
                      today: '2020-02-04'
                Subscriber:
                  value:
                    operation_id: v1_signal_customer_characteristics_get
                    data:
                      -
                        type: subscriber
                        details:
                          outgoing_categories:
                            gym_membership:
                              spending:
                                value: '500.00'
                                currency: GBP
                              spending_ratio: '0.20'
                              merchant:
                                - 'Pure Gym'
                              total_transactions: '1'
                          income:
                            value: '2500.00'
                            currency: GBP
                          expenditure:
                            value: '1000.00'
                            currency: GBP
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-31'
                      today: '2020-02-04'
        400:
          description: 'Bad Request that fails validations on headers & payload'
        401:
          description: 'Unauthorized (BearerToken in ''Authorization'' header fails the authentication)'
        403:
          description: Forbidden
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/signal/financial-insights:
    get:
      tags:
        - 'Income and Expenditure Insight'
      summary: 'Retrieve Financial Insights'
      description: |
        Provides a list of potential scenarios where a customer might suffer some financial expense that cover the following:

         | Financial Insights   | Description                                                                            |
         |:---------------------|:---------------------------------------------------------------------------------------|
         | `gambling_income`             | Income indentified through gambling transactions |
         | `pension_income`              | Income indentified through company pension(s) |
         | `gambling_threshold`          | Overall spending on gambling exceeds the threshold (default to 20%) of all income over that same time period |                                                                 
         | `new_insurance_expense`       | Any new insurance related expense identified |
         | `subscription_expense`        | Any new subscription related expense identified  |      
      operationId: v1_signal_financial_insights_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/HeaderFrom'
        -
          $ref: 'components.yaml#/parameters/HeaderTo'
        -
          $ref: 'components.yaml#/parameters/Today'
        -
          $ref: 'components.yaml#/parameters/Delta'
      responses:
        200:
          description: 'The request was successfully processed'
          content:
            application/json:
              schema:
                required:
                  - operation_id
                  - data
                  - metadata
                properties:
                  operation_id:
                    type: string
                    enum:
                      - v1_signal_financial_insights_get
                  data:
                    $ref: 'components.yaml#/schemas/FinancialInsightResponse'
                  metadata:
                    $ref: 'components.yaml#/schemas/FinancialInsightMetaData'
              examples:
                'Gambling Income':
                  value:
                    operation_id: v1_signal_financial_insights_get
                    data:
                      -
                        type: gambling_income
                        details:
                          total:
                            -
                              value: '140.12'
                              currency: GBP
                          merchant_ids:
                            - bet365
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-31'
                      today: '2020-02-04'
                'Pension Income':
                  value:
                    operation_id: v1_signal_financial_insights_get
                    data:
                      -
                        type: pension_income
                        details:
                          total:
                            -
                              value: '140.12'
                              currency: GBP
                          merchant_ids:
                            - aviva
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-31'
                      today: '2020-02-04'
                'Gambling Threshold':
                  value:
                    operation_id: v1_signal_financial_insights_get
                    data:
                      -
                        type: gambling_threshold
                        details:
                          income:
                            value: '1000.00'
                            currency: GBP
                          expenditure:
                            value: '500.00'
                            currency: GBP
                          threshold: '0.20'
                          ratio_to_income: '0.20'
                          transactions:
                            -
                              transaction_id: 0bbf2ed39865278609b6c07d35bc0b3cb8fd7253cf10578f57c75457104e8823
                              account_id: 525d0eb5-909c-4a9c-a191-2e9ad7fd40f8
                              description: Casino
                              booking_datetime: '2020-02-01'
                              credit_debit_indicator: Debit
                              amount:
                                value: '500.00'
                                currency: GBP
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-31'
                      today: '2020-02-04'
                'Insurance Expense':
                  value:
                    operation_id: v1_signal_financial_insights_get
                    data:
                      -
                        type: insurance_expense
                        details:
                          total:
                            -
                              value: '140.12'
                              currency: GBP
                          merchant_ids:
                            - directline
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-31'
                      today: '2020-02-04'
                'Subscription Expense':
                  value:
                    operation_id: v1_signal_financial_insights_get
                    data:
                      -
                        type: subscription_expense
                        details:
                          transaction_id: 4145908d1d5c7104353c6835de38057065af341d8e4a2f41a06893b76f22f935-1
                          account_id: 525d0eb5-909c-4a9c-a191-2e9ad7fd40f8
                          merchant: Netflix
                          l3_category_name: tv_and_film_streaming_services
                          amount:
                            value: '11.99'
                            currency: GBP
                    metadata:
                      results: 1
                      from: '2020-02-01'
                      to: '2020-02-31'
                      today: '2020-02-04'
        400:
          description: 'Bad Request that fails validations on headers & payload'
        401:
          description: 'Unauthorized (BearerToken in ''Authorization'' header fails the authentication)'
        403:
          description: Forbidden
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/signal/trends:
    get:
      tags:
        - 'Income and Expenditure Insight'
      summary: 'Retrieve Trends'
      description: |
        Provides the key trends associated with a customer’s transactional data broken down by month
      operationId: v1_signal_trends_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/FromMonth'
        -
          $ref: 'components.yaml#/parameters/ToMonth'
      responses:
        200:
          description: 'The request was successfully processed'
          content:
            application/json:
              schema:
                required:
                  - operation_id
                  - data
                  - metadata
                properties:
                  operation_id:
                    type: string
                    enum:
                      - v1_signal_trends_get
                  data:
                    $ref: 'components.yaml#/schemas/TrendsResponse'
                  metadata:
                    $ref: 'components.yaml#/schemas/TrendsMetaData'
                example:
                  operation_id: v1_signal_trends_get
                  data:
                    2020-02:
                      income:
                        value: '2000.00'
                        currency: GBP
                      expenditure:
                        value: '1800.00'
                        currency: GBP
                      spending_ratio: '0.90'
                      categories:
                        bills:
                          credit:
                            amount:
                              value: '0.00'
                              currency: GBP
                            ratio_to_income: '0.00'
                            ratio_to_expenditure: '0.00'
                          debit:
                            amount:
                              value: '1800.00'
                              currency: GBP
                            ratio_to_income: '0.90'
                            ratio_to_expenditure: '1.00'
                          subcategories:
                            mortgage_and_rent:
                              credit:
                                amount:
                                  value: '0.00'
                                  currency: GBP
                                ratio_to_income: '0.00'
                                ratio_to_expenditure: '0.00'
                              debit:
                                amount:
                                  value: '1800.00'
                                  currency: GBP
                                ratio_to_income: '0.90'
                                ratio_to_expenditure: '1.00'
                      results: 2
                  metadata:
                    results: 1
                    from: '2020-02-01'
                    to: '2020-02-28'
        400:
          description: 'Bad Request that fails validations on headers & payload'
        401:
          description: 'Unauthorized (BearerToken in ''Authorization'' header fails the authentication)'
        403:
          description: Forbidden
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/signal/forecast:
    get:
      tags:
        - 'Income and Expenditure Insight'
      summary: 'Retrieve Financial Forecast'
      description: |
        Provides a list of the regular and predicted transactions over a given period, noting whether they are booked, pending or predicted.
      operationId: v1_signal_forecast_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/HeaderFrom'
        -
          $ref: 'components.yaml#/parameters/HeaderTo'
        -
          $ref: 'components.yaml#/parameters/Delta'
      responses:
        200:
          description: 'The request was successfully processed'
          content:
            application/json:
              schema:
                required:
                  - operation_id
                  - data
                  - metadata
                properties:
                  operation_id:
                    type: string
                    enum:
                      - v1_signal_forecast_get
                  data:
                    type: array
                    items:
                      $ref: 'components.yaml#/schemas/ForecastedTransaction'
                  metadata:
                    $ref: 'components.yaml#/schemas/ForecastedMetaData'
                example:
                  operation_id: v1_signal_forecast_get
                  data:
                    -
                      transaction_id: e559d2d1a38e7758c2b640ae29af576a0ed03a14ba2131eaa8b55c54f6be2828-1
                      label: f39db9ff27181b809f124289af2e4375c585673c-0
                      description: 'BT GROUP PLC'
                      status: Booked
                      amount:
                        value: '78.49'
                        currency: GBP
                      credit_debit_indicator: Debit
                      date: '2020-03-02'
                    -
                      transaction_id: ca634c18a6cbb73c25cce68d119a47bd75857a162214a03b55c3ba86e381ce15-1
                      label: 963e2fe4610d4d70b4b2e908440f8a5ddd9ac416-0
                      description: DVLA-EY05HKB
                      status: Booked
                      amount:
                        value: '17.50'
                        currency: GBP
                      credit_debit_indicator: Debit
                      date: '2020-03-02'
                    -
                      transaction_id: abd3d0a16e19853776c62b780b02178f90ee81ecb05d77255f08ca1e6cf58475-1
                      label: 776738cdc7011c7be809dc095e80e6331756de6f-0
                      description: '9773 29FEB20 C    CO-OP GROUP 610109CHINGFORD GB'
                      status: Booked
                      amount:
                        value: '29.06'
                        currency: GBP
                      credit_debit_indicator: Debit
                      date: '2020-03-02'
                    -
                      transaction_id: 912e463dade24b51afc0daf1b3f9d69b8b6bf5030d6ab32dd67e40b04b8b31dd-1
                      label: 3136746f94216e00f283c260ef0896d326ad2875-0
                      description: 'NATIONWIDE B S'
                      status: Booked
                      amount:
                        value: '1381.03'
                        currency: GBP
                      credit_debit_indicator: Debit
                      date: '2020-03-02'
                    -
                      transaction_id: 8de94260f704b3ca1ef51c1ed7240e57b1a8fca3fba9c3658fc1bd2d46576f3f-1
                      label: da39a3ee5e6b4b0d3255bfef95601890afd80709-0
                      description: H3G
                      status: Booked
                      amount:
                        value: '29.72'
                        currency: GBP
                      credit_debit_indicator: Debit
                      date: '2020-03-02'
                    -
                      transaction_id: 768c321c463700f1cc3be7b3ff6873daf7059f5ee8dc74a2bfc5f572cf2c8704-1
                      label: b868161760980af4d0dd8653b80c23927e07257d-0
                      description: 'THAMES WATER'
                      status: Booked
                      amount:
                        value: '29.00'
                        currency: GBP
                      credit_debit_indicator: Debit
                      date: '2020-03-02'
                    -
                      transaction_id: 1a82b2890a47675a1641b509591e642e58d9b57cea3078eae3bc3f8ae9c6e4ab-1
                      label: 776738cdc7011c7be809dc095e80e6331756de6f-1
                      description: '9773 01MAR20 C    CO-OP GROUP 610109CHINGFORD GB'
                      status: Booked
                      amount:
                        value: '25.29'
                        currency: GBP
                      credit_debit_indicator: Debit
                      date: '2020-03-02'
                    -
                      transaction_id: 3d5ee8c42b094ce0091cd3bd35f20dc8ada6ef59b0a2e234e8e812ea57ce979d-1
                      label: 836cfe936b932a8277c7e0abc822ae8e8f1b3cc3-0
                      description: '9773 02MAR20 C    MARKS&SPENCER PLC SACA              LONDON EC1V GB'
                      status: Booked
                      amount:
                        value: '10.00'
                        currency: GBP
                      credit_debit_indicator: Debit
                      date: '2020-03-03'
                    -
                      transaction_id: 2a1b07cf671dc0bc19b6e5152b5eebcdb0ad5298dcb88e18ad69d3b91f5f1dbb-1
                      label: 41b0d188f2e71c009b8b746c040dab5befb40bef-0
                      description: 'ROYAL SUNALLIANCE'
                      status: Booked
                      amount:
                        value: '46.40'
                        currency: GBP
                      credit_debit_indicator: Debit
                      date: '2020-03-03'
                    -
                      transaction_id: ''
                      label: 0a829f5c1ec55c904e21dc3dfde4097ad599df84-0
                      description: 'LB WALTHAM FOREST'
                      status: Predicted
                      amount:
                        value: '173.00'
                        currency: GBP
                      credit_debit_indicator: Debit
                      date: '2020-03-06'
                    -
                      transaction_id: ''
                      label: 787e7a7fd179117bab6037233c531b28240c2389-0
                      description: 'TV LICENCE MBP'
                      status: Predicted
                      amount:
                        value: '13.26'
                        currency: GBP
                      credit_debit_indicator: Debit
                      date: '2020-03-10'
                    -
                      transaction_id: ''
                      label: edfb9515f80334b4747c5c4943bcfdb44058cc6d-0
                      description: 'ARRANGED OD USAGE 22JAN A/C 21621268'
                      status: Predicted
                      amount:
                        value: '6.00'
                        currency: GBP
                      credit_debit_indicator: Debit
                      date: '2020-03-12'
                    -
                      transaction_id: ''
                      label: 755e23ba3dbb93068f15d07ac4c9f54dcc85340f-1
                      description: '22JAN A/C 21621268'
                      status: Predicted
                      amount:
                        value: '2.79'
                        currency: GBP
                      credit_debit_indicator: Debit
                      date: '2020-03-12'
                    -
                      transaction_id: ''
                      label: 755e23ba3dbb93068f15d07ac4c9f54dcc85340f-0
                      description: '22JAN A/C 21621268'
                      status: Predicted
                      amount:
                        value: '18.00'
                        currency: GBP
                      credit_debit_indicator: Debit
                      date: '2020-03-12'
                    -
                      transaction_id: ''
                      label: a702a4542d63fd235c40810fc9e37e1fe35028cb-0
                      description: 'BULB ENERGY'
                      status: Predicted
                      amount:
                        value: '108.00'
                        currency: GBP
                      credit_debit_indicator: Debit
                      date: '2020-03-13'
                    -
                      transaction_id: ''
                      label: da39a3ee5e6b4b0d3255bfef95601890afd80709-1
                      description: H3G
                      status: Predicted
                      amount:
                        value: '20.08'
                        currency: GBP
                      credit_debit_indicator: Debit
                      date: '2020-03-24'
                  metadata:
                    from: '2020-03-01'
                    to: '2020-04-01'
        400:
          description: 'The request contains an invalid payload'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/signal/custom/components:
    get:
      tags:
        - 'Custom Signals'
      summary: 'List Components'
      description: 'List the matching components which can be used to define custom insights.'
      operationId: v1_signal_custom_components_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
      responses:
        200:
          description: 'The request was successfully processed'
          content:
            application/json:
              schema:
                required:
                  - operation_id
                  - data
                  - metadata
                properties:
                  operation_id:
                    type: string
                    enum:
                      - v1_signal_custom_components_get
                  data:
                    $ref: 'components.yaml#/schemas/ListComponentsResponse'
                  metadata:
                    $ref: 'components.yaml#/schemas/ListComponentsMetaData'
                example:
                  operation_id: v1_signal_custom_components_get
                  data:
                    components:
                      -
                        name: expenditure_merchant
                        description: 'Tests whether the total spend, over a period, across a list of merchants, is at least an amount'
                        parameters:
                          amount:
                            type: number
                            min: 0.01
                            max: 1000000000000
                            default: 100
                          merchants:
                            type: string-array
                            min: null
                            max: null
                            default: []
                          period:
                            type: period
                            min: 1D
                            max: 12M
                            default: 1M
                      -
                        name: income_l2s
                        description: 'Tests whether total income, over a period, across a list of L2 categories, is at least an amount'
                        parameters:
                          amount:
                            type: number
                            min: 0.01
                            max: 1000000000000
                            default: 100
                          merchants:
                            type: string-array
                            min: null
                            max: null
                            default: []
                          period:
                            type: period
                            min: 1D
                            max: 12M
                            default: 1M
                      -
                        name: income_l3s
                        description: 'Tests whether total income, over a period, across a list of L3 categories, is at least an amount'
                        parameters:
                          amount:
                            type: number
                            min: 0.01
                            max: 1000000000000
                            default: 100
                          merchants:
                            type: string-array
                            min: null
                            max: null
                            default: []
                          period:
                            type: period
                            min: 1D
                            max: 12M
                            default: 1M
                      -
                        name: all
                        description: 'Matches all customers'
                        parameters: null
                      -
                        name: expenditure_l2s
                        description: 'Tests whether the total spend, over a period, across a list of L2 categories, is at least an amount'
                        parameters:
                          amount:
                            type: number
                            min: 0.01
                            max: 1000000000000
                            default: 100
                          merchants:
                            type: string-array
                            min: null
                            max: null
                            default: []
                          period:
                            type: period
                            min: 1D
                            max: 12M
                            default: 1M
                      -
                        name: expenditure_l3s
                        description: 'Tests whether the total spend, over a period, across a list of L3 categories, is at least an amount'
                        parameters:
                          amount:
                            type: number
                            min: 0.01
                            max: 1000000000000
                            default: 100
                          merchants:
                            type: string-array
                            min: null
                            max: null
                            default: []
                          period:
                            type: period
                            min: 1D
                            max: 12M
                            default: 1M
                  metadata:
                    results: 6
        400:
          description: 'The request contains an invalid payload'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  /v1/signal/custom/insights:
    post:
      tags:
        - 'Custom Signals'
      summary: 'Create Custom Insight'
      description: 'Create new custom insights using one or more components.'
      operationId: v1_signal_custom_create_post
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: 'components.yaml#/schemas/CreateInsightRequest'
            example:
              name: 'Life Insurance'
              description: 'Customer is paying more than bank X''s average life insurance cost'
              components:
                -
                  name: expenditure_l3s
                  parameters:
                    amount: 15
                    l3-categories:
                      - life_insurance
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                required:
                  - operation_id
                  - data
                  - metadata
                properties:
                  operation_id:
                    type: string
                    enum:
                      - v1_signal_custom_create_post
                  data:
                    $ref: 'components.yaml#/schemas/CreateInsightResponse'
                  metadata:
                    nullable: true
                example:
                  operation_id: v1_signal_custom_create_post
                  data:
                    insight_id: 9298f468-a8e1-49c5-9d37-9fc45d870b22
        400:
          description: 'The request contains an invalid payload'
        401:
          description: 'Unauthorised request'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  '/v1/signal/custom/{insight_id}/schema':
    get:
      tags:
        - 'Custom Signals'
      summary: 'Retrieve Custom Insight'
      description: 'Retrieve a previously created custom insight.'
      operationId: v1_signal_custom_schema_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/InsightId'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                required:
                  - operation_id
                  - data
                  - metadata
                properties:
                  operation_id:
                    type: string
                    enum:
                      - v1_signal_custom_schema_get
                  data:
                    $ref: 'components.yaml#/schemas/RetrieveInsightResponse'
                  metadata:
                    nullable: true
                example:
                  id: 9298f468-a8e1-49c5-9d37-9fc45d870b22
                  name: 'Life Insurance'
                  description: 'Customer is paying more than bank X''s average life insurance cost'
                  components:
                    -
                      id: 428b7a57-6480-44c9-bb98-56b93310ab6c
                      name: expenditure_l3s
                      parameters:
                        amount: 15
                        l3-categories:
                          - life_insurance
        400:
          description: 'The request contains an invalid payload'
        401:
          description: 'Unauthorised request'
        404:
          description: 'This insight doesn''t exist or doesn''t belong to this client'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
  '/v1/signal/custom/{insight_id}':
    get:
      tags:
        - 'Custom Signals'
      summary: 'Compare Custom Insight'
      description: 'Compare a customer with an previously created custom insight, testing whether they match against it.'
      operationId: v1_signal_custom_get
      security:
        -
          OAuth2: []
      parameters:
        -
          $ref: 'components.yaml#/parameters/ClientId'
        -
          $ref: 'components.yaml#/parameters/CustomerId'
        -
          $ref: 'components.yaml#/parameters/CustomerSecret'
        -
          $ref: 'components.yaml#/parameters/InsightId'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                required:
                  - operation_id
                  - data
                  - metadata
                properties:
                  operation_id:
                    type: string
                    enum:
                      - v1_signal_custom_get
                  data:
                    $ref: 'components.yaml#/schemas/CompareInsightResponse'
                  metadata:
                    nullable: true
                example:
                  operation_id: v1_signal_custom_schema_get
                  data:
                    name: 'Life Insurance'
                    description: 'Customer is paying more than bank X''s average life insurance cost'
                    components:
                      216d20e6-78e9-40d7-85cf-435077254d38:
                        name: expenditure_l3s
                        match: 'true'
                        value: 23
                    match: full
        400:
          description: 'The request contains an invalid payload'
        401:
          description: 'Unauthorised request'
        404:
          description: 'This insight doesn''t exist or doesn''t belong to this client'
        405:
          description: 'An unexpected HTTP method was used'
        5XX:
          description: 'An unexpected error occurred on the server side'
components:
  securitySchemes:
    OAuth2:
      $ref: 'components.yaml#/securitySchemes/OAuth2'
  schemas:
    Amount:
      title: Amount
      type: object
      description: 'A monetary amount composed of both value and currency.'
      required:
        - value
        - currency
      properties:
        value:
          type: string
          description: 'The absolute monetary value of the amount. Always greater than or equal to 0.'
        currency:
          type: string
          description: 'Currency code compliant with ISO 4217.'
    Transaction:
      title: Transaction
      type: object
      description: 'A financial transaction'
      required:
        - transaction_id
        - account_id
        - description
        - amount
        - credit_debit_indicator
        - status
        - date_time
      properties:
        transaction_id:
          type: string
          description: 'Unique identifier for the transaction. May be mutable depending on original ingestion source.'
        account_id:
          type: string
          description: 'Identifier for the account associated with the transaction.'
        provider:
          type: string
          description: 'Name of the transaction source provider.'
        description:
          type: string
          description: 'Description of the transaction. Similar to the transaction information in Open Banking.'
        credit_debit_indicator:
          type: string
          description: 'Credit/Debit Indicator'
          enum:
            - credit
            - debit
        status:
          type: string
          description: 'Status of the transaction. Defaults to booked.'
          enum:
            - booked
            - pending
        amount:
          $ref: '#/components/schemas/Amount'
        date_time:
          type: string
          description: 'Date of the transaction compliant with RFC3339.'
        enrichments:
          $ref: '#/components/schemas/Enrichments'
        tags:
          type: array
          description: |
            A list of potential tags associated with the transaction after contextual enrichment, which can be used for filtering.
            Region and client specific.

            | Value                   | Description                                               |
            |:------------------------|:----------------------------------------------------------|
            | `benefit`               | A government/non-profit benefit transaction               |
            | `debt-collection`       | A transaction associated with a known debt-collector      |
            | `income`                | A transaction associated with income                      |
            | `regular-transaction`   | A transaction predicted to occur with a regular frequency |
            | `salary`                | A transaction associated with a regular wage              |
            | `subscription`          | A transaction associated with a subscription service      |
          items:
            type: string
    Enrichments:
      title: Enrichments
      type: object
      description: 'Contextual enrichments associated with a Transaction'
      properties:
        categories:
          $ref: '#/components/schemas/Categories'
        merchant:
          $ref: '#/components/schemas/Merchant'
        processor:
          $ref: '#/components/schemas/Processor'
        regularity:
          $ref: '#/components/schemas/Regularity'
        locations:
          $ref: '#/components/schemas/Location'
        transaction_types:
          type: array
          description: 'Transaction types associated with the transaction'
          items:
            type: string
        names:
          type: array
          description: 'Names that were detected in the transaction description'
          items:
            type: string
    Categories:
      title: Categories
      type: object
      description: 'Categories enrichment associated with a Transaction'
      properties:
        l1:
          $ref: '#/components/schemas/Category'
          description: 'Level 1 Category'
        l2:
          $ref: '#/components/schemas/Category'
          description: 'Level 2 Category'
    Category:
      title: Category
      type: object
      description: 'Category associated with a Transaction'
      required:
        - slug
        - confidence
      properties:
        slug:
          type: string
          description: 'Unique human readable identifier of the category. Not subject to version control.'
        confidence:
          type: string
          description: 'Degree of belief of correct assignment, expressed as a probability.'
    Merchant:
      title: Merchant
      type: object
      description: 'Merchant enrichment associated with a Transaction'
      properties:
        id:
          type: string
          description: 'UUID corresponding to the merchant, if available. Subject to version control.'
        slug:
          type: string
          description: 'Unique human readable identifier of the merchant. Not subject to version control.'
        display_name:
          type: string
          description: 'UI friendly display name for the merchant.'
        logo:
          type: string
          description: 'URL supplying merchant logo, if available.'
    Processor:
      title: Processor
      type: object
      description: 'Processor enrichment associated with a Transaction'
      properties:
        id:
          type: string
          description: 'UUID corresponding to the processor, if available. Subject to version control.'
        slug:
          type: string
          description: 'Unique human readable identifier of the merchant. Not subject to version control.'
        display_name:
          type: string
          description: 'UI friendly display name for the processor.'
        logo:
          type: string
          description: 'URL supplying processor logo, if available.'
    Regularity:
      title: Regularity
      type: object
      description: 'Regularity enrichment associated with a Transaction.'
      properties:
        frequency:
          type: string
          description: 'Detected frequency of the Transaction.'
          enum:
            - unknown
            - daily
            - weekly
            - biweekly
            - monthly
            - quarterly
            - six_monthly
            - annually
        predicted_date_times:
          type: array
          description: 'Expected date times for the Transaction to repeat.'
          items:
            type: string
        group_label:
          type: string
          description: 'Unique label applied to multiple transactions in the same group.'
    Location:
      title: Location
      type: object
      description: 'Location enrichment associated with a Transaction'
      properties:
        address:
          type: object
          description: 'The address of the detected location.'
          properties:
            address_lines:
              type: array
              description: |
                The lines of the detected address. These could be anything from a full street address down to a simple town or city.
                The level of detail depends on the resolution with which we are able to detect the transaction location.
              items:
                type: string
            country:
              type: string
              description: 'An ISO-3166 Alpha-3 country code representing the detected country the transaction was located.'
    ListTransactionsResponse:
      title: 'List Transactions Response'
      type: object
      required:
        - operation_id
        - data
        - metadata
      properties:
        operation_id:
          type: string
          enum:
            - v2_transactions_get
        data:
          type: array
          items:
            $ref: '#/components/schemas/Transaction'
        metadata:
          type: object
          required:
            - results
          properties:
            results:
              type: integer
              description: 'The number of results returned.'
            next_page_token:
              type: string
              description: 'The token required to retrieve the next page of results. Will be omitted if no next page exists.'
